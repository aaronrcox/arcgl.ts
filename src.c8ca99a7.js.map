{"version":3,"sources":["engine/math/vec2.ts","engine/math/vec3.ts","engine/math/vec4.ts","engine/math/mat3.ts","engine/math/mat4.ts","engine/math/rect.ts","engine/math/ray.ts","engine/math/shape.ts","engine/math/index.ts","engine/input/mouseInput.ts","engine/input/keyboardInput.ts","engine/input/inputManager.ts","engine/graphics/texture.ts","engine/graphics/shader.ts","engine/graphics/renderTexture.ts","engine/graphics/renderer2d.ts","engine/utils/timer.ts","engine/utils/frameTimer.ts","engine/app.ts","demos/lightBender/levels.ts","demos/lightBender/index.ts","demos/rayCasting/index.ts","demos/lineRendering/index.ts","demos/renderTextureDemo/index.ts","demos/index.ts","index.ts"],"names":[],"mappings":";AAMa,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAb,IAAA,EAAA,WAqBI,SAAA,EAAY,EAAe,QAAf,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,GAClB,KAAA,EAAI,EACJ,KAAA,EAAI,EAwHjB,OA5II,EAAA,UAAC,OAAO,UAAR,WAAA,IAAA,EAAA,KACQ,EAAO,EACJ,MAAA,CAAE,KAAM,WAAO,MAAA,CAAE,MAAO,EAAK,KAAS,KAAM,EAAO,MAK9D,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAItB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAJ5B,YAAA,EAVI,cAAA,IAWT,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAItB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAJ5B,YAAA,EAXI,cAAA,IAYT,OAAA,eAAI,EAAA,UAAA,KAAE,CAAN,IAAA,WAAkB,MAAA,CAAC,KAAK,EAAG,KAAK,IAIhC,IAAA,SAAO,GACE,KAAA,EAAI,EAAM,GACV,KAAA,EAAI,EAAM,IANb,YAAA,EAZG,cAAA,IA0BF,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAExC,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAExC,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAExC,EAAA,MAAP,SAAa,EAAY,GACd,OAAA,IAAI,EAAK,EAAI,EAAI,EAAK,EAAI,EAAI,IAElC,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAExC,EAAA,OAAP,SAAc,GACH,OAAA,IAAI,GAAM,EAAI,GAAI,EAAI,IAE1B,EAAA,UAAP,SAAiB,GACP,IAAA,EAAM,EAAK,IAAI,GACd,OAAA,IAAI,EAAK,EAAI,EAAI,EAAK,EAAI,EAAI,IAElC,EAAA,IAAP,SAAW,GACA,OAAA,KAAK,KAAK,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,IAG1C,EAAA,SAAP,SAAgB,EAAa,GAClB,OAAA,EAAK,IAAI,EAAM,GAAM,UAEzB,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,GAEhC,EAAA,MAAP,SAAa,EAAY,EAAa,QAAA,IAAA,IAAA,EAAA,CAAgB,EAAG,EAAG,EAAG,IACrD,IAAA,EAAI,EAAI,EAAI,EAAM,EAClB,EAAI,EAAI,EAAI,EAAM,EAEjB,OAAA,IAAI,EACN,EAAI,KAAK,IAAI,GAAS,EAAI,KAAK,IAAI,GAAQ,EAAM,EACjD,EAAI,KAAK,IAAI,GAAS,EAAI,KAAK,IAAI,GAAQ,EAAM,IAGnD,EAAA,QAAP,SAAe,EAAY,GACjB,IAAA,EAAI,EAAK,IAAI,EAAK,GACjB,OAAA,IAAI,EACP,EAAI,EAAI,EAAI,EAAI,EAAO,EACvB,EAAI,EAAI,EAAI,EAAI,EAAO,IAI/B,EAAA,UAAA,IAAA,SAAI,GAGO,OAFF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAGO,OAFF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAGO,OAFF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAGO,OAFF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,MAAA,SAAM,GAGK,OAFF,KAAA,GAAK,EACL,KAAA,GAAK,EACH,MAGX,EAAA,UAAA,OAAA,WAGW,OAFF,KAAA,GAAK,KAAK,EACV,KAAA,GAAK,KAAK,EACR,MAGX,EAAA,UAAA,UAAA,WACU,IAAA,EAAM,KAAK,SACd,OAAQ,IAAR,EACQ,MAEN,KAAA,GAAK,EACL,KAAA,GAAK,EACH,OAGX,EAAA,UAAA,OAAA,WACW,OAAA,EAAK,IAAI,OAGpB,EAAA,UAAA,IAAA,SAAI,GACO,OAAA,EAAK,IAAI,KAAM,IAG1B,EAAA,UAAA,MAAA,SAAM,EAAa,QAAA,IAAA,IAAA,EAAA,CAAgB,EAAG,EAAG,EAAG,IACpC,IAAA,EAAI,KAAK,EAAI,EAAM,EACnB,EAAI,KAAK,EAAI,EAAM,EAKhB,OAHF,KAAA,EAAK,EAAI,KAAK,IAAI,GAAS,EAAI,KAAK,IAAI,GAAQ,EAAM,EACtD,KAAA,EAAK,EAAI,KAAK,IAAI,GAAS,EAAI,KAAK,IAAI,GAAQ,EAAM,EAEpD,MAIJ,EAAA,cAAP,SAAqB,GACV,OAAA,IAAI,EAAK,EAAI,GAAI,EAAI,IArIhB,EAAA,KAAa,IAAI,EAAK,EAAG,GAuI7C,EA/IA,GAAa,QAAA,KAAA;;ACEA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IARb,IAAA,EAAA,QAAA,UAQA,EAAA,WAuBI,SAAA,EAAY,EAAe,EAAe,QAA9B,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,GACjC,KAAA,EAAI,EACJ,KAAA,EAAI,EACJ,KAAA,EAAI,EAsEjB,OA7FI,EAAA,UAAC,OAAO,UAAR,WAAA,IAAA,EAAA,KACQ,EAAO,EACJ,MAAA,CAAE,KAAM,WAAO,MAAA,CAAE,MAAO,EAAK,KAAS,KAAM,EAAO,MAG9D,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAMtB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAN5B,YAAA,EARI,cAAA,IAST,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAMtB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAN5B,YAAA,EATI,cAAA,IAUT,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAMtB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAN5B,YAAA,EAVI,cAAA,IAWT,OAAA,eAAI,EAAA,UAAA,KAAE,CAAN,IAAA,WAAkB,OAAA,IAAI,EAAA,KAAK,KAAK,GAAI,KAAK,KAAnC,YAAA,EAXG,cAAA,IAiBT,OAAA,eAAI,EAAA,UAAA,MAAG,CAAP,IAAA,SAAQ,GACC,KAAA,EAAI,EAAM,GACV,KAAA,EAAI,EAAM,GACV,KAAA,EAAI,EAAM,IAHZ,YAAA,EAjBE,cAAA,IA6BF,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAEvD,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAEvD,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAEvD,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAEvD,EAAA,UAAP,SAAiB,GACP,IAAA,EAAM,EAAK,IAAI,GACd,OAAA,IAAI,EAAK,EAAI,EAAI,EAAK,EAAI,EAAI,EAAK,EAAI,EAAI,IAE/C,EAAA,IAAP,SAAW,GACA,OAAA,KAAK,KAAK,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,IAE1D,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,GAIvD,EAAA,UAAA,IAAA,SAAI,GAIO,OAHF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAIO,OAHF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAIO,OAHF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAIO,OAHF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,UAAA,WACU,IAAA,EAAM,KAAK,SAIV,OAHF,KAAA,GAAK,EACL,KAAA,GAAK,EACL,KAAA,GAAK,EACH,MAGX,EAAA,UAAA,OAAA,WACW,OAAA,EAAK,IAAI,OAGpB,EAAA,UAAA,IAAA,SAAI,GACO,OAAA,EAAK,IAAI,KAAM,IAE9B,EAhGA,GAAa,QAAA,KAAA;;ACAA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAb,IAAA,EAAA,WA2BI,SAAA,EAAY,EAAe,EAAe,EAAe,QAA7C,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,GAChD,KAAA,EAAI,EACJ,KAAA,EAAI,EACJ,KAAA,EAAI,EACJ,KAAA,EAAI,EA2EjB,OArGI,EAAA,UAAC,OAAO,UAAR,WAAA,IAAA,EAAA,KACQ,EAAO,EACJ,MAAA,CAAE,KAAM,WAAO,MAAA,CAAE,MAAO,EAAK,KAAS,KAAM,EAAO,MAG9D,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAMtB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAN5B,YAAA,EAVI,cAAA,IAWT,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAMtB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAN5B,YAAA,EAXI,cAAA,IAYT,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAMtB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAN5B,YAAA,EAZI,cAAA,IAaT,OAAA,eAAI,EAAA,UAAA,IAAC,CAAL,IAAA,WAAiB,OAAA,KAAK,IAMtB,IAAA,SAAM,GAAsB,KAAA,GAAK,GAN5B,YAAA,EAbI,cAAA,IAcT,OAAA,eAAI,EAAA,UAAA,OAAI,CAAR,IAAA,WAAoB,MAAA,CAAC,KAAK,EAAG,KAAK,EAAG,KAAK,EAAG,KAAK,IAMlD,IAAA,SAAS,GACA,KAAA,EAAI,EAAM,GACV,KAAA,EAAI,EAAM,GACV,KAAA,EAAI,EAAM,GACV,KAAA,EAAI,EAAM,IAVX,YAAA,EAdC,cAAA,IAkCF,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAEtE,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAEtE,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAEtE,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAK,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,EAAG,EAAI,EAAI,EAAI,IAEtE,EAAA,UAAP,SAAiB,GACP,IAAA,EAAM,EAAK,IAAI,GACd,OAAA,IAAI,EAAK,EAAI,EAAI,EAAK,EAAI,EAAI,EAAK,EAAI,EAAI,EAAK,EAAI,EAAI,IAE5D,EAAA,IAAP,SAAW,GACA,OAAA,KAAK,KAAK,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,IAE1E,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,GAGvE,EAAA,UAAA,IAAA,SAAI,GAKO,OAJF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAKO,OAJF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAKO,OAJF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,IAAA,SAAI,GAKO,OAJF,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACT,KAAA,GAAK,EAAI,EACP,MAGX,EAAA,UAAA,UAAA,WACU,IAAA,EAAM,KAAK,SAKV,OAJF,KAAA,GAAK,EACL,KAAA,GAAK,EACL,KAAA,GAAK,EACL,KAAA,GAAK,EACH,MAGX,EAAA,UAAA,OAAA,WACW,OAAA,EAAK,IAAI,OAGpB,EAAA,UAAA,IAAA,SAAI,GACO,OAAA,EAAK,IAAI,KAAM,IArGV,EAAA,IAAM,IAAI,EAAK,EAAE,EAAE,EAAE,GAwGzC,EA1GA,GAAa,QAAA,KAAA;;ACCA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IARb,IAAA,EAAA,QAAA,UACA,EAAA,QAAA,UAOA,EAAA,WAsBI,SAAA,EAAY,GACJ,IAAA,IAAI,EAAE,EAAG,EAAE,EAAG,IACT,KAAA,GAAK,EAAK,GA6H3B,OAlJI,EAAA,UAAC,OAAO,UAAR,WAAA,IAAA,EAAA,KACQ,EAAO,EACJ,MAAA,CAAE,KAAM,WAAO,MAAA,CAAE,MAAO,EAAK,KAAS,KAAM,EAAO,MAG9D,OAAA,eAAI,EAAA,UAAA,QAAK,CAAT,IAAA,WAA2B,OAAA,IAAI,EAAA,KAAK,KAAK,GAAI,KAAK,KAAzC,YAAA,EARA,cAAA,IAST,OAAA,eAAI,EAAA,UAAA,KAAE,CAAN,IAAA,WAAwB,OAAA,IAAI,EAAA,KAAK,KAAK,GAAI,KAAK,KAAzC,YAAA,EATG,cAAA,IAUT,OAAA,eAAI,EAAA,UAAA,MAAG,CAAP,IAAA,WAAyB,OAAA,IAAI,EAAA,KAAK,KAAK,GAAI,KAAK,KAAzC,YAAA,EAVE,cAAA,IAWT,OAAA,eAAI,EAAA,UAAA,QAAK,CAAT,IAAA,WAA2B,OAAA,IAAI,EAAA,KAAM,KAAK,MAAM,SAAU,KAAK,GAAG,WAAzD,YAAA,EAXA,cAAA,IAaF,EAAA,IAAP,SAAW,EAAY,GACb,IAAA,EAAU,EAAJ,EACL,OAAA,IAAI,EAAA,KAAM,EAAI,EAAG,GAAI,EAAI,EAAG,GAAI,EAAI,EAAG,KAG3C,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAA,KAAK,EAAI,EAAE,GAAI,EAAI,EAAE,GAAI,EAAI,EAAE,KAQvC,EAAA,SAAP,WACW,OAAA,IAAI,EAAK,CACZ,EAAG,EAAG,EACN,EAAG,EAAG,EACN,EAAG,EAAG,KAIP,EAAA,YAAP,SAAmB,EAAW,GACnB,OAAA,IAAI,EAAK,CACZ,EAAG,EAAG,EACN,EAAG,EAAG,EACN,EAAG,EAAG,KAIP,EAAA,SAAP,SAAgB,GACN,IAAA,EAAI,KAAK,IAAI,GACb,EAAI,KAAK,IAAI,GACZ,OAAA,IAAI,EAAK,CACZ,EAAG,EAAG,GACN,EAAG,EAAG,EACN,EAAG,EAAG,KAIP,EAAA,MAAP,SAAa,EAAY,GAMd,OALQ,IAAI,EAAK,CACpB,EAAI,EAAI,EACR,EAAI,EAAI,EACR,EAAI,EAAI,KAKT,EAAA,IAAP,SAAW,EAAY,GAEZ,OAAA,IAAI,EAAK,CACZ,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAC3C,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAC3C,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAC3C,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAC3C,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAC3C,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAC3C,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAC3C,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAC3C,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,GAAK,EAAI,GAAG,EAAI,MAkB5C,EAAA,eAAP,SAAsB,EAAW,GAEtB,MAAA,CACH,EAAG,EAAM,EAAE,EAAI,GAAK,EAAM,EAAE,EAAI,GAAK,EAAM,EAAE,EAAI,GACjD,EAAG,EAAM,EAAE,EAAI,GAAK,EAAM,EAAE,EAAI,GAAK,EAAM,EAAE,EAAI,GACjD,EAAG,EAAM,EAAE,EAAI,GAAK,EAAM,EAAE,EAAI,GAAK,EAAM,EAAE,EAAI,KAkBzD,EAAA,UAAA,KAAA,WACW,OAAA,IAAI,EAAK,CACZ,KAAK,GAAI,KAAK,GAAI,KAAK,GACvB,KAAK,GAAI,KAAK,GAAI,KAAK,GACvB,KAAK,GAAI,KAAK,GAAI,KAAK,MAI/B,EAAA,UAAA,MAAA,SAAM,GAEG,IADC,IAAA,EAAI,OAAO,QACR,EAAI,EAAG,EAAI,EAAG,IACf,GAAA,KAAK,IAAI,KAAK,GAAK,EAAI,IAAM,EACtB,OAAA,EAGR,OAAA,GAGX,EAAA,UAAA,KAAA,SAAK,EAAY,GACR,KAAA,IAAM,EACN,KAAA,IAAM,GAGf,EAAA,UAAA,OAAA,SAAO,EAAY,GACV,KAAA,GAAK,EACL,KAAA,GAAK,GAGd,EAAA,UAAA,QAAA,SAAQ,GACC,KAAA,GAAK,GAGd,EAAA,UAAA,QAAA,SAAQ,GACC,KAAA,GAAK,GAElB,EArJA,GAAa,QAAA,KAAA;;ACAA,aAAA,IAAA,EAAA,MAAA,KAAA,QAAA,SAAA,EAAA,GAAA,IAAA,EAAA,mBAAA,QAAA,EAAA,OAAA,UAAA,IAAA,EAAA,OAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,KAAA,GAAA,EAAA,GAAA,IAAA,WAAA,IAAA,GAAA,KAAA,MAAA,EAAA,EAAA,QAAA,MAAA,EAAA,KAAA,EAAA,OAAA,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,OAAA,OAAA,GAAA,EAAA,MAAA,KAAA,UAAA,WAAA,IAAA,IAAA,EAAA,GAAA,EAAA,EAAA,EAAA,UAAA,OAAA,IAAA,EAAA,EAAA,OAAA,EAAA,UAAA,KAAA,OAAA,GAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IARb,IAAA,EAAA,QAAA,UACA,EAAA,QAAA,UAOA,EAAA,WAsCI,SAAA,EAAY,QAAA,IAAA,IAAA,EAAa,EAAK,UACtB,IAAA,IAAI,EAAE,EAAG,EAAE,GAAI,IACV,KAAA,GAAK,EAAI,GAsD1B,OAnFI,EAAA,UAAC,OAAO,UAAR,WAAA,IAAA,EAAA,KACQ,EAAO,EACJ,MAAA,CAAE,KAAM,WAAO,MAAA,CAAE,MAAO,EAAK,KAAS,KAAM,EAAO,OAU9D,OAAA,eAAI,EAAA,UAAA,QAAK,CAAT,IAAA,WAA2B,OAAA,IAAI,EAAA,KAAK,KAAK,GAAI,KAAK,GAAI,KAAK,KAAlD,YAAA,EAvBA,cAAA,IAwBT,OAAA,eAAI,EAAA,UAAA,KAAE,CAAN,IAAA,WAAwB,OAAA,IAAI,EAAA,KAAK,KAAK,GAAI,KAAK,GAAI,KAAK,KAAlD,YAAA,EAxBG,cAAA,IAyBT,OAAA,eAAI,EAAA,UAAA,UAAO,CAAX,IAAA,WAA6B,OAAA,IAAI,EAAA,KAAK,KAAK,GAAI,KAAK,GAAI,KAAK,MAAlD,YAAA,EAzBF,cAAA,IA0BT,OAAA,eAAI,EAAA,UAAA,MAAG,CAAP,IAAA,WAAyB,OAAA,IAAI,EAAA,KAAK,KAAK,IAAK,KAAK,IAAK,KAAK,MAApD,YAAA,EA1BE,cAAA,IA2BT,EAAA,UAAA,QAAA,WAAY,OAAA,EAAW,OAEhB,EAAA,IAAP,SAAW,EAAY,GACb,IAAA,EAAU,EAAJ,EACL,OAAA,IAAI,EAAA,KAAM,EAAI,EAAG,GAAI,EAAI,EAAG,GAAI,EAAI,EAAG,GAAI,EAAI,EAAG,KAGtD,EAAA,IAAP,SAAW,EAAY,GACZ,OAAA,IAAI,EAAA,KAAK,EAAI,EAAE,GAAI,EAAI,EAAE,GAAI,EAAI,EAAE,GAAI,EAAI,EAAE,MAQjD,EAAA,YAAP,SAAmB,EAAW,EAAW,GAC9B,OAAA,IAAI,EAAK,CACZ,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,KAIV,EAAA,MAAP,SAAa,EAAY,EAAY,GAC1B,OAAA,IAAI,EAAK,CACZ,EAAI,EAAI,EAAG,EACX,EAAI,EAAI,EAAG,EACX,EAAI,EAAI,EAAI,EACZ,EAAG,EAAG,EAAG,KAIV,EAAA,uBAAP,SAA8B,EAAc,EAAe,EAAgB,EAAa,EAAc,GAE3F,OAAA,IAAI,EAAK,CACZ,GAAO,EAAQ,GAAO,EAAK,EAAK,EAChC,EAAK,GAAO,EAAM,GAAS,EAAK,EAChC,EAAK,GAAK,GAAO,EAAM,GAAO,IAE1B,EAAQ,IAAS,EAAQ,KACzB,EAAM,IAAW,EAAM,KACvB,EAAM,IAAS,EAAM,GACzB,KAID,EAAA,IAAP,SAAW,EAAY,GACb,IAAA,EAAK,EAAK,IAAI,EAAK,GACnB,EAAK,EAAK,IAAI,EAAK,GACnB,EAAK,EAAK,IAAI,EAAK,GACnB,EAAK,EAAK,IAAI,EAAK,GAEnB,EAAK,EAAK,IAAI,EAAK,GACnB,EAAK,EAAK,IAAI,EAAK,GACnB,EAAK,EAAK,IAAI,EAAK,GACnB,EAAK,EAAK,IAAI,EAAK,GAElB,OAAA,IAAI,EAAK,CACZ,EAAA,KAAK,IAAI,EAAI,GAAK,EAAA,KAAK,IAAI,EAAG,GAAM,EAAA,KAAK,IAAI,EAAI,GAAK,EAAA,KAAK,IAAI,EAAI,GACnE,EAAA,KAAK,IAAI,EAAI,GAAK,EAAA,KAAK,IAAI,EAAG,GAAM,EAAA,KAAK,IAAI,EAAI,GAAK,EAAA,KAAK,IAAI,EAAI,GACnE,EAAA,KAAK,IAAI,EAAI,GAAK,EAAA,KAAK,IAAI,EAAG,GAAM,EAAA,KAAK,IAAI,EAAI,GAAK,EAAA,KAAK,IAAI,EAAI,GACnE,EAAA,KAAK,IAAI,EAAI,GAAK,EAAA,KAAK,IAAI,EAAG,GAAM,EAAA,KAAK,IAAI,EAAI,GAAK,EAAA,KAAK,IAAI,EAAI,MA1EpE,EAAA,SAAiB,IAAI,EAAK,CAC7B,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,IA0EjB,EA9FA,GAAa,QAAA,KAAA;;ACPA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAFb,IAAA,EAAA,QAAA,UAEA,EAAA,WAiBI,SAAA,EAAY,EAAW,EAAW,EAAW,GACpC,KAAA,IAAM,IAAI,EAAA,KAAK,EAAG,GAClB,KAAA,KAAO,IAAI,EAAA,KAAK,EAAG,GAOhC,OAtBI,OAAA,eAAI,EAAA,UAAA,OAAI,CAAR,IAAA,WAAoB,OAAA,KAAK,IAAI,GAArB,YAAA,EAJC,cAAA,IAKT,OAAA,eAAI,EAAA,UAAA,QAAK,CAAT,IAAA,WAAqB,OAAA,KAAK,IAAI,EAAI,KAAK,KAAK,GAAnC,YAAA,EALA,cAAA,IAMT,OAAA,eAAI,EAAA,UAAA,MAAG,CAAP,IAAA,WAAmB,OAAA,KAAK,IAAI,GAArB,YAAA,EANE,cAAA,IAOT,OAAA,eAAI,EAAA,UAAA,SAAM,CAAV,IAAA,WAAsB,OAAA,KAAK,IAAI,EAAI,KAAK,KAAK,GAAnC,YAAA,EAPD,cAAA,IAST,OAAA,eAAI,EAAA,UAAA,MAAG,CAAP,IAAA,WAAmB,OAAA,IAAI,EAAA,KAAK,KAAK,IAAI,EAAG,KAAK,IAAI,IAA1C,YAAA,EATE,cAAA,IAUT,OAAA,eAAI,EAAA,UAAA,MAAG,CAAP,IAAA,WAAmB,OAAA,EAAA,KAAK,IAAI,KAAK,IAAK,KAAK,OAApC,YAAA,EAVE,cAAA,IAYT,OAAA,eAAI,EAAA,UAAA,UAAO,CAAX,IAAA,WAAoC,MAAA,CAAC,EAAG,KAAK,IAAI,EAAG,EAAG,KAAK,IAAI,IAArD,YAAA,EAZF,cAAA,IAaT,OAAA,eAAI,EAAA,UAAA,WAAQ,CAAZ,IAAA,WAAoC,MAAA,CAAC,EAAG,KAAK,IAAI,EAAI,KAAK,KAAK,EAAG,EAAG,KAAK,IAAI,IAAlE,YAAA,EAbH,cAAA,IAcT,OAAA,eAAI,EAAA,UAAA,cAAW,CAAf,IAAA,WAAoC,MAAA,CAAC,EAAG,KAAK,IAAI,EAAI,KAAK,KAAK,EAAG,EAAG,KAAK,IAAI,EAAI,KAAK,KAAK,IAA7E,YAAA,EAdN,cAAA,IAeT,OAAA,eAAI,EAAA,UAAA,aAAU,CAAd,IAAA,WAAoC,MAAA,CAAC,EAAG,KAAK,IAAI,EAAG,EAAG,KAAK,IAAI,EAAI,KAAK,KAAK,IAAhE,YAAA,EAfL,cAAA,IAsBT,EAAA,UAAA,SAAA,SAAS,GACE,OAAA,EAAM,GAAK,KAAK,MAAQ,EAAM,EAAI,KAAK,OAC1C,EAAM,GAAK,KAAK,KAAO,EAAM,EAAI,KAAK,QAElD,EA1BA,GAAa,QAAA,KAAA;;ACUA,aAAA,IAAA,EAAA,MAAA,KAAA,UAAA,SAAA,GAAA,IAAA,EAAA,mBAAA,QAAA,OAAA,SAAA,EAAA,GAAA,EAAA,GAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,KAAA,GAAA,GAAA,GAAA,iBAAA,EAAA,OAAA,MAAA,CAAA,KAAA,WAAA,OAAA,GAAA,GAAA,EAAA,SAAA,OAAA,GAAA,CAAA,MAAA,GAAA,EAAA,KAAA,MAAA,KAAA,MAAA,IAAA,UAAA,EAAA,0BAAA,oCAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAZb,IAAA,EAAA,QAAA,KAYA,EAAA,WAKI,SAAA,EAAY,EAAY,GAJxB,KAAA,IAAY,IAAI,EAAA,KAChB,KAAA,IAAY,IAAI,EAAA,KAChB,KAAA,IAAc,KAGL,KAAA,IAAI,EAAI,EAAI,EACZ,KAAA,IAAI,EAAI,EAAI,EACZ,KAAA,IAAI,EAAI,EAAI,EACZ,KAAA,IAAI,EAAI,EAAI,EAiHzB,OA9GI,EAAA,UAAA,WAAA,SAAW,EAAY,EAAY,EAAY,EAAY,QAAA,IAAA,IAAA,GAAA,GAKlD,KAAA,IAAM,KAEL,IAAA,EAAK,KAAK,IAAI,EACd,EAAK,KAAK,IAAI,EACd,EAAK,KAAK,IAAI,EAAI,KAAK,IAAI,EAC3B,EAAK,KAAK,IAAI,EAAI,KAAK,IAAI,EAE3B,GAAO,EAAG,IAAO,EAAG,IAAO,EAAK,IAAO,EAAK,GAC/C,GAAQ,IAAR,EACC,OAAO,EAEL,IAAA,IAAM,EAAG,IAAO,EAAG,IAAO,EAAK,IAAO,EAAG,IAAO,EAInD,KAAE,GAAK,GAAK,GAAK,MAHP,EAAG,IAAO,EAAG,IAAO,EAAK,IAAO,EAAG,IAAO,GAGzB,GACnB,OAAA,EAGL,IAAA,EAAQ,IAAI,EAAA,KAAM,EAAK,GAAK,EAAK,GAAK,EAAK,GAAK,EAAK,IACrD,EAAS,EAAA,KAAK,cAAe,EAAA,KAAK,UAAU,EAAA,KAAK,IAAI,IAAI,EAAA,KAAK,EAAI,GAAK,IAAI,EAAA,KAAK,EAAI,MACtF,EAAO,IAAI,KAAK,KAAO,IACvB,EAAO,GAAK,EAAO,EACnB,EAAO,GAAK,EAAO,GAMnB,IAAA,EAAa,KACd,IACC,EAAa,IAAI,EAAI,EAAA,KAAK,IAAI,EAAO,KAAK,KAAM,EAAA,KAAK,QAAQ,KAAK,IAAK,KAGrE,IAAA,EAAc,CAChB,MAAO,EACP,OAAQ,EACR,SAAU,EAAA,KAAK,SAAS,KAAK,IAAK,GAClC,YAAa,KACb,aAAc,EACd,OAAQ,MAIL,OADF,KAAA,IAAM,GACJ,GAGX,EAAA,UAAA,aAAA,SAAa,EAAiB,EAA4B,GAhEjD,IAAA,EAAA,OAgEqB,IAAA,IAAA,EAAA,QAA4B,IAAA,IAAA,EAAA,MAClD,IAAA,EAAkB,KACjB,KAAA,IAAM,KAlEN,IAoEc,IAAA,IAAA,EAAA,EAAA,GAAM,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OACjB,IADE,IAAA,EAAK,EAAA,MACH,EAAE,EAAG,EAAE,EAAM,OAAO,OAAO,EAAG,IAAK,CACjC,IAAA,EAAK,EAAM,OAAO,GAClB,EAAK,EAAM,OAAO,EAAE,GAEtB,KAAK,WAAW,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAI,GAAkB,KACvD,KAAK,IAAI,UAAW,MAAA,OAAO,EAAP,EAAS,WAAwB,MAAX,MAC1C,EAAU,KAAK,KACP,OAAS,IA5E5B,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,QAmFA,KAAA,IAAM,EAER,EAAiB,GAAK,KAAK,QACO,MAAX,GAA4C,OAAzB,GAAiC,EAAqB,KAE3F,KAAK,IAAI,aAAa,aAAa,EAAQ,EAAgB,IAO5D,OAAa,OAAb,KAAK,KAGhB,EAAA,UAAA,KAAA,WACU,IAAA,EAAc,GAEb,OADF,KAAA,iBAAiB,GACf,GAGX,EAAA,UAAA,KAAA,WACU,IAAA,EAAiB,GAEhB,OADF,KAAA,iBAAiB,GACf,GAGH,EAAA,UAAA,iBAAR,SAAyB,GA9GhB,IAAA,EA+GU,MAAZ,KAAK,MAGR,EAAQ,KAAK,KAAK,KACG,QAArB,EAAA,KAAK,IAAI,oBAAY,IAAA,GAAA,EAAE,iBAAiB,KAGpC,EAAA,UAAA,iBAAR,SAAyB,GAtHhB,IAAA,EAAA,EAuHL,EAAQ,KAAK,MACS,QAAtB,EAAQ,QAAR,EAAA,KAAK,WAAG,IAAA,OAAA,EAAA,EAAE,oBAAY,IAAA,GAAA,EAAE,iBAAiB,IAEjD,EA1HA,GAAa,QAAA,IAAA;;ACRA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAHb,IAAA,EAAA,QAAA,UAGA,EAAA,WAEI,SAAA,EAAmB,QAAA,IAAA,IAAA,EAAA,IAAA,KAAA,OAAA,EAsDvB,OAnDW,EAAA,WAAP,SAAkB,EAAc,EAAc,EAAgB,GAEtD,IADE,IAAA,EAAkB,GAChB,EAAE,EAAG,GAAG,EAAW,IAAK,CAEtB,IAAA,EAAM,EAAM,KAAK,GAAM,EAAY,EACnC,EAAK,KAAK,IAAI,GAAK,EACnB,GAAK,KAAK,IAAI,GAAK,EAEzB,EAAO,KAAK,CAAC,EAAG,EAAO,EAAG,EAAG,EAAO,IAGjC,OAAA,IAAI,EAAM,IAGd,EAAA,SAAP,SAAgB,EAAY,EAAY,EAAY,GAKzC,OAAA,IAAI,EAJa,CACpB,CAAC,EAAG,EAAI,EAAG,GAAK,CAAC,EAAG,EAAI,EAAG,MAM5B,EAAA,QAAP,SAAe,EAAW,EAAW,EAAe,EAAgB,EAAa,QAAA,IAAA,IAAA,GAAA,GACzE,IAAA,EAAkB,CAClB,CAAC,EAAI,EAAM,EAAK,EAAI,EAAO,EAAG,EAAG,GACjC,CAAC,GAAI,EAAM,EAAK,EAAI,EAAO,EAAG,EAAG,GACjC,CAAC,GAAI,EAAM,EAAK,GAAI,EAAO,EAAG,EAAG,GACjC,CAAC,EAAI,EAAM,EAAK,GAAI,EAAO,EAAG,EAAG,IAS9B,OANH,GACA,EAAO,KAAM,CAAC,EAAI,EAAM,EAAK,EAAI,EAAO,EAAG,EAAG,IAK3C,IAAI,EAFX,EAAS,EAAO,IAAI,SAAA,GAAK,OAAA,EAAA,KAAK,eAAgB,EAAA,KAAK,IAAI,EAAA,KAAK,SAAS,GAAM,EAAA,KAAK,YAAY,EAAG,IAAK,OAKjG,EAAA,kBAAP,SAAyB,EAAW,EAAW,EAAe,EAAgB,GACpE,IAAA,EAAK,KAAK,KAAa,GAAR,GACf,EAAK,KAAK,KAAc,GAAT,GACjB,EAAkB,CAClB,CAAC,EAAG,EAAI,EAAQ,EAAG,EAAI,EAAI,EAAG,GAC9B,CAAC,EAAG,EAAI,EAAQ,EAAG,EAAI,EAAI,EAAG,GAC9B,CAAC,EAAG,EAAI,EAAQ,EAAG,EAAI,EAAI,EAAG,GAC9B,CAAC,EAAG,EAAI,EAAQ,EAAG,EAAI,EAAI,EAAG,IAG3B,OAAA,IAAI,EADX,EAAS,EAAO,IAAI,SAAA,GAAK,OAAA,EAAA,KAAK,eAAgB,EAAA,KAAK,IAAI,EAAA,KAAK,SAAS,GAAM,EAAA,KAAK,YAAY,EAAG,IAAK,OAG5G,EAxDA,GAAa,QAAA,MAAA;;ACIb,aAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,QAAA,eAAA,KAAA,QAAA,GAAA,EAAA,IAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAPA,EAAA,QAAA,WACA,EAAA,QAAA,WACA,EAAA,QAAA,WACA,EAAA,QAAA,WACA,EAAA,QAAA,WACA,EAAA,QAAA,WACA,EAAA,QAAA,UACA,EAAA,QAAA;;ACJa,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAHb,IAAA,EAAA,QAAA,WAGA,EAAA,WAMI,SAAA,EAAoB,GAApB,IAAA,EAAA,KAAoB,KAAA,OAAA,EAJpB,KAAA,IAAY,IAAI,EAAA,KAChB,KAAA,GAAW,IAAI,EAAA,KACf,KAAA,gBAA0B,EAkBlB,KAAA,sBAAwB,SAAC,GAC7B,EAAK,gBAAiB,GAGlB,KAAA,sBAAwB,SAAC,GAEvB,IAAA,EAAO,EAAK,OAAO,wBAEnB,EAAU,EAAK,IACrB,EAAK,IAAM,IAAI,EAAA,KAAK,EAAE,MAAQ,EAAK,EAAG,EAAE,MAAQ,EAAK,GACrD,EAAK,GAAK,EAAA,KAAK,IAAI,EAAK,IAAK,IAEzB,KAAA,oBAAsB,WAC1B,EAAK,gBAAiB,GA5BtB,SAAS,iBAAiB,YAAa,KAAK,uBAC5C,SAAS,iBAAiB,YAAa,KAAK,uBAC5C,SAAS,iBAAiB,UAAW,KAAK,qBA4BlD,OAzBI,EAAA,UAAA,QAAA,WACI,SAAS,oBAAoB,YAAa,KAAK,uBAC/C,SAAS,oBAAoB,YAAa,KAAK,uBAC/C,SAAS,oBAAoB,UAAW,KAAK,sBAGjD,EAAA,UAAA,OAAA,WACS,KAAA,GAAK,IAAI,EAAA,MAkBtB,EArCA,GAAa,QAAA,WAAA;;ACFA,aAAA,IAAA,EAAA,MAAA,KAAA,UAAA,WAAA,OAAA,EAAA,OAAA,QAAA,SAAA,GAAA,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,UAAA,OAAA,EAAA,EAAA,IAAA,IAAA,IAAA,KAAA,EAAA,UAAA,GAAA,OAAA,UAAA,eAAA,KAAA,EAAA,KAAA,EAAA,GAAA,EAAA,IAAA,OAAA,IAAA,MAAA,KAAA,YAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAb,IAAA,EAAA,WAKI,SAAA,EAAoB,GAApB,IAAA,EAAA,KAAoB,KAAA,OAAA,EAHpB,KAAA,aAAyC,GACzC,KAAA,SAAqC,GA8B7B,KAAA,oBAAsB,SAAC,GAC3B,EAAK,SAAS,EAAE,UAAW,GAGvB,KAAA,kBAAoB,SAAC,GACzB,EAAK,SAAS,EAAE,UAAW,GAhC3B,QAAQ,IAAI,2BACZ,SAAS,iBAAiB,UAAW,KAAK,qBAC1C,SAAS,iBAAiB,QAAS,KAAK,mBAiChD,OA7BI,EAAA,UAAA,QAAA,WACI,SAAS,oBAAoB,UAAW,KAAK,qBAC7C,SAAS,oBAAoB,QAAS,KAAK,oBAG/C,EAAA,UAAA,UAAA,SAAU,GACC,OAAA,KAAK,SAAS,KAAQ,GAGjC,EAAA,UAAA,cAAA,SAAc,GACF,OAAA,KAAK,SAAS,KAAS,KAAK,aAAa,KAAS,GAG9D,EAAA,UAAA,eAAA,SAAe,GACH,OAAA,KAAK,SAAS,KAAS,KAAK,aAAa,KAAS,GAG9D,EAAA,UAAA,OAAA,WACS,KAAA,aAAY,EAAA,GAAO,KAAK,WAWrC,EAzCA,GAAa,QAAA,cAAA;;ACCA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAHb,IAAA,EAAA,QAAA,gBACA,EAAA,QAAA,mBAEA,EAAA,WAMI,SAAA,EAAY,GACH,KAAA,MAAQ,IAAI,EAAA,WAAW,GACvB,KAAA,SAAW,IAAI,EAAA,cAAc,GAU1C,OAPI,EAAA,UAAA,QAAA,WACS,KAAA,MAAM,UACN,KAAA,SAAS,UAET,KAAA,SAAW,KACX,KAAA,MAAQ,MAErB,EAlBA,GAAa,QAAA,aAAA;;ACMA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAb,IAAA,EAAA,WAaI,SAAA,EAAsB,GAAA,KAAA,GAAA,EACb,KAAA,MAAQ,IAAI,MA+BzB,OAxCI,OAAA,eAAI,EAAA,UAAA,QAAK,CAAT,IAAA,WACW,OAAA,KAAK,MAAM,OADb,YAAA,EALA,cAAA,IAST,OAAA,eAAI,EAAA,UAAA,SAAM,CAAV,IAAA,WACW,OAAA,KAAK,MAAM,QADZ,YAAA,EATD,cAAA,IAiBT,EAAA,UAAA,QAAA,WACS,KAAA,GAAG,cAAc,KAAK,QACtB,KAAA,OAAS,MAGlB,EAAA,UAAA,KAAA,SAAK,GAAL,IAAA,EAAA,KACW,OAAA,IAAI,QAAmB,SAAC,EAAS,GACpC,EAAK,MAAM,YAAc,YACzB,EAAK,MAAM,IAAM,EACjB,EAAK,MAAM,iBAAiB,OAAQ,WAEhC,EAAK,OAAS,EAAK,GAAG,gBACtB,EAAK,GAAG,YAAY,EAAK,GAAG,WAAY,EAAK,QAE7C,EAAK,GAAG,cAAc,EAAK,GAAG,WAAY,EAAK,GAAG,mBAAoB,EAAK,GAAG,SAC9E,EAAK,GAAG,cAAc,EAAK,GAAG,WAAY,EAAK,GAAG,mBAAoB,EAAK,GAAG,SAC9E,EAAK,GAAG,cAAc,EAAK,GAAG,WAAY,EAAK,GAAG,eAAgB,EAAK,GAAG,QAC1E,EAAK,GAAG,cAAc,EAAK,GAAG,WAAY,EAAK,GAAG,eAAgB,EAAK,GAAG,QAE1E,EAAK,GAAG,WAAW,EAAK,GAAG,WAAY,EAAG,EAAK,GAAG,KAAM,EAAK,MAAO,EAAK,OAAQ,EAAG,EAAK,GAAG,KAAM,EAAK,GAAG,cAAe,EAAK,OAE9H,EAAK,GAAG,YAAY,EAAK,GAAG,WAAY,EAAK,QAE7C,EAAQ,QAKxB,EA7CA,GAAa,QAAA,UAAA;;ACPS,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAtB,IAAA,EAAA,WAMI,SAAA,EAAsB,GAAA,KAAA,GAAA,EAJtB,KAAA,QAAoB,GACpB,KAAA,QAAwB,KACxB,KAAA,WAAsC,GA2D1C,OAtDI,EAAA,UAAA,QAAA,WACS,KAAA,GAAG,cAAc,KAAK,UAG/B,EAAA,UAAA,OAAA,WACS,KAAA,GAAG,WAAW,KAAK,UAG5B,EAAA,UAAA,QAAA,WACS,KAAA,GAAG,WAAW,KAAK,UAG5B,EAAA,UAAA,cAAA,SAAc,EAA6B,EAAkC,GACpE,KAAA,GAAG,UAAU,EAAY,GACzB,KAAA,GAAG,cAAe,KAAK,GAAG,SAAW,GACrC,KAAA,GAAG,YAAY,KAAK,GAAG,WAAY,GACnC,KAAA,GAAG,cAAe,KAAK,GAAG,WAGzB,EAAA,UAAA,aAAV,SAAuB,EAAgB,GAC7B,IAAA,EAAS,KAAK,GAAG,aAAa,GAC/B,KAAA,GAAG,aAAa,EAAQ,GACxB,KAAA,GAAG,cAAc,GAEhB,IAAA,EAAM,KAAK,GAAG,iBAAiB,GAG9B,OAFF,KAAA,QAAQ,KAAK,YAAc,GAEzB,GAGD,EAAA,UAAA,cAAV,SAAwB,EAA2B,EAA6B,EAAkB,QAAA,IAAA,IAAA,GAAA,GACxF,IAAA,EAAU,KAAK,GAAG,gBACnB,KAAA,GAAG,aAAa,EAAS,GACzB,KAAA,GAAG,aAAa,EAAS,GAE1B,IAAA,IAAI,EAAI,EAAG,EAAI,EAAO,OAAQ,IACzB,KAAA,WAAW,EAAO,IAAM,EACxB,KAAA,GAAG,mBAAmB,EAAS,EAAG,EAAO,IAG7C,KAAA,GAAG,YAAY,GACf,KAAA,GAAG,gBAAgB,GAElB,IAAA,EAAM,KAAK,GAAG,kBAAkB,GAQ/B,OAPF,KAAA,QAAQ,KAAK,YAAc,GAE7B,IACM,KAAA,GAAG,aAAa,GAChB,KAAA,GAAG,aAAa,IAGlB,GAGf,EA/DA,GAAsB,QAAA,OAAA;;ACCT,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAb,IAAA,EAAA,WAWI,SAAA,EAAsB,GAAA,KAAA,GAAA,EATtB,KAAA,MAAgB,EAChB,KAAA,OAAiB,EACjB,KAAA,OAAuB,KAEvB,KAAA,cAAkC,KAClC,KAAA,cAAmC,KA6EvC,OArEI,EAAA,UAAA,KAAA,SAAK,EAAe,GAsBZ,OArBC,KAAA,MAAQ,EACR,KAAA,OAAS,EAIT,KAAA,OAAS,KAAK,GAAG,gBACjB,KAAA,GAAG,YAAY,KAAK,GAAG,WAAY,KAAK,QACxC,KAAA,GAAG,cAAc,KAAK,GAAG,WAAY,KAAK,GAAG,mBAAoB,KAAK,GAAG,SACzE,KAAA,GAAG,cAAc,KAAK,GAAG,WAAY,KAAK,GAAG,mBAAoB,KAAK,GAAG,SACzE,KAAA,GAAG,cAAc,KAAK,GAAG,WAAY,KAAK,GAAG,eAAgB,KAAK,GAAG,QACrE,KAAA,GAAG,cAAc,KAAK,GAAG,WAAY,KAAK,GAAG,eAAgB,KAAK,GAAG,QACrE,KAAA,GAAG,WAAW,KAAK,GAAG,WAAY,EAAG,KAAK,GAAG,KAAM,KAAK,MAAO,KAAK,OAAQ,EAAG,KAAK,GAAG,KAAM,KAAK,GAAG,cAAe,MAGpH,KAAA,cAAgB,KAAK,GAAG,oBACxB,KAAA,GAAG,gBAAgB,KAAK,GAAG,YAAa,KAAK,eAC7C,KAAA,GAAG,qBAAqB,KAAK,GAAG,YAAa,KAAK,GAAG,kBAAmB,KAAK,GAAG,WAAY,KAAK,OAAQ,GACzG,KAAA,GAAG,YAAY,CAAC,KAAK,GAAG,oBAGH,KAAK,GAAG,uBAAuB,KAAK,GAAG,cACxC,KAAK,GAAG,uBAI5B,KAAA,GAAG,gBAAgB,KAAK,GAAG,YAAa,MACxC,KAAA,GAAG,YAAY,KAAK,GAAG,WAAY,OAEjC,IAIX,EAAA,UAAA,QAAA,WACS,KAAA,GAAG,kBAAkB,KAAK,eAC1B,KAAA,GAAG,cAAc,KAAK,SAG/B,EAAA,UAAA,OAAA,WACI,EAAc,mBAAmB,KAAK,GAAI,OAG9C,EAAA,UAAA,QAAA,WACI,EAAc,oBAAoB,KAAK,KAGpC,EAAA,mBAAP,SAA0B,EAA4B,GAElD,EAAc,kBAAkB,KAAK,GAE/B,IAAA,EAAsB,EAAc,sBAC1C,EAAG,gBAAgB,EAAG,YAAa,EAAoB,eACvD,EAAG,SAAS,EAAG,EAAG,EAAoB,MAAO,EAAoB,SAI9D,EAAA,oBAAP,SAA2B,GACpB,EAAc,kBAAkB,OAAS,GACxC,EAAc,kBAAkB,MAE9B,IAAA,EAAsB,EAAc,sBAC1C,EAAG,gBAAgB,EAAG,YAAa,EAAoB,eACvD,EAAG,SAAS,EAAG,EAAG,EAAoB,MAAO,EAAoB,SAI9D,EAAA,oBAAP,WAjFS,IAAA,EAkFL,OAAgF,QAAhF,EAAO,EAAc,kBAAkB,EAAc,kBAAkB,OAAO,UAAE,IAAA,EAAA,EAAI,MAzEjF,EAAA,kBAAqC,GA2EhD,EApFA,GAAa,QAAA,cAAA;;ACyQA,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,WAAA,IAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,CAAA,UAAA,cAAA,OAAA,SAAA,EAAA,GAAA,EAAA,UAAA,IAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,EAAA,eAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,IAAA,OAAA,SAAA,EAAA,GAAA,SAAA,IAAA,KAAA,YAAA,EAAA,EAAA,EAAA,GAAA,EAAA,UAAA,OAAA,EAAA,OAAA,OAAA,IAAA,EAAA,UAAA,EAAA,UAAA,IAAA,IAAA,GAAA,EAAA,MAAA,KAAA,UAAA,WAAA,OAAA,EAAA,OAAA,QAAA,SAAA,GAAA,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,UAAA,OAAA,EAAA,EAAA,IAAA,IAAA,IAAA,KAAA,EAAA,UAAA,GAAA,OAAA,UAAA,eAAA,KAAA,EAAA,KAAA,EAAA,GAAA,EAAA,IAAA,OAAA,IAAA,MAAA,KAAA,YAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IA3Qb,IAMY,EANZ,EAAA,QAAA,WACA,EAAA,QAAA,aACA,EAAA,QAAA,YACA,EAAA,QAAA,gBACA,EAAA,QAAA,oBAEA,SAAY,GACR,EAAA,EAAA,KAAA,GAAA,OACA,EAAA,EAAA,UAAA,GAAA,YAFJ,CAAY,EAAA,QAAA,aAAA,QAAA,WAAU,KAKtB,IAAM,EAAgB,obAsBhB,EAAkB,y0BAwBxB,EAAA,SAAA,GACI,SAAA,EAAY,GAAZ,IAAA,EACI,EAAA,KAAA,KAAM,IAAG,KAgNJ,OA9ML,EAAK,QAAU,EAAK,cAChB,EAAK,aAAa,EAAe,EAAK,GAAG,eACzC,EAAK,aAAa,EAAiB,EAAK,GAAG,iBAC3C,CAAC,aAAc,UAAW,SAAS,GA2MlC,EA5Lb,OAtBqC,EAAA,EAAA,GAWjC,EAAA,UAAA,WAAA,SAAW,EAA6B,GAC9B,IAAA,EAAa,KAAK,GAAG,mBAAmB,KAAK,QAAS,YAAY,GACnE,KAAA,cAAc,EAAe,EAAY,IAGlD,EAAA,UAAA,cAAA,SAAc,GACJ,IAAA,EAAuB,KAAK,GAAG,mBAAmB,KAAK,QAAS,gBAChE,EAAM,EAAW,UAElB,KAAA,GAAG,iBAAiB,GAAsB,EAAM,IAE7D,EAtBA,CAAqC,EAAA,QAwBrC,EAAA,WASI,SAAA,EAAsB,EAA4B,EAAoB,GAAhD,KAAA,GAAA,EACb,KAAA,WAAa,EACb,KAAA,WAAa,EAEb,KAAA,IAAM,KAAK,GAAG,oBACd,KAAA,IAAM,KAAK,GAAG,eACd,KAAA,IAAM,KAAK,GAAG,eA4C3B,OAzCI,EAAA,UAAA,QAAA,WACS,KAAA,GAAG,aAAa,KAAK,KACrB,KAAA,GAAG,aAAa,KAAK,KACrB,KAAA,GAAG,kBAAkB,KAAK,MAGnC,EAAA,UAAA,KAAA,WACS,KAAA,GAAG,gBAAgB,KAAK,KACxB,KAAA,GAAG,WAAW,KAAK,GAAG,aAAc,KAAK,KACzC,KAAA,GAAG,WAAW,KAAK,GAAG,qBAAsB,KAAK,MAG1D,EAAA,UAAA,OAAA,WACS,KAAA,GAAG,WAAW,KAAK,GAAG,qBAAsB,MAC5C,KAAA,GAAG,WAAW,KAAK,GAAG,aAAc,MACpC,KAAA,GAAG,gBAAgB,OAG5B,EAAA,UAAA,oBAAA,SAAoB,GACV,IAAA,EAAmB,EAAqB,KAAK,WAC9C,KAAA,GAAG,WAAW,KAAK,GAAG,aAAc,EAAkB,KAAK,GAAG,eAGvE,EAAA,UAAA,mBAAA,SAAmB,GACT,IAAA,EAAkB,EAAoB,KAAK,WAC5C,KAAA,GAAG,WAAW,KAAK,GAAG,qBAAsB,EAAiB,KAAK,GAAG,eAG9E,EAAA,UAAA,oBAAA,SAAoB,EAAwB,EAAkB,GAErD,KAAA,GAAG,cAAc,KAAK,GAAG,aAAc,EAAG,EAAO,IAG1D,EAAA,UAAA,mBAAA,SAAmB,EAA0B,GAEpC,KAAA,GAAG,cAAc,KAAK,GAAG,qBAAsB,EAAG,EAAS,IAGpE,EAAA,UAAA,KAAA,SAAK,EAAoB,QAAA,IAAA,IAAA,EAAqB,KAAK,GAAG,WAC7C,KAAA,GAAG,aAAa,EAAY,EAAY,KAAK,GAAG,eAAgB,IAE7E,EA3DA,GA6DA,EAAA,WAkBI,SAAA,EAAsB,GAAA,KAAA,GAAA,EAftB,KAAA,MAAsB,IAAI,aAAa,MAGvC,KAAA,QAAuB,IAAI,YAAY,KAIvC,KAAA,KAAwC,EAAjC,aAAa,kBAEZ,KAAA,YAAsB,EACtB,KAAA,YAAsB,EAMrB,KAAA,OAAS,IAAI,EAAa,KAAK,GAAqC,EAAjC,aAAa,kBAAuB,YAAY,mBAEnF,KAAA,OAAO,OACP,KAAA,OAAO,mBAAmB,KAAK,QAAQ,QACvC,KAAA,OAAO,oBAAoB,KAAK,MAAM,QAGtC,KAAA,GAAG,wBAAwB,GAC3B,KAAA,GAAG,wBAAwB,GAC3B,KAAA,GAAG,wBAAwB,GAE1B,IAAA,EAAQ,KAAK,KACb,EAAQ,aAAa,kBAEtB,KAAA,GAAG,oBAAoB,EAAG,EAAG,KAAK,GAAG,OAAO,EAAO,EAAe,EAAR,GAC1D,KAAA,GAAG,oBAAoB,EAAG,EAAG,KAAK,GAAG,OAAO,EAAO,EAAe,EAAR,GAC1D,KAAA,GAAG,oBAAoB,EAAG,EAAG,KAAK,GAAG,OAAO,EAAO,EAAe,EAAR,GAE1D,KAAA,OAAO,SA8EpB,OApGI,OAAA,eAAI,EAAA,UAAA,mBAAgB,CAApB,IAAA,WAAwC,OAAmB,EAAnB,KAAK,aAAzB,YAAA,EA8GX,cAAA,IA7GT,OAAA,eAAI,EAAA,UAAA,qBAAkB,CAAtB,IAAA,WAA0C,OAAmB,EAAnB,KAAK,aAAzB,YAAA,EA6Gb,cAAA,IArFT,EAAA,UAAA,QAAA,WACS,KAAA,OAAO,UACP,KAAA,OAAS,MAGlB,EAAA,UAAA,KAAA,SAAK,QAAA,IAAA,IAAA,EAAqB,KAAK,GAAG,WACzB,KAAA,OAAO,OACP,KAAA,OAAO,oBAAoB,KAAK,MAAO,KAAK,YAAa,GACzD,KAAA,OAAO,mBAAmB,KAAK,QAAS,KAAK,oBAC7C,KAAA,OAAO,KAAK,KAAK,mBAAoB,GACrC,KAAA,OAAO,UAGhB,EAAA,UAAA,OAAA,SAAO,GACG,IAAA,EAAI,EAAQ,KAAK,KACjB,EAAO,KAAK,MACX,MAAA,CAAC,EAAG,EAAK,EAAE,GAAI,EAAG,EAAK,EAAE,GAAI,EAAG,EAAK,EAAE,KAGlD,EAAA,UAAA,SAAA,SAAS,GACC,IAAA,EAAI,EAAQ,KAAK,KACjB,EAAO,KAAK,MACX,MAAA,CAAC,EAAG,EAAK,EAAE,GAAI,EAAG,EAAK,EAAE,GAAI,EAAG,EAAK,EAAE,GAAI,EAAG,EAAK,EAAE,KAGhE,EAAA,UAAA,MAAA,SAAM,GACI,IAAA,EAAI,EAAQ,KAAK,KACjB,EAAO,KAAK,MACX,MAAA,CAAC,EAAG,EAAK,EAAE,GAAI,EAAG,EAAK,EAAE,KAGpC,EAAA,UAAA,OAAA,SAAO,GACG,IAAA,EAAI,KAAK,iBACT,EAAO,KAAK,MAIX,OAHP,EAAK,EAAE,GAAK,EAAM,EAClB,EAAK,EAAE,GAAK,EAAM,EAClB,EAAK,EAAE,GAAK,EAAM,EACX,MAGX,EAAA,UAAA,SAAA,SAAS,GACC,IAAA,EAAI,KAAK,iBACT,EAAO,KAAK,MAKX,OAJP,EAAK,EAAE,GAAK,EAAM,EAClB,EAAK,EAAE,GAAK,EAAM,EAClB,EAAK,EAAE,GAAK,EAAM,EAClB,EAAK,EAAE,GAAK,EAAM,EACX,MAGX,EAAA,UAAA,MAAA,SAAM,GACI,IAAA,EAAI,KAAK,iBACT,EAAO,KAAK,MAGX,OAFP,EAAK,EAAE,GAAK,EAAM,EAClB,EAAK,EAAE,GAAK,EAAM,EACX,MAGX,EAAA,UAAA,MAAA,WACS,KAAA,YAAc,EACd,KAAA,YAAc,GAGvB,EAAA,UAAA,SAAA,WACW,OAAA,KAAK,eAGhB,EAAA,UAAA,SAAA,SAAS,EAAY,EAAY,GAKtB,OAJF,KAAA,QAAQ,KAAK,mBAAmB,GAAK,EACrC,KAAA,QAAQ,KAAK,mBAAmB,GAAK,EACrC,KAAA,QAAQ,KAAK,mBAAmB,GAAK,EACrC,KAAA,aAAe,EACb,MAGf,EAnHA,GA6HA,EAAA,WAkBI,SAAA,EAAoB,EAAmC,GAAnC,KAAA,OAAA,EAAmC,KAAA,GAAA,EAhB/C,KAAA,WAAmB,IAAI,EAAA,KAKvB,KAAA,YAAsB,EACtB,KAAA,eAA+B,CAAC,KAAM,KAAM,KAAM,KAAM,MACxD,KAAA,iBAA2B,EAE3B,KAAA,kBAA4B,EAI5B,KAAA,YAAgC,GAChC,KAAA,WAAqB,EAOpB,KAAA,aAAe,IAAI,EAAA,UAAU,KAAK,IAClC,KAAA,aAAa,KAAK,sHAElB,KAAA,WAAU,GAGV,KAAA,OAAS,IAAI,EAAuB,KAAK,IAGzC,KAAA,aAAe,IAAI,EAAa,KAAK,IAsRlD,OAnRI,EAAA,UAAA,QAAA,WACS,KAAA,aAAa,UACb,KAAA,OAAO,WAGhB,EAAA,UAAA,MAAA,WACS,KAAA,kBAAmB,EACnB,KAAA,aAAa,QACb,KAAA,iBAAmB,EAElB,IAAA,EAAe,EAAA,cAAc,sBAGV,KAAK,WAAX,MAAhB,EAAwC,EAAA,KAAK,uBAAuB,EAAG,KAAK,OAAO,MAAO,KAAK,OAAO,OAAQ,EAAG,EAAG,KAChG,EAAA,KAAK,uBAAuB,EAAG,EAAa,MAAO,EAAa,OAAQ,EAAG,EAAG,KAEhG,KAAA,GAAG,OAAO,KAAK,GAAG,OAClB,KAAA,GAAG,UAAU,KAAK,GAAG,UAAW,KAAK,GAAG,qBACxC,KAAA,GAAG,kBAAkB,KAAK,GAAG,UAAW,KAAK,GAAG,oBAAqB,KAAK,GAAG,IAAK,KAAK,GAAG,KAE1F,KAAA,OAAO,SACP,KAAA,OAAO,cAAc,KAAK,aAGnC,EAAA,UAAA,IAAA,WACS,KAAA,aACA,KAAA,kBAAmB,EAGnB,KAAA,YAAc,GACd,KAAA,WAAU,GAGV,KAAA,WAAa,GAGtB,EAAA,UAAA,SAAA,SAAS,EAAc,EAAc,EAAe,EAAgB,EAAa,EAAiB,GAvEzF,IAAA,EAAA,EAAA,EAyEF,KAAK,eACJ,KAAK,aAEH,IAAA,EAAQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACnD,EAAY,KAAK,WAAwB,QAAd,EAAC,EAAM,eAAO,IAAA,EAAA,EAAI,KAAK,cAClD,EAAmB,QAAd,EAAG,EAAM,aAAK,IAAA,EAAA,EAAI,CAAC,EAAA,KAAK,IAAK,EAAA,KAAK,IAAK,EAAA,KAAK,IAAK,EAAA,KAAK,KAC3D,EAAqB,QAAf,EAAG,EAAM,cAAM,IAAA,EAAA,EAAI,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,GAE3C,EACN,EAAA,KAAK,IAAI,EAAA,KAAK,IAAK,EAAA,KAAK,MAAM,EAAO,GACnB,EAAA,KAAK,SAAS,IACvB,EAAA,KAAK,YAAY,EAAM,IAG1B,EAAY,EAAA,KAAK,eAAe,EAAW,CAAE,EAAI,EAAI,EAAU,EAAI,EAAI,EAAU,EAAG,IACpF,EAAY,EAAA,KAAK,eAAe,EAAW,CAAE,EAAI,EAAI,EAAU,EAAI,EAAI,EAAU,EAAG,IACpF,EAAY,EAAA,KAAK,eAAe,EAAW,CAAE,EAAI,EAAI,EAAU,EAAI,EAAI,EAAU,EAAG,IACpF,EAAY,EAAA,KAAK,eAAe,EAAW,CAAE,EAAI,EAAI,EAAU,EAAI,EAAI,EAAU,EAAG,IAI1F,EAAG,EAAI,EAAW,EAAG,EAAI,EAAW,EAAG,EAAI,EAAW,EAAG,EAAI,EAGvD,IAAA,EAAK,KAAK,aAAa,OAAO,GAAI,SAAS,EAAM,IAAI,MAAM,EAAO,SAAS,WAC3E,EAAK,KAAK,aAAa,OAAO,GAAI,SAAS,EAAM,IAAI,MAAM,EAAO,UAAU,WAC5E,EAAK,KAAK,aAAa,OAAO,GAAI,SAAS,EAAM,IAAI,MAAM,EAAO,aAAa,WAC/E,EAAK,KAAK,aAAa,OAAO,GAAI,SAAS,EAAM,IAAI,MAAM,EAAO,YAAY,WAG/E,KAAA,aAAa,SAAS,EAAI,EAAI,GAAI,SAAS,EAAI,EAAI,IAG5D,EAAA,UAAA,SAAA,SAAS,EAAY,EAAY,EAAY,EAAY,EAAmB,GACnE,KAAA,UAAU,CAAC,IAAI,EAAA,KAAK,EAAI,GAAK,IAAI,EAAA,KAAK,EAAI,IAAM,EAAW,IAGpE,EAAA,UAAA,UAAA,SAAU,EAAiB,EAAe,GA9GjC,IAAA,EAAA,EAAA,EAgHF,KAAK,eACJ,KAAK,aAET,EAAa,MAAA,EAAA,EAAc,GAEtB,KAAA,YAQD,IAPE,IAAA,EAAQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACnD,EAAY,KAAK,WAAW,KAAK,cACjC,EAAsB,QAAjB,EAAG,EAAM,MAAM,UAAE,IAAA,EAAA,EAAI,EAAA,KAAK,IAE/B,EAAU,GAEZ,EAAO,EAAA,KAAK,KACR,EAAE,EAAG,EAAE,EAAO,OAAQ,IAAK,CAEzB,IAAA,EAAK,EAAO,GACZ,EAAgB,QAAd,EAAG,EAAO,EAAE,UAAE,IAAA,EAAA,EAAI,EAAA,KAAK,IAAI,EAAI,GAEjC,EAAO,EAAA,KAAK,IAAI,MAAA,EAAA,EAAM,EAAI,GAAI,YAE9B,EAAU,EAAA,KAAK,IAAI,EAAM,GAAM,YAC/B,EAAU,EAAA,KAAK,cAAc,GAC7B,EAAW,EAAQ,EAAQ,IAAI,EAAA,KAAK,cAAc,IAAS,GAC3D,EAAI,EAAA,KAAK,IAAI,EAAS,CAAC,EAAG,EAAU,EAAG,IAEvC,EAAmB,QAAhB,EAAG,EAAW,UAAE,IAAA,EAAA,EAAI,EAEvB,EAAK,KAAK,aAAa,OAAO,CAAC,EAAG,EAAG,EAAI,EAAE,EAAG,EAAG,EAAG,EAAI,EAAE,EAAG,EAAG,IAAY,SAAS,GAAK,MAAM,CAAC,EAAG,EAAG,EAAG,IAAI,WAC9G,EAAK,KAAK,aAAa,OAAO,CAAC,EAAG,EAAG,EAAI,EAAE,EAAG,EAAG,EAAG,EAAI,EAAE,EAAG,EAAG,IAAY,SAAS,GAAK,MAAM,CAAC,EAAG,EAAG,EAAG,IAAI,WACpH,EAAQ,KAAK,GACb,EAAQ,KAAK,GAEb,EAAO,EAGP,IAAI,EAAE,EAAG,EAAE,EAAQ,OAAO,EAAG,GAAK,EAAG,CAC/B,IAAA,EAAQ,EAAQ,GACjB,KAAA,aAAa,SAAS,EAAO,EAAM,EAAG,EAAM,GAC5C,KAAA,aAAa,SAAS,EAAM,EAAG,EAAM,EAAG,EAAM,GAGlD,KAAA,YAIT,EAAA,UAAA,WAAA,SAAW,EAAc,EAAc,EAAgB,GA7J9C,IAAA,EAAA,EAAA,EA8JF,KAAK,eACJ,KAAK,aAaL,IAXE,IAAA,EAAQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACnD,EAAY,KAAK,WAAwB,QAAd,EAAC,EAAM,eAAO,IAAA,EAAA,EAAI,KAAK,cAClD,EAAsB,QAAjB,EAAG,EAAM,MAAM,UAAE,IAAA,EAAA,EAAI,EAAA,KAAK,IAC/B,EAAqB,QAAf,EAAG,EAAM,cAAM,IAAA,EAAA,EAAI,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,GAE3C,EAAK,KAAK,aACX,OAAO,CAAC,EAAG,EAAM,EAAG,EAAM,EAAG,IAC7B,SAAS,GACT,MAAM,CAAC,EAAkC,IAA9B,EAAO,MAAQ,EAAO,MAAa,EAAkC,IAA9B,EAAO,OAAS,EAAO,OACzE,WAEG,EAAE,EAAG,GAAG,EAAW,IAAK,CACtB,IAAA,EAAM,EAAM,KAAK,GAAM,EAAY,EACnC,EAAK,KAAK,IAAI,GACd,GAAK,KAAK,IAAI,GAEf,KAAA,aACA,OAAO,CAAC,EAAG,EAAI,EAAS,EAAM,EAAG,EAAI,EAAS,EAAM,EAAG,IACvD,SAAS,GACT,MAAM,CAAC,EAAO,GAAJ,EAAU,GAAK,EAAO,GAAJ,EAAU,KACtC,WAGL,IAAI,EAAE,EAAG,GAAG,EAAU,IAClB,KAAA,aAAa,SAAS,EAAI,EAAG,EAAG,EAAG,EAAE,IAIjD,EAAA,UAAA,MAAA,SAAM,EAAe,EAAe,EAAe,QAA7C,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,QAAe,IAAA,IAAA,EAAA,GAC1C,KAAA,GAAG,WAAW,EAAG,EAAG,EAAG,GACvB,KAAA,GAAG,MAAM,KAAK,GAAG,mBAE1B,EAAA,UAAA,WAAA,SAAW,GACO,KAAK,YAAY,KAAK,YAAY,OAAS,GACnD,QAAU,GAGpB,EAAA,UAAA,SAAA,SAAS,GACC,IAAA,EAAQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACzD,EAAM,MAAM,GAAK,EACjB,EAAM,MAAM,GAAK,EACjB,EAAM,MAAM,GAAK,EACjB,EAAM,MAAM,GAAK,GAGrB,EAAA,UAAA,eAAA,SAAe,EAAY,EAAY,EAAY,GACzC,IAAA,EAAQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACzD,EAAM,MAAM,GAAK,EACjB,EAAM,MAAM,GAAK,EACjB,EAAM,MAAM,GAAK,EACjB,EAAM,MAAM,GAAK,GAGrB,EAAA,UAAA,UAAA,SAAU,GACQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACnD,OAAS,GAGnB,EAAA,UAAA,cAAA,SAAc,GACJ,IAAA,EAAQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACtD,EAAM,YAAc,IACd,KAAA,aACL,EAAM,WAAa,IAI3B,EAAA,UAAA,UAAA,SAAU,QAAA,IAAA,IAAA,GAAA,GACA,IAAA,EAAQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACnD,EAAY,EAAsB,CACpC,MAAO,CAAC,EAAA,KAAK,IAAK,EAAA,KAAK,IAAK,EAAA,KAAK,IAAK,EAAA,KAAK,KAC3C,OAAQ,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,GAC1B,QAAS,KAAK,aACd,WAAY,EAAW,MAJK,EAO3B,KAAA,YAAY,KAAI,EAAA,EAAA,GAAK,KAAK,YAAY,KAAK,YAAY,OAAO,IAC5D,KAIX,EAAA,UAAA,SAAA,WACO,KAAA,KAAK,YAAY,QAAU,GAA3B,CAIG,IAAA,EAAQ,KAAK,YAAY,KAAK,YAAY,OAAS,GACnD,EAAW,KAAK,YAAY,KAAK,YAAY,OAAS,GAExD,GAAQ,GACZ,EAAQ,GAAS,EAAM,YAAc,EAAS,aAG1C,KAAK,aAEJ,KAAA,YAAY,QAGb,EAAA,UAAA,WAAR,SAAmB,GAGX,IAAA,IAAI,EAAE,EAAG,GAAG,KAAK,iBAAkB,IAChC,GAAA,KAAK,eAAe,IAAM,EACzB,OAAO,EAiBR,OAbH,KAAK,kBAAoB,KAAK,aAC9B,KAAK,aAGJ,KAAA,eAAe,KAAK,kBAAoB,EAGxC,KAAA,OAAO,WAAW,EAAQ,OAAQ,KAAK,kBAGvC,KAAA,kBAAoB,EAGlB,KAAK,iBAAmB,GAG3B,EAAA,UAAA,WAAR,WACO,GAAyC,IAAzC,KAAK,aAAa,oBAAmE,IAAvC,KAAK,aAAa,mBAAoD,IAA1B,KAAK,iBAA/F,CAGC,IAAA,EAAa,KAAK,GAAG,UACjB,OAAA,KAAK,YAAY,KAAK,YAAY,OAAO,GAAG,YAC3C,KAAA,EAAW,KAAM,EAAa,KAAK,GAAG,UAAW,MACjD,KAAA,EAAW,UAAW,EAAa,KAAK,GAAG,WAI/C,KAAA,aAAa,KAAK,GAClB,KAAA,aAAa,QAGd,IAAA,IAAI,EAAE,EAAG,EAAE,KAAK,YAAa,IACxB,KAAA,eAAe,GAAK,KAExB,KAAA,iBAAmB,EACnB,KAAA,YAAc,IAGf,EAAA,UAAA,YAAR,WAGW,OAFS,KAAK,aAAa,kBAAoB,KAAK,aAAa,MAAM,OAAO,GACrE,KAAK,aAAa,kBAAoB,KAAK,aAAa,QAAQ,OAAO,GAG/F,EAtTA,GAAa,QAAA,WAAA;;AC3QA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAb,IAAA,EAAA,WAAA,SAAA,IACI,KAAA,UAAoB,EACpB,KAAA,UAAoB,EACpB,KAAA,SAAmB,EAUvB,OARI,EAAA,UAAA,MAAA,WACS,KAAA,SAAW,EACX,KAAA,UAAY,YAAY,MAAQ,KAEzC,EAAA,UAAA,KAAA,WACS,KAAA,SAAW,YAAY,MAAQ,IAC/B,KAAA,UAAY,KAAK,SAAW,KAAK,WAE9C,EAbA,GAAa,QAAA,MAAA;;ACEA,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,WAAA,IAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,CAAA,UAAA,cAAA,OAAA,SAAA,EAAA,GAAA,EAAA,UAAA,IAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,EAAA,eAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,IAAA,OAAA,SAAA,EAAA,GAAA,SAAA,IAAA,KAAA,YAAA,EAAA,EAAA,EAAA,GAAA,EAAA,UAAA,OAAA,EAAA,OAAA,OAAA,IAAA,EAAA,UAAA,EAAA,UAAA,IAAA,IAAA,GAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAFb,IAAA,EAAA,QAAA,WAEA,EAAA,SAAA,GAOI,SAAA,IAAA,IAAA,EACI,EAAA,KAAA,OAAO,KARF,OAET,EAAA,gBAA0B,EAElB,EAAA,aAAuB,EACvB,EAAA,YAAsB,EALrB,EAwBb,OAxBgC,EAAA,EAAA,GAW5B,EAAA,UAAA,OAAA,WACS,KAAA,OACA,KAAA,aAAe,KAAK,UACpB,KAAA,cAAgB,EAElB,KAAK,aAAe,IACd,KAAA,gBAAkB,KAAK,aACvB,KAAA,YAAc,EACd,KAAA,aAAe,GAGnB,KAAA,SAEb,EAxBA,CAAgC,EAAA,OAAnB,QAAA,WAAA;;ACGA,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,MAAA,aAAA,EAAA,EAAA,IAAA,EAAA,SAAA,GAAA,EAAA,MAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,EAAA,MAAA,KAAA,aAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,MAAA,EAAA,KAAA,WAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,KAAA,GAAA,IAAA,IAAA,OAAA,EAAA,CAAA,KAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,mBAAA,SAAA,EAAA,OAAA,UAAA,WAAA,OAAA,OAAA,EAAA,SAAA,EAAA,GAAA,OAAA,SAAA,GAAA,OAAA,SAAA,GAAA,GAAA,EAAA,MAAA,IAAA,UAAA,mCAAA,KAAA,GAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,GAAA,EAAA,SAAA,EAAA,EAAA,KAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,OAAA,EAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,GAAA,EAAA,QAAA,EAAA,IAAA,KAAA,EAAA,KAAA,EAAA,EAAA,EAAA,MAAA,KAAA,EAAA,OAAA,EAAA,QAAA,CAAA,MAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,GAAA,EAAA,CAAA,GAAA,SAAA,KAAA,EAAA,EAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,QAAA,KAAA,GAAA,EAAA,EAAA,MAAA,OAAA,GAAA,EAAA,EAAA,OAAA,MAAA,IAAA,EAAA,IAAA,IAAA,EAAA,IAAA,CAAA,EAAA,EAAA,SAAA,GAAA,IAAA,EAAA,MAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,CAAA,EAAA,MAAA,EAAA,GAAA,MAAA,GAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,EAAA,MAAA,GAAA,GAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,KAAA,GAAA,MAAA,EAAA,IAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,EAAA,EAAA,KAAA,EAAA,GAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,QAAA,EAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IALb,IAAA,EAAA,QAAA,wBACA,EAAA,QAAA,yBACA,EAAA,QAAA,sBACA,EAAA,QAAA,4BAEA,EAAA,WASI,SAAA,EAAY,GACH,KAAA,OAAS,SAAS,eAAe,GACjC,KAAA,SACA,KAAA,MAAQ,IAAI,EAAA,aAAa,KAAK,QAC9B,KAAA,KAAO,IAAI,EAAA,WAEX,KAAA,GAAK,KAAK,OAAO,WAAW,SAAU,CACvC,WAAW,IAGV,KAAA,GAAG,SAAS,EAAG,EAAG,KAAK,OAAO,MAAO,KAAK,OAAO,QAGhD,IAAA,EAAqB,IAAI,EAAA,cAAc,KAAK,IAClD,EAAmB,MAAQ,KAAK,OAAO,MACvC,EAAmB,OAAS,KAAK,OAAO,OACxC,EAAmB,SAEd,KAAA,WAAa,IAAI,EAAA,WAAW,KAAK,OAAQ,KAAK,IAoD3D,OAjDI,EAAA,UAAA,QAAA,WACS,KAAA,MAAM,UACN,KAAA,MAAQ,MAGX,EAAA,UAAA,WAAN,WAnCS,OAAA,EAAA,UAAA,OAAA,EAAA,WAAA,OAAA,EAAA,KAAA,SAAA,GAAA,MAAA,CAAA,QAuCH,EAAA,UAAA,OAAN,WAvCS,OAAA,EAAA,UAAA,OAAA,EAAA,WAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EAwCL,MAAA,CAAA,EAAM,KAAK,cAxCN,KAAA,EAAA,OAwCL,EAAA,OACK,KAAA,MAzCA,CAAA,SA4CT,EAAA,UAAA,OAAA,aAGA,EAAA,UAAA,KAAA,WACS,KAAA,GAAG,WAAW,EAAK,EAAK,EAAK,GAC7B,KAAA,GAAG,MAAM,KAAK,GAAG,iBAAmB,KAAK,GAAG,mBAGrD,EAAA,UAAA,IAAA,WAAA,IAAA,EAAA,KACS,KAAA,KAAK,SACL,KAAA,SACA,KAAA,OAEA,KAAA,MAAM,SAAS,SACf,KAAA,MAAM,MAAM,SAEjB,sBAAsB,WACjB,EAAK,SAIN,EAAA,UAAA,OAAR,WAEQ,IAAA,EAAgB,KAAK,OAAO,YAC5B,EAAgB,KAAK,OAAO,aAG5B,KAAK,OAAO,QAAW,GACvB,KAAK,OAAO,SAAW,IAGpB,KAAA,OAAO,MAAS,EAChB,KAAA,OAAO,OAAS,IAG/B,EA/EA,GAAa,QAAA,IAAA;;ACKA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAXb,IAAA,EAAA,QAAA,qBAWa,QAAA,OAAuB,CAChC,CACI,SAAU,GACV,KAAM,EACN,KAAM,EACN,UAAW,CAAC,EAAG,GACf,IAAM,CACF,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QACzD,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QACzD,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QACzD,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QACzD,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QACzD,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QACzD,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QACzD,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,SAE7D,MAAO,CACH,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG;;;;ACuXjB,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,WAAA,IAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,CAAA,UAAA,cAAA,OAAA,SAAA,EAAA,GAAA,EAAA,UAAA,IAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,EAAA,eAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,IAAA,OAAA,SAAA,EAAA,GAAA,SAAA,IAAA,KAAA,YAAA,EAAA,EAAA,EAAA,GAAA,EAAA,UAAA,OAAA,EAAA,OAAA,OAAA,IAAA,EAAA,UAAA,EAAA,UAAA,IAAA,IAAA,GAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,MAAA,aAAA,EAAA,EAAA,IAAA,EAAA,SAAA,GAAA,EAAA,MAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,EAAA,MAAA,KAAA,aAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,MAAA,EAAA,KAAA,WAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,KAAA,GAAA,IAAA,IAAA,OAAA,EAAA,CAAA,KAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,mBAAA,SAAA,EAAA,OAAA,UAAA,WAAA,OAAA,OAAA,EAAA,SAAA,EAAA,GAAA,OAAA,SAAA,GAAA,OAAA,SAAA,GAAA,GAAA,EAAA,MAAA,IAAA,UAAA,mCAAA,KAAA,GAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,GAAA,EAAA,SAAA,EAAA,EAAA,KAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,OAAA,EAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,GAAA,EAAA,QAAA,EAAA,IAAA,KAAA,EAAA,KAAA,EAAA,EAAA,EAAA,MAAA,KAAA,EAAA,OAAA,EAAA,QAAA,CAAA,MAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,GAAA,EAAA,CAAA,GAAA,SAAA,KAAA,EAAA,EAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,QAAA,KAAA,GAAA,EAAA,EAAA,MAAA,OAAA,GAAA,EAAA,EAAA,OAAA,MAAA,IAAA,EAAA,IAAA,IAAA,EAAA,IAAA,CAAA,EAAA,EAAA,SAAA,GAAA,IAAA,EAAA,MAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,CAAA,EAAA,MAAA,EAAA,GAAA,MAAA,GAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,EAAA,MAAA,GAAA,GAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,KAAA,GAAA,MAAA,EAAA,IAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,EAAA,EAAA,KAAA,EAAA,GAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,QAAA,EAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,EAAA,MAAA,KAAA,UAAA,SAAA,GAAA,IAAA,EAAA,mBAAA,QAAA,OAAA,SAAA,EAAA,GAAA,EAAA,GAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,KAAA,GAAA,GAAA,GAAA,iBAAA,EAAA,OAAA,MAAA,CAAA,KAAA,WAAA,OAAA,GAAA,GAAA,EAAA,SAAA,OAAA,GAAA,CAAA,MAAA,GAAA,EAAA,KAAA,MAAA,KAAA,MAAA,IAAA,UAAA,EAAA,0BAAA,oCAAA,EAAA,MAAA,KAAA,QAAA,SAAA,EAAA,GAAA,IAAA,EAAA,mBAAA,QAAA,EAAA,OAAA,UAAA,IAAA,EAAA,OAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,KAAA,GAAA,EAAA,GAAA,IAAA,WAAA,IAAA,GAAA,KAAA,MAAA,EAAA,EAAA,QAAA,MAAA,EAAA,KAAA,EAAA,OAAA,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,OAAA,OAAA,GAAA,EAAA,MAAA,KAAA,UAAA,WAAA,IAAA,IAAA,EAAA,GAAA,EAAA,EAAA,EAAA,UAAA,OAAA,IAAA,EAAA,EAAA,OAAA,EAAA,UAAA,KAAA,OAAA,GAAA,EAAA,MAAA,KAAA,iBAAA,SAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,IAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAnZb,IAmBK,EAQA,EA3BL,EAAA,QAAA,oBACA,EAAA,QAAA,qBACA,EAAA,QAAA,YAGA,EAAA,EAAA,QAAA,2BAEA,EAAA,QAAA,iCAGM,EAAqC,CACpC,EAAA,IAAI,EAAA,KAAK,EAAS,EAAS,EAAS,GACpC,EAAA,IAAI,EAAA,KAAK,EAAS,IAAI,IAAK,IAAI,IAAK,GACpC,EAAA,IAAI,EAAA,KAAK,GAAG,IAAK,IAAI,IAAK,IAAI,IAAK,GACnC,EAAA,IAAI,EAAA,KAAK,IAAI,IAAK,IAAI,IAAK,EAAS,GACpC,EAAA,IAAI,EAAA,KAAK,IAAI,IAAK,IAAI,IAAK,EAAS,GACpC,EAAA,IAAI,EAAA,KAAK,GAAG,IAAK,IAAI,IAAK,IAAI,IAAK,KAG1C,SAAK,GACD,EAAA,EAAA,KAAA,GAAA,OACA,EAAA,EAAA,KAAA,GAAA,OACA,EAAA,EAAA,GAAA,GAAA,KACA,EAAA,EAAA,MAAA,GAAA,QACA,EAAA,EAAA,KAAA,GAAA,OALJ,CAAK,IAAA,EAAQ,KAQb,SAAK,GACD,EAAA,EAAA,KAAA,GAAA,OACA,EAAA,EAAA,MAAA,GAAA,QACA,EAAA,EAAA,MAAA,GAAA,QACA,EAAA,EAAA,OAAA,GAAA,SACA,EAAA,EAAA,QAAA,GAAA,UACA,EAAA,EAAA,SAAA,GAAA,WANJ,CAAK,IAAA,EAAU,KAUf,IAAA,EAAA,WAmBI,SAAA,EAAY,QAAA,IAAA,IAAA,EAAA,MAjBZ,KAAA,OAAqB,KACrB,KAAA,SAAyB,GAEzB,KAAA,UAAkB,EAAA,KAAK,WASf,KAAA,aAAqB,KACrB,KAAA,UAAoB,EACpB,KAAA,aAAuB,EAItB,KAAA,UAAU,GA+BvB,OA5CI,OAAA,eAAI,EAAA,UAAA,kBAAe,CAAnB,IAAA,WAIW,OAHW,KAAK,OACnB,EAAA,KAAK,IAAI,KAAK,UAAW,KAAK,OAAO,iBACrC,KAAK,WAHM,YAAA,EAuWV,cAAA,IA7VT,OAAA,eAAI,EAAA,UAAA,UAAO,CAAX,IAAA,WAAuB,OAAA,KAAK,UAAjB,YAAA,EA6VF,cAAA,IAvVT,EAAA,UAAA,OAAA,SAAO,GAuVE,IAAA,EAtVF,KAAK,cACC,KAAA,SAAuD,IAA3B,QAAjB,EAAA,KAAK,oBAAY,IAAA,OAAA,EAAA,EAAE,MAAM,KAAK,YACzC,KAAA,aAAe,KAAK,UAAU,SAG3C,EAAA,UAAA,KAAA,SAAK,KAEL,EAAA,UAAA,UAAA,SAAU,GA+UD,IAAA,EAAA,EA9UM,QAAX,EAAA,KAAK,cAAM,IAAA,GAAA,EAAE,YAAY,MACpB,KAAA,OAAS,EACH,QAAX,EAAA,KAAK,cAAM,IAAA,GAAA,EAAE,SAAS,OAG1B,EAAA,UAAA,wBAAA,SAAwB,GACf,KAAA,YAAc,EACd,KAAA,UAAW,GAGZ,EAAA,UAAA,YAAR,SAAoB,GACV,IAAA,EAAQ,KAAK,SAAS,QAAQ,GAChC,GAAS,GAAI,KAAK,SAAS,OAAO,EAAO,IAGzC,EAAA,UAAA,SAAR,SAAiB,GACC,KAAK,SAAS,QAAQ,GACxB,GAAG,KAAK,SAAS,KAAK,IAE1C,EAnDA,GAqDA,EAAA,SAAA,GASI,SAAA,EAAY,GAAZ,IAAA,EACI,EAAA,KAAA,OAAO,KA+SF,OAtTT,EAAA,aAA2C,GAC3C,EAAA,MAAgB,GAGhB,EAAA,YAAyB,IAAI,IAIzB,EAAK,KAAO,EA8SP,EArQb,OApDoB,EAAA,EAAA,GAchB,EAAA,UAAA,WAAA,SAAW,GACD,IAAA,EAAI,KAAK,MAAM,EAAI,EAAI,KAAK,KAAK,UACjC,EAAI,KAAK,MAAM,EAAI,EAAI,KAAK,KAAK,UAChC,OAAA,IAAI,EAAA,KAAK,EAAG,IAGvB,EAAA,UAAA,WAAA,SAAW,GACD,IAAA,EAA0B,GAArB,KAAK,KAAK,SACf,EAAI,KAAK,MAAM,EAAM,EAAI,KAAK,KAAK,SAAW,GAC9C,EAAI,KAAK,MAAM,EAAM,EAAI,KAAK,KAAK,SAAW,GAC7C,OAAA,IAAI,EAAA,KAAK,EAAG,IAGvB,EAAA,UAAA,OAAA,SAAO,GA8RE,IAAA,EAAA,EAAA,IA7Ra,IAAA,IAAA,EAAA,EAAA,KAAK,KAAK,OAAK,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAAzB,IAAA,EAAI,EAAA,MACP,GAAA,EAAK,SAAS,GACb,OAAO,GA2RV,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,OAxRE,OAAA,MAGX,EAAA,UAAA,gBAAA,SAAgB,GAqRP,IAAA,EAAA,EAAA,IApRU,IAAA,IAAA,EAAA,EAAA,KAAK,OAAK,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAAjB,IAAA,EAAC,EAAA,MACD,EAAK,KAAK,WAAW,EAAE,UAAU,KACpC,GAAA,EAAG,IAAM,EAAM,GAAK,EAAG,GAAG,EAAM,EAC/B,OAAO,GAiRV,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,SA7QT,EAAA,UAAA,OAAA,SAAO,GACH,EAAA,UAAM,OAAM,KAAA,KAAC,IAGjB,EAAA,UAAA,KAAA,aAIJ,EApDA,CAAoB,GAsDpB,EAAA,SAAA,GAiBI,SAAA,EAAY,EAAc,EAAiB,EAAqB,EAAiB,GAAjF,IAAA,EACI,EAAA,KAAA,KAAM,IAAM,KAiPP,OA1PT,EAAA,cAAuB,KAGvB,EAAA,kBAA4B,EAOxB,EAAK,MAAQ,EACb,EAAK,QAAU,EACf,EAAK,QAAU,EACf,EAAK,MAAQ,EACb,EAAK,QAAU,EA4OV,EA7Ib,OAtHmB,EAAA,EAAA,GA0Bf,EAAA,UAAA,OAAA,SAAO,GACH,EAAA,UAAM,OAAM,KAAA,KAAC,GACR,KAAA,gBAAgB,GAEhB,KAAA,uBAGT,EAAA,UAAA,KAAA,SAAK,KAEL,EAAA,UAAA,kBAAA,SAAkB,GACX,KAAK,gBACJ,EAAS,SAAS,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,IACpC,EAAS,UAAU,KAAK,cAAc,OAAQ,KAItD,EAAA,UAAA,oBAAA,WACO,GAAA,KAAK,cAAe,CACb,IAAA,EAAK,KAAK,gBACV,EAAe,EAAK,gBAAgB,KAAK,QAAS,EAAG,IAAI,EAAG,EAAG,IAAI,EAC1C,GAA3B,KAAK,MAAM,KAAK,SACW,GAA3B,KAAK,MAAM,KAAK,SAAgB,EAAK,aAAa,KAAK,QAEtD,KAAA,cAAc,OAAS,EAAa,SAIzC,EAAA,UAAA,gBAAR,SAAwB,GACjB,IAA0B,IAA1B,KAAK,iBAAL,CAGG,IAAA,EAAO,KAAK,MAAM,KAAK,SAGvB,EAAU,EAAA,KAAK,IAAI,KAAK,UAAW,KAAK,UAAU,KAAK,YACxD,KAAA,UAAU,KAAK,EAAQ,EAAI,EAAK,EAFvB,EAEqC,EAAQ,EAAI,EAAK,EAFtD,GAKX,KAAK,IAAI,KAAK,UAAU,IAAI,EAAI,KAAK,UAAU,GAAK,GACnD,KAAK,UAAU,QAAQ,KAAK,UAAU,GAEvC,KAAK,IAAI,KAAK,UAAU,IAAI,EAAI,KAAK,UAAU,GAAK,GACnD,KAAK,UAAU,QAAQ,KAAK,UAAU,GAGvC,KAAK,UAAU,IAAI,GAAK,KAAK,UAAU,GAAK,KAAK,UAAU,IAAI,GAAK,KAAK,UAAU,IAC7E,KAAA,kBAAmB,EACrB,KAAK,gBACJ,KAAK,eAAe,SAIhC,EAAA,UAAA,KAAA,SAAK,GACK,IAAA,EAAQ,KAAK,MAAM,WAAW,KAAK,UAAU,KAAK,IAAI,GACvD,KAAA,UAAY,KAAK,MAAM,WAAW,GAClC,KAAK,kBAAmB,GAGjC,EAAA,UAAA,SAAA,SAAS,EAAW,GACV,IAAA,EAAQ,KAAK,MAAM,WAAW,KAAK,UAAU,KAE/C,OAAA,EAAM,GAAK,EAAU,GAAe,IAAV,EAAI,GAAa,EAAM,GAAK,EAAU,GAAe,IAAV,EAAI,KACpE,KAAA,KAAK,IACH,IAMR,EAAA,aAAP,SAAoB,GACT,OAAA,GACE,KAAA,EAAS,MAAc,OAAA,EACvB,KAAA,EAAS,KAAa,OAAA,KAAK,GAAK,EAChC,KAAA,EAAS,KAAa,OAAA,KAAK,GAC3B,KAAA,EAAS,GAAW,OAAA,KAAK,GAAK,KAAK,GAAK,EAC7C,QAAgB,OAAA,IAIjB,EAAA,gBAAP,SAAuB,EAAmB,EAAc,EAAc,EAAe,EAAgB,GAC1F,OAAA,GACE,KAAA,EAAW,MACL,OAAA,EAAA,MAAM,QAAQ,EAAM,EAAM,EAAO,EAAQ,GAAK,GACpD,KAAA,EAAW,QACX,KAAA,EAAW,SACL,OAAA,EAAA,MAAM,QAAQ,EAAM,EAAM,EAAO,EAAQ,GAAK,GACpD,KAAA,EAAW,OACL,OAAA,EAAA,MAAM,kBAAkB,EAAM,EAAM,EAAO,EAAQ,GAC9D,QACW,OAAA,OApGZ,EAAA,eAA0B,GAuGrC,EAtHA,CAAmB,GAwHnB,EAAA,SAAA,GACI,SAAA,EAAY,EAAc,EAAiB,EAAqB,EAAiB,GA0IxE,IAAA,EA1IT,EACI,EAAA,KAAA,KAAM,EAAO,EAAS,EAAS,EAAO,IAAQ,KAExC,EAAM,EAAK,aAAa,GAuIzB,OAtIL,EAAK,cAAgB,EAAK,gBAAgB,EAAK,QAAS,EAAK,UAAU,IAAI,EAAG,EAAK,UAAU,IAAI,EAAG,EAAK,MAAM,KAAK,SAAU,EAAK,MAAM,KAAK,SAAU,IAEnI,QAAlB,EAAA,EAAK,qBAAa,IAAA,OAAA,EAAA,EAAE,OAAO,QAAS,IACnC,EAAK,yBAAwB,GAC7B,EAAK,eAAe,KAAK,EAAK,gBAkI7B,EA7Gb,OA9BwB,EAAA,EAAA,GAapB,EAAA,UAAA,KAAA,SAAK,GACK,IAAA,EAAK,KAAK,gBACV,EAAM,EAAG,IACT,EAAQ,EAAG,MAEX,EAAM,KAAK,MAAM,KAAK,SAAW,EAAM,EACvC,EAAM,KAAK,MAAM,KAAK,SAAW,EAAM,EAGvC,EAAM,EAAK,aAAa,KAAK,OAEnC,EAAS,SAAS,IAAI,EAAA,KAAK,EAAE,EAAE,EAAE,KACjC,EAAS,WAAW,KAAK,MAAM,aAAa,IAC5C,EAAS,SAAS,EAAI,EAAG,EAAI,EAAG,EAAK,EAAK,EAAK,GAAK,IAE/C,KAAA,kBAAkB,IAE/B,EA9BA,CAAwB,GAgCxB,EAAA,SAAA,GAOI,SAAA,EAAY,EAAc,EAAiB,EAAqB,EAAiB,GAoGxE,IAAA,EApGT,EACI,EAAA,KAAA,KAAM,EAAM,EAAS,EAAS,EAAO,IAAQ,KANjD,EAAA,UAAmB,GACnB,EAAA,aAAsB,GAOZ,IAAA,EAAM,EAAK,aAAa,EAAK,OAiG9B,OAhGL,EAAK,cAAgB,EAAK,gBAAgB,EAAK,QAAS,EAAK,UAAU,IAAI,EAAG,EAAK,UAAU,IAAI,EAAG,EAAK,MAAM,KAAK,SAAU,EAAK,MAAM,KAAK,SAAU,IAEnI,QAAlB,EAAA,EAAK,qBAAa,IAAA,OAAA,EAAA,EAAE,OAAO,QAAS,IACnC,EAAK,yBAAwB,GAC7B,EAAK,eAAe,KAAK,EAAK,gBA4F7B,EAFb,OAzG0B,EAAA,EAAA,GAKtB,OAAA,eAAI,EAAA,UAAA,QAAK,CAAT,IAAA,WAAA,IAAA,EAAc,OAAgC,QAAhC,EAAO,EAAY,KAAK,gBAAQ,IAAA,EAAA,EAAI,IAAI,EAAA,KAAK,EAAE,EAAE,EAAE,IAAxD,YAAA,EAsGA,cAAA,IAxFT,EAAA,UAAA,OAAA,SAAO,GACH,EAAA,UAAM,OAAM,KAAA,KAAC,IAGjB,EAAA,UAAA,aAAA,SAAa,GAoFJ,IAAA,EAnFC,EAAK,KAAK,gBACV,EAAS,KAAK,SAAS,KAAK,OAC5B,EAAY,EAAA,KAAK,OAAO,GAAQ,MAAM,GAGzC,GAFH,EAAG,KAAK,EAAU,EAAG,EAAU,GAE5B,KAAK,SAAW,EAAW,QAAS,CAC9B,KAAA,UAAY,KAAK,YAAY,EAAG,IAAK,EAAQ,EAAG,GAChD,KAAA,aAAe,GAEhB,IAAA,IAAI,EAAE,EAAG,EAAE,KAAK,UAAU,OAAQ,IAAK,CACjC,IAAA,EAAI,KAAK,UAAU,GACzB,EAAE,aAAa,EAAK,eAAgB,KACpC,EAAA,KAAK,cAAa,KAAI,MAAA,EAAA,EAAI,EAAE,YAKxC,EAAA,UAAA,KAAA,SAAK,GACD,EAAA,UAAM,KAAI,KAAA,KAAC,GAEL,IAAA,EAAK,KAAK,gBACV,EAAM,EAAG,IACT,EAAQ,EAAG,MACX,EAAM,KAAK,MAAM,KAAK,SAAW,EAAM,EACvC,EAAM,KAAK,MAAM,KAAK,SAAW,EAAM,EAE7C,EAAS,WAAU,GAEb,IAAA,EAAQ,IAAI,EAAA,KAAK,KAAK,MAAM,EAAG,KAAK,MAAM,EAAG,KAAK,MAAM,EAAG,GAEjE,EAAS,SAAS,GAClB,EAAS,SAAS,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,EAAG,GAAK,IAEjD,KAAA,UAAU,GAEf,EAAS,SAAS,IAAI,EAAA,KAAK,EAAE,EAAE,EAAE,IAC5B,KAAA,kBAAkB,GAEvB,EAAS,YAGb,EAAA,UAAA,UAAA,SAAU,GA0CD,IAAA,EAAA,EAAA,EAAA,EAxCC,EAAQ,IAAI,EAAA,KAAK,KAAK,MAAM,EAAG,KAAK,MAAM,EAAG,KAAK,MAAM,EAAG,IACjE,EAAS,YACT,EAAS,SAAS,GAsCb,IApCU,IAAA,IAAA,EAAA,EAAA,KAAK,cAAY,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAAxB,IAAA,EAAC,EAAA,MACD,EAAI,KAAK,IAAmB,QAAhB,EAAM,QAAN,EAAC,EAAE,WAAG,IAAA,OAAA,EAAA,EAAE,gBAAQ,IAAA,EAAA,EAAI,KAChC,EAAK,EAAE,IACP,EAAK,EAAA,KAAK,IAAI,EAAE,IAAK,CAAC,EAAG,EAAG,EAAE,IAAI,IAAI,EAAE,KAE9C,EAAS,SAAS,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IA+BzC,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,OA1BL,EAAS,YAGb,EAAA,UAAA,SAAA,SAAS,GACE,OAAA,GACE,KAAA,EAAS,KAAa,OAAA,IAAI,EAAA,MAAM,EAAG,GACnC,KAAA,EAAS,GAAW,OAAA,IAAI,EAAA,KAAK,GAAI,GACjC,KAAA,EAAS,MAAc,OAAA,IAAI,EAAA,KAAK,EAAG,GACnC,KAAA,EAAS,KAAa,OAAA,IAAI,EAAA,KAAK,EAAG,GACvC,QAAgB,OAAA,IAAI,EAAA,KAAK,EAAG,KAIpC,EAAA,UAAA,YAAA,SAAY,EAAY,EAAY,EAAe,GAM3C,IALE,IAAA,EAAc,GACd,EAAO,EAAA,KAAK,cAAc,GAE1B,EAAM,KAAK,KAAK,EAAM,GACtB,EAAM,KAAK,KAAK,EAAM,GACpB,GAAG,EAAK,GAAG,EAAK,IACpB,EAAK,KAAM,IAAI,EAAA,IAAI,EAAA,KAAK,IAAI,EAAK,EAAA,KAAK,MAAM,EAAM,EAAE,IAAW,IAE5D,OAAA,GAEf,EAzGA,CAA0B,GA2G1B,EAAA,SAAA,GAWI,SAAA,EAAY,GAAZ,IAAA,EACI,EAAA,KAAA,KAAM,IAAa,KAZd,OAET,EAAA,kBAA4B,EAG5B,EAAA,aAA2C,GAI3C,EAAA,YAAsB,EAKlB,EAAK,MAAQ,IAAI,EAAW,MAC5B,EAAK,MAAM,UAAU,OAAO,EAAK,OAAO,MAAQ,EAAG,EAAK,OAAO,OAAS,GAExE,EAAK,aAAe,IAAI,EAAM,EAAA,OAAO,EAAK,oBAC1C,EAAK,aAAa,aAAe,EAAK,aACtC,EAAK,aAAa,UAAU,EAAK,OAEjC,EAAK,YAEL,QAAQ,IAAI,OAAO,EAAK,OAAO,MAAQ,GACvC,QAAQ,IAAI,OAAO,EAAK,OAAO,OAAS,GACxC,QAAQ,IAAI,EAAK,MAAM,gBAAgB,KACvC,QAAQ,IAAI,EAAK,aAAa,gBAAgB,KA1BzC,EA8Pb,OA9PiC,EAAA,EAAA,GA6BvB,EAAA,UAAA,WAAN,WAAoB,OAAA,EAAA,UAAA,EAAA,QAAO,WA7BlB,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EA8BL,MAAA,CAAA,EAAM,EAAA,UAAM,WAAU,KAAA,OA9BjB,KAAA,EAAA,OA8BL,EAAA,OAEK,KAAA,aAAa,GAAK,KAElB,KAAA,aAAa,EAAW,OAAS,IAAI,EAAA,UAAU,KAAK,IACpD,KAAA,aAAa,EAAW,OAAO,KAAK,EAAA,SAnCpC,CAAA,SAsCT,EAAA,UAAA,OAAA,WAtCS,IAAA,EAAA,EAAA,EAAA,EAuCL,EAAA,UAAM,OAAM,KAAA,MACN,IAAA,EAAK,KAAK,MAAM,SAChB,EAAW,IAAI,EAAA,KAAK,EAAG,GAExB,KAAA,aAAe,KAAK,KAAK,UAE3B,EAAG,cAAc,IAAK,EAAS,GAAK,EAC/B,EAAG,cAAc,IAAK,EAAS,EAAK,EACpC,EAAG,cAAc,IAAK,EAAS,GAAK,EACpC,EAAG,cAAc,MAAK,EAAS,EAAK,GAEzB,IAAf,EAAS,GAA0B,IAAf,EAAS,GACxB,KAAA,eAAe,GAnDnB,IAuDU,IAAA,IAAA,EAAA,EAAA,KAAK,aAAa,OAAK,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,EAA9B,EAAC,EAAA,OACL,OAAO,KAAK,KAAK,YAxDlB,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,OAAA,IA4DU,IAAA,IAAA,EAAA,EAAA,KAAK,aAAa,OAAK,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAA9B,IAAA,GAAA,EAAC,EAAA,iBACS,GACZ,EAAE,aAAa,KAAK,KAAK,YA9D5B,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,SAkET,EAAA,UAAA,KAAA,WACI,EAAA,UAAM,KAAI,KAAA,MACL,KAAA,GAAG,WAAW,EAAG,EAAG,EAAG,GACvB,KAAA,GAAG,MAAM,KAAK,GAAG,kBAEjB,KAAA,WAAW,QACX,KAAA,qBACA,KAAA,YACA,KAAA,WAAW,OAGpB,EAAA,UAAA,mBAAA,WAEU,IAAA,EAAK,KAAK,aAAa,gBACvB,EAAM,EAAG,IACT,EAAQ,EAAG,MAEX,EAAM,KAAK,aAAa,KAAK,SAAW,EAAM,EAC9C,EAAM,KAAK,aAAa,KAAK,SAAW,EAAM,EAI9C,EAAO,KAAK,aAAa,KAAK,KAC9B,EAAO,KAAK,aAAa,KAAK,KAE/B,KAAA,WAAW,WAAU,GAOtB,IAJE,IAAA,EAAK,IAAI,EAAA,KAAK,EAAS,EAAS,EAAS,IACzC,EAAS,CAAC,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAGtI,EAAE,EAAQ,GAAG,EAAK,EAAG,IAAK,CACxB,IAAA,EAAS,CACX,IAAI,EAAA,KAAK,EAAI,EAAK,EAAE,EAAM,EAAI,EAAK,EAAa,GAChD,IAAI,EAAA,KAAK,EAAI,EAAK,EAAE,EAAM,EAAI,EAAK,EAAa,GAChD,IAAI,EAAA,KAAK,EAAI,EAAK,EAAE,EAAM,EAAI,GAAM,EAAO,GAAK,GAChD,IAAI,EAAA,KAAK,EAAI,EAAK,EAAE,EAAM,EAAI,GAAM,EAAO,GAAK,IAE/C,KAAA,WAAW,UAAU,EAAQ,EAAG,GAIrC,IAAI,EAAE,EAAQ,GAAG,EAAK,EAAG,IAAK,CACxB,EAAS,CACX,IAAI,EAAA,KAAK,EAAI,EAAK,EAAa,EAAO,EAAI,EAAK,EAAE,GACjD,IAAI,EAAA,KAAK,EAAI,EAAK,EAAa,EAAO,EAAI,EAAK,EAAE,GACjD,IAAI,EAAA,KAAK,EAAI,GAAM,EAAO,GAAK,EAAO,EAAI,EAAK,EAAE,GACjD,IAAI,EAAA,KAAK,EAAI,GAAM,EAAO,GAAK,EAAO,EAAI,EAAK,EAAE,IAEhD,KAAA,WAAW,UAAU,EAAQ,EAAG,GAGpC,KAAA,WAAW,YAIpB,EAAA,UAAA,UAAA,WAES,KAAA,WAAW,WAAU,GAEtB,IAAA,IAAI,EAAE,EAAG,EAAE,KAAK,aAAa,MAAM,OAAQ,IAAK,CACnC,KAAK,aAAa,MAAM,GAChC,KAAK,KAAK,YAGd,KAAA,WAAW,YAIpB,EAAA,UAAA,eAAA,SAAe,GAxIN,IAAA,EAAA,EAwIT,EAAA,KAEQ,KAAA,KAAK,aAAa,YAAY,KAAO,GAAsC,OAAjC,KAAK,aAAa,YAA5D,CAIE,IAAA,EAAkB,KAAK,aAAa,WAAW,KAAK,aAAa,WAAW,UAAU,KACtF,EAAkB,EAAA,KAAK,IAAI,EAAiB,GAC5C,EAAO,KAAK,aAAa,OAAO,GAEhC,EAAuB,SAAC,GAC1B,EAAK,aAAa,YAAY,OAAO,GACrC,EAAK,eAAiB,KAChB,IAAA,EAAQ,EAAK,aAAa,WAAW,EAAK,UAAU,MACtD,MAAA,OAAI,EAAJ,EAAM,SAAS,MACf,EAAK,aAAa,WAAa,IASpC,GALE,KAAA,aAAa,WAAW,KAAK,GAC7B,KAAA,aAAa,WAAW,eAAiB,EAEzC,KAAA,aAAa,WAAa,KAEnB,OAAT,EAhKE,IAmKU,IAAA,IAAA,EAAA,EAAA,KAAK,aAAa,OAAK,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAA9B,IAAA,EAAC,EAAA,MACD,EAAK,KAAK,aAAa,WAAW,EAAE,UAAU,KACjD,EAAK,SAAS,IAAO,EAAE,SAAS,EAAK,KAC/B,KAAA,aAAa,YAAY,IAAI,GAClC,EAAE,eAAiB,IAvKtB,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,UA8KT,EAAA,UAAA,UAAA,WAGU,IAAA,EAAQ,KAAK,aAGb,EAAM,EAAM,KAAK,IAQjB,EAAW,EAAM,KAAK,SACtB,EAAa,EAAW,EAAM,KAAK,KACnC,EAAc,EAAW,EAAM,KAAK,KAK1C,EAAM,UAAU,MAAM,EAAW,GAAI,EAAY,GAK7C,IAHE,IAAA,EAAO,EAAM,KAAK,KAClB,EAAO,EAAM,KAAK,KAEhB,EAAK,EAAG,EAAG,EAAM,IACjB,IAAA,IAAI,EAAK,EAAG,EAAG,EAAM,IAAM,CAIvB,IAAA,EAAU,SAAS,EAAI,GAAI,GApBpB,IAqBP,EAAQ,SAAS,EAAI,GAAI,GAtBpB,IAuBL,EAAU,SAAS,EAAI,GAAI,GAxBpB,IAyBL,EAAU,SAAS,EAAI,GAAI,GA1BtB,IA4BX,QAAQ,IAAI,EAAS,EAAO,EAAS,GAE/B,IAAA,EAAO,KAAK,WAAW,EAAO,EAAI,EAAI,EAAS,EAAS,EAAO,GAClE,GACC,EAAM,MAAM,KAAK,GAGjB,EAAM,KAAK,UAAU,IAAM,GAAM,EAAM,KAAK,UAAU,IAAM,IAC5D,EAAM,WAAa,KAQ3B,EAAA,UAAA,WAAR,SAAmB,EAAc,EAAgB,EAAgB,EAAiB,EAAqB,EAAiB,GAG9G,IAAA,EAAW,EAAM,KAAK,SACtB,EAAY,EAAW,EAEzB,EAAO,KAEJ,OAAA,GACE,KAAA,EAAW,KACZ,OACC,KAAA,EAAW,MACX,KAAA,EAAW,OACX,KAAA,EAAW,MACZ,EAAO,IAAI,EAAU,EAAO,EAAS,EAAS,EAAO,GAAU,MAC9D,KAAA,EAAW,SACX,KAAA,EAAW,QACZ,EAAO,IAAI,EAAY,EAAO,EAAS,EAAS,EAAO,GAAU,MACrE,QACQ,OAGN,IAAA,EAAU,IAAI,EAAA,KAAK,EAAS,EAAW,EAAW,EAAS,EAAW,GAGrE,OAFP,EAAK,UAAU,OAAO,EAAQ,EAAG,EAAQ,GAElC,GAGf,EA9PA,CAAiC,EAAA,KAApB,QAAA,YAAA;;AC5YA,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,WAAA,IAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,CAAA,UAAA,cAAA,OAAA,SAAA,EAAA,GAAA,EAAA,UAAA,IAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,EAAA,eAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,IAAA,OAAA,SAAA,EAAA,GAAA,SAAA,IAAA,KAAA,YAAA,EAAA,EAAA,EAAA,GAAA,EAAA,UAAA,OAAA,EAAA,OAAA,OAAA,IAAA,EAAA,UAAA,EAAA,UAAA,IAAA,IAAA,GAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,MAAA,aAAA,EAAA,EAAA,IAAA,EAAA,SAAA,GAAA,EAAA,MAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,EAAA,MAAA,KAAA,aAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,MAAA,EAAA,KAAA,WAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,KAAA,GAAA,IAAA,IAAA,OAAA,EAAA,CAAA,KAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,mBAAA,SAAA,EAAA,OAAA,UAAA,WAAA,OAAA,OAAA,EAAA,SAAA,EAAA,GAAA,OAAA,SAAA,GAAA,OAAA,SAAA,GAAA,GAAA,EAAA,MAAA,IAAA,UAAA,mCAAA,KAAA,GAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,GAAA,EAAA,SAAA,EAAA,EAAA,KAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,OAAA,EAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,GAAA,EAAA,QAAA,EAAA,IAAA,KAAA,EAAA,KAAA,EAAA,EAAA,EAAA,MAAA,KAAA,EAAA,OAAA,EAAA,QAAA,CAAA,MAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,GAAA,EAAA,CAAA,GAAA,SAAA,KAAA,EAAA,EAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,QAAA,KAAA,GAAA,EAAA,EAAA,MAAA,OAAA,GAAA,EAAA,EAAA,OAAA,MAAA,IAAA,EAAA,IAAA,IAAA,EAAA,IAAA,CAAA,EAAA,EAAA,SAAA,GAAA,IAAA,EAAA,MAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,CAAA,EAAA,MAAA,EAAA,GAAA,MAAA,GAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,EAAA,MAAA,GAAA,GAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,KAAA,GAAA,MAAA,EAAA,IAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,EAAA,EAAA,KAAA,EAAA,GAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,QAAA,EAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,EAAA,MAAA,KAAA,QAAA,SAAA,EAAA,GAAA,IAAA,EAAA,mBAAA,QAAA,EAAA,OAAA,UAAA,IAAA,EAAA,OAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,KAAA,GAAA,EAAA,GAAA,IAAA,WAAA,IAAA,GAAA,KAAA,MAAA,EAAA,EAAA,QAAA,MAAA,EAAA,KAAA,EAAA,OAAA,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,OAAA,OAAA,GAAA,EAAA,MAAA,KAAA,UAAA,WAAA,IAAA,IAAA,EAAA,GAAA,EAAA,EAAA,EAAA,UAAA,OAAA,IAAA,EAAA,EAAA,OAAA,EAAA,UAAA,KAAA,OAAA,GAAA,EAAA,MAAA,KAAA,UAAA,SAAA,GAAA,IAAA,EAAA,mBAAA,QAAA,OAAA,SAAA,EAAA,GAAA,EAAA,GAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,KAAA,GAAA,GAAA,GAAA,iBAAA,EAAA,OAAA,MAAA,CAAA,KAAA,WAAA,OAAA,GAAA,GAAA,EAAA,SAAA,OAAA,GAAA,CAAA,MAAA,GAAA,EAAA,KAAA,MAAA,KAAA,MAAA,IAAA,UAAA,EAAA,0BAAA,oCAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IALb,IAAA,EAAA,QAAA,oBACA,EAAA,QAAA,qBAIA,EAAA,SAAA,GAWI,SAAA,EAAY,GAAZ,IAAA,EACI,EAAA,KAAA,KAAM,IAAa,KAZd,OAET,EAAA,SAAoB,GAEpB,EAAA,KAAc,GACd,EAAA,QAAoB,GAEpB,EAAA,QAAsB,GAEtB,EAAA,YAAsB,EATb,EAwKb,OAxKoC,EAAA,EAAA,GAe1B,EAAA,UAAA,WAAN,WAAoB,OAAA,EAAA,UAAA,EAAA,QAAO,WAflB,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EAgBL,MAAA,CAAA,EAAM,EAAA,UAAM,WAAU,KAAA,OAhBjB,KAAA,EAAA,OAgBL,EAAA,OAEM,EAAK,KAAK,OAAO,MACjB,EAAK,KAAK,OAAO,OACjB,EAAK,EAAG,IACR,EAAK,EAAG,IACR,EAAK,KAAK,IAAI,EAAI,GAClB,EAAO,EAAG,EAAI,EAAG,EACjB,EAAQ,EAAG,EAAI,EAAG,EAClB,EAAO,EAAG,EAAI,EAAG,EACjB,EAAS,EAAG,EAAI,EAAG,EAEpB,KAAA,SAAS,KAAM,EAAA,MAAM,WAAW,EAAG,EAAI,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,IACzD,KAAA,SAAS,KAAM,EAAA,MAAM,WAAW,EAAG,EAAI,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,IACzD,KAAA,SAAS,KAAM,EAAA,MAAM,WAAW,EAAG,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,GAAG,IACzD,KAAA,SAAS,KAAM,EAAA,MAAM,WAAW,EAAG,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,GAAG,IAKzD,KAAA,SAAS,KAAM,EAAA,MAAM,QAAQ,KAAK,OAAO,MAAM,EAAG,KAAK,OAAO,OAAO,EAAG,EAAM,EAAM,EAAO,EAAK,IAChG,KAAA,SAAS,KAAM,EAAA,MAAM,QAAQ,KAAK,OAAO,MAAM,EAAG,KAAK,OAAO,OAAO,EAAE,EAAI,EAAI,IAO/E,KAAA,KAAO,GA5CP,CAAA,SAyDT,EAAA,UAAA,OAAA,WAzDS,IAAA,EAAA,EA0DL,EAAA,UAAM,OAAM,KAAA,MACP,KAAA,aAAe,KAAK,KAAK,UAMxB,IAAA,EAAuB,IAAnB,KAAK,YACV,KAAA,KAAO,KAAK,YAAY,KAAK,MAAM,MAAM,IAAK,IAAI,EAAA,KAAK,KAAK,IAAI,GAAI,KAAK,IAAI,IAAK,GAAI,GAItF,KAAA,QAAU,GACV,KAAA,QAAU,GAEX,IAAA,IAAI,EAAE,EAAG,EAAE,KAAK,KAAK,OAAQ,IAAK,CAC5B,IAAA,EAAI,KAAK,KAAK,GACpB,EAAE,aAAa,KAAK,SAAU,IAC9B,EAAA,KAAK,SAAQ,KAAI,MAAA,EAAA,EAAI,EAAE,UACvB,EAAA,KAAK,SAAQ,KAAI,MAAA,EAAA,EAAI,EAAE,WAI/B,EAAA,UAAA,KAAA,WAjFS,IAAA,EAAA,EAkFL,EAAA,UAAM,KAAI,KAAA,MACL,KAAA,WAAW,QAnFX,IAqFU,IAAA,IAAA,EAAA,EAAA,KAAK,UAAQ,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAA,CAAlB,IAAA,EAAC,EAAA,MACF,KAAA,UAAU,IAtFd,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,OAwFA,KAAA,SAAS,KAAK,SAEd,KAAA,WAAW,OAGpB,EAAA,UAAA,UAAA,SAAU,GACD,KAAA,WAAW,YACX,KAAA,WAAW,UAAU,EAAQ,OAAQ,GACrC,KAAA,WAAW,YAKpB,EAAA,UAAA,mBAAA,SAAmB,EAAc,GACzB,IAAA,IAAI,EAAE,EAAG,EAAE,KAAK,KAAK,OAAQ,IAAK,CAC5B,IAAA,EAAI,KAAK,KAAK,GAEpB,EAAE,IAAI,EAAI,EACV,EAAE,IAAI,EAAI,IAIlB,EAAA,UAAA,SAAA,SAAS,GA9GA,IAAA,EAAA,EAAA,EAAA,EAAA,IA+GU,IAAA,IAAA,EAAA,EAAA,GAAI,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAAX,IAAA,EAAC,EAAA,MACD,EAAK,EAAE,IAIP,EAAI,KAAK,IAAmB,QAAhB,EAAM,QAAN,EAAC,EAAE,WAAG,IAAA,OAAA,EAAA,EAAE,gBAAQ,IAAA,EAAA,EAAI,KAEhC,EAAK,EAAA,KAAK,IAAI,EAAE,IAAK,CAAC,EAAG,EAAG,EAAE,IAAI,IAAI,EAAE,KACzC,KAAA,WAAW,SAAS,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAvHhD,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,SA2HT,EAAA,UAAA,YAAA,SAAY,GA3HH,IAAA,EAAA,EAAA,IA4HU,IAAA,IAAA,EAAA,EAAA,GAAO,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAAd,IAAA,EAAC,EAAA,MACF,KAAA,WAAW,SAAS,EAAE,YAAY,IAAI,EAAG,EAAE,YAAY,IAAI,EAAG,EAAE,MAAM,EAAG,EAAE,MAAM,EAAG,IA7HxF,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,SAkIT,EAAA,UAAA,WAAA,SAAW,EAAc,EAAc,GAE/B,IADE,IAAA,EAAc,GACZ,EAAE,EAAG,EAAE,EAAU,IAAK,CACpB,IAAA,EAAM,EAAM,KAAK,GAAM,EAAW,EACxC,EAAK,KAAK,IAAI,EAAA,IACV,IAAI,EAAA,KAAK,EAAM,GACf,IAAI,EAAA,KAAK,KAAK,IAAI,IAAK,KAAK,IAAI,MAIjC,OAAA,GAGX,EAAA,UAAA,iBAAA,SAAiB,EAAc,EAAc,GA/IpC,IAAA,EAAA,EAAA,EAAA,EAgJC,EAAM,IAAI,EAAA,KAAK,EAAM,GACrB,EAAc,GAjJf,IAkJc,IAAA,IAAA,EAAA,EAAA,GAAM,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAAjB,IAAA,EAAK,EAAA,MAlJV,IAmJc,IAAA,IAAA,GAAA,OAAA,EAAA,EAAA,EAAM,SAAM,EAAA,EAAA,QAAA,EAAA,KAAA,EAAA,EAAA,OAAE,CAAnB,IAAA,EAAC,EAAA,MACP,EAAK,KAAK,IAAI,EAAA,IAAI,EAAK,EAAA,KAAK,IAAI,EAAG,GAAK,eApJ3C,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,SAAA,MAAA,GAAA,EAAA,CAAA,MAAA,GAAA,QAAA,IAAA,IAAA,EAAA,OAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,QAAA,GAAA,EAAA,MAAA,EAAA,OAwJE,OAAA,GAGX,EAAA,UAAA,YAAA,SAAY,EAAY,EAAY,EAAe,GAM3C,IALE,IAAA,EAAc,GACd,EAAO,EAAA,KAAK,cAAc,GAE1B,GAAO,KAAK,MAAM,EAAQ,GAC1B,EAAM,KAAK,KAAK,EAAQ,GACtB,EAAE,EAAK,EAAE,EAAK,IAClB,EAAK,KACD,IAAI,EAAA,IAAI,EAAA,KAAK,IAAI,EAAK,EAAA,KAAK,MAAM,EAAM,EAAE,IAAW,IAGrD,OAAA,GAEf,EAxKA,CAAoC,EAAA,KAAvB,QAAA,eAAA;;ACFA,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,WAAA,IAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,CAAA,UAAA,cAAA,OAAA,SAAA,EAAA,GAAA,EAAA,UAAA,IAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,EAAA,eAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,IAAA,OAAA,SAAA,EAAA,GAAA,SAAA,IAAA,KAAA,YAAA,EAAA,EAAA,EAAA,GAAA,EAAA,UAAA,OAAA,EAAA,OAAA,OAAA,IAAA,EAAA,UAAA,EAAA,UAAA,IAAA,IAAA,GAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,MAAA,aAAA,EAAA,EAAA,IAAA,EAAA,SAAA,GAAA,EAAA,MAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,EAAA,MAAA,KAAA,aAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,MAAA,EAAA,KAAA,WAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,KAAA,GAAA,IAAA,IAAA,OAAA,EAAA,CAAA,KAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,mBAAA,SAAA,EAAA,OAAA,UAAA,WAAA,OAAA,OAAA,EAAA,SAAA,EAAA,GAAA,OAAA,SAAA,GAAA,OAAA,SAAA,GAAA,GAAA,EAAA,MAAA,IAAA,UAAA,mCAAA,KAAA,GAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,GAAA,EAAA,SAAA,EAAA,EAAA,KAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,OAAA,EAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,GAAA,EAAA,QAAA,EAAA,IAAA,KAAA,EAAA,KAAA,EAAA,EAAA,EAAA,MAAA,KAAA,EAAA,OAAA,EAAA,QAAA,CAAA,MAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,GAAA,EAAA,CAAA,GAAA,SAAA,KAAA,EAAA,EAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,QAAA,KAAA,GAAA,EAAA,EAAA,MAAA,OAAA,GAAA,EAAA,EAAA,OAAA,MAAA,IAAA,EAAA,IAAA,IAAA,EAAA,IAAA,CAAA,EAAA,EAAA,SAAA,GAAA,IAAA,EAAA,MAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,CAAA,EAAA,MAAA,EAAA,GAAA,MAAA,GAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,EAAA,MAAA,GAAA,GAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,KAAA,GAAA,MAAA,EAAA,IAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,EAAA,EAAA,KAAA,EAAA,GAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,QAAA,EAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAHb,IAAA,EAAA,QAAA,oBACA,EAAA,QAAA,qBAEA,EAAA,SAAA,GAEI,SAAA,EAAY,GACR,OAAA,EAAA,KAAA,KAAM,IAAa,KA6B3B,OAhCuC,EAAA,EAAA,GAM7B,EAAA,UAAA,WAAN,WAAoB,OAAA,EAAA,UAAA,EAAA,QAAO,WANlB,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EAOL,MAAA,CAAA,EAAM,EAAA,UAAM,WAAU,KAAA,OAPjB,KAAA,EAAA,OAOL,EAAA,OAPK,CAAA,SAUT,EAAA,UAAA,OAAA,WACI,EAAA,UAAM,OAAM,KAAA,OAGhB,EAAA,UAAA,KAAA,WACI,EAAA,UAAM,KAAI,KAAA,MAEL,KAAA,WAAW,QAEV,IAAA,EAAS,CACX,IAAI,EAAA,KAAK,IAAK,KACd,IAAI,EAAA,KAAK,IAAK,KACd,KAAK,MAAM,MAAM,KAGhB,KAAA,WAAW,UAAU,EAAQ,IAE7B,KAAA,WAAW,SAAS,IAAK,IAAK,IAAK,IAAK,GAExC,KAAA,WAAW,OAGxB,EAhCA,CAAuC,EAAA,KAA1B,QAAA,kBAAA;;;;ACCA,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,WAAA,IAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,CAAA,UAAA,cAAA,OAAA,SAAA,EAAA,GAAA,EAAA,UAAA,IAAA,SAAA,EAAA,GAAA,IAAA,IAAA,KAAA,EAAA,EAAA,eAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,IAAA,OAAA,SAAA,EAAA,GAAA,SAAA,IAAA,KAAA,YAAA,EAAA,EAAA,EAAA,GAAA,EAAA,UAAA,OAAA,EAAA,OAAA,OAAA,IAAA,EAAA,UAAA,EAAA,UAAA,IAAA,IAAA,GAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,MAAA,aAAA,EAAA,EAAA,IAAA,EAAA,SAAA,GAAA,EAAA,MAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,EAAA,MAAA,KAAA,aAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,MAAA,EAAA,KAAA,WAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,KAAA,GAAA,IAAA,IAAA,OAAA,EAAA,CAAA,KAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,mBAAA,SAAA,EAAA,OAAA,UAAA,WAAA,OAAA,OAAA,EAAA,SAAA,EAAA,GAAA,OAAA,SAAA,GAAA,OAAA,SAAA,GAAA,GAAA,EAAA,MAAA,IAAA,UAAA,mCAAA,KAAA,GAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,GAAA,EAAA,SAAA,EAAA,EAAA,KAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,OAAA,EAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,GAAA,EAAA,QAAA,EAAA,IAAA,KAAA,EAAA,KAAA,EAAA,EAAA,EAAA,MAAA,KAAA,EAAA,OAAA,EAAA,QAAA,CAAA,MAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,GAAA,EAAA,CAAA,GAAA,SAAA,KAAA,EAAA,EAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,QAAA,KAAA,GAAA,EAAA,EAAA,MAAA,OAAA,GAAA,EAAA,EAAA,OAAA,MAAA,IAAA,EAAA,IAAA,IAAA,EAAA,IAAA,CAAA,EAAA,EAAA,SAAA,GAAA,IAAA,EAAA,MAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,CAAA,EAAA,MAAA,EAAA,GAAA,MAAA,GAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,EAAA,MAAA,GAAA,GAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,KAAA,GAAA,MAAA,EAAA,IAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,EAAA,EAAA,KAAA,EAAA,GAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,QAAA,EAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,EAAA,MAAA,KAAA,iBAAA,SAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,IAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IANb,IAAA,EAAA,EAAA,QAAA,sCACA,EAAA,QAAA,iCACA,EAAA,QAAA,oBACA,EAAA,QAAA,qBACA,EAAA,QAAA,uCAEA,EAAA,SAAA,GAOI,SAAA,EAAY,GAAZ,IAAA,EACI,EAAA,KAAA,KAAM,IAAa,KARd,OAGT,EAAA,IAAe,EAHN,EAyEb,OAzEuC,EAAA,EAAA,GAW7B,EAAA,UAAA,WAAN,WAAoB,OAAA,EAAA,UAAA,EAAA,QAAO,WAXlB,IAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EAYL,MAAA,CAAA,EAAM,EAAA,UAAM,WAAU,KAAA,OAZjB,KAAA,EAAA,OAYL,EAAA,OAEK,KAAA,MAAQ,IAAI,EAAA,UAAU,KAAK,IAC3B,KAAA,MAAM,KAAK,EAAA,SAEX,KAAA,cAAgB,IAAI,EAAA,cAAc,KAAK,IAEtC,EAAoB,KAAK,IAAI,KAAK,OAAO,MAAQ,EAAG,KACrD,KAAA,cAAc,KAAK,EAAmB,GApBtC,CAAA,SAuBT,EAAA,UAAA,OAAA,WACI,EAAA,UAAM,OAAM,KAAA,MACP,KAAA,KAAO,KAAK,KAAK,WAG1B,EAAA,UAAA,KAAA,WACI,EAAA,UAAM,KAAI,KAAA,MAEJ,IAAA,EAAO,KAAK,cAAc,MAI3B,KAAA,cAAc,SACd,KAAA,GAAG,MAAM,KAAK,GAAG,kBAEjB,KAAA,WAAW,QAEX,KAAA,WAAW,WAAU,GACrB,KAAA,WAAW,WAAW,KAAK,OAC3B,KAAA,WAAW,SAAS,IAAI,EAAA,KAAK,EAAE,EAAE,EAAE,IAEnC,KAAA,WAAW,SAAS,EAAK,EAAG,EAAK,EAAQ,IAAL,EAAgB,IAAL,EAAW,KAAK,IAAK,GAAK,IACzE,KAAA,WAAW,UAAW,EAAA,MAAM,QAAQ,EAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EAAK,EAAG,GAAG,OAAQ,GAE/E,KAAA,WAAW,WACX,KAAA,WAAW,MAEX,KAAA,cAAc,UAMd,KAAA,WAAW,QAEX,KAAA,WAAW,WAAU,GACrB,KAAA,WAAW,WAAW,KAAK,eAC3B,KAAA,WAAW,SAAS,IAAI,EAAA,KAAK,EAAE,EAAE,EAAE,IAEnC,KAAA,WAAW,SAAS,KAAK,OAAO,MAAQ,EAAI,EAAO,GAAI,KAAK,OAAO,OAAS,EAAG,EAAM,EAAM,EAAG,GAAK,IACnG,KAAA,WAAW,SAAS,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,IACtC,KAAA,WAAW,SAAS,KAAK,OAAO,MAAQ,EAAG,KAAK,OAAO,OAAS,EAAG,EAAM,EAAM,EAAG,GAAK,IACvF,KAAA,WAAW,SAAS,IAAI,EAAA,KAAK,EAAG,EAAG,EAAG,IACtC,KAAA,WAAW,SAAS,KAAK,OAAO,MAAQ,EAAI,EAAO,GAAI,KAAK,OAAO,OAAS,EAAG,EAAM,EAAM,EAAG,GAAK,IAEnG,KAAA,WAAW,WACX,KAAA,WAAW,OAIxB,EAzEA,CAAuC,EAAA,KAA1B,QAAA,kBAAA;;ACWb,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAjBA,IAAA,EAAA,QAAA,iBACA,EAAA,QAAA,gBACA,EAAA,QAAA,mBACA,EAAA,QAAA,uBACA,EAAA,QAAA,iBAGA,SAAS,EAAQ,EAAkB,GACxB,OAAA,GACE,IAAA,cAAsB,OAAA,IAAI,EAAA,YAAY,GACtC,IAAA,iBAAyB,OAAA,IAAI,EAAA,eAAe,GAC5C,IAAA,oBAA4B,OAAA,IAAI,EAAA,kBAAkB,GAClD,IAAA,oBAA4B,OAAA,IAAI,EAAA,kBAAkB,GACvD,QAAgB,OAAA,IAAI,EAAA,IAAI,IAIhC,QAAA,QAAe;;ACiCd,aAAA,IAAA,EAAA,MAAA,KAAA,iBAAA,SAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,IAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAjDD,IAAA,EAAA,EAAA,QAAA,YAMA,SAAS,IA2CR,IAAA,EAxCU,OADsB,QAAf,EADc,OAAO,SAAS,KAAK,OAAO,GAAG,MAAM,KAAK,OAAO,SAAA,GAAK,MAAM,KAAN,IACvD,UAAE,IAAA,EAAA,EAAI,cAIrC,SAAS,IACO,EAAA,QAAQ,SAAU,KAC1B,SAIR,OAAO,iBAAiB,aAAc,WAClC,MAGJ,OAAO,OAAU,WACb,KAUM,IAAA,EAAU,SAAS,cAAc,aACjC,EAAW,SAAS,cAAc,gBACpC,GAAW,EACf,EAAQ,iBAAiB,QAAS,YAC9B,GAAY,IAER,EAAQ,UAAU,IAAI,QACtB,EAAS,UAAU,IAAI,UAGvB,EAAQ,UAAU,OAAO,QACzB,EAAS,UAAU,OAAO,SAE9B,QAAQ,IAAI","file":"src.c8ca99a7.js","sourceRoot":"..\\src","sourcesContent":["\r\nexport interface IVec2 {\r\n    x: number;\r\n    y: number;\r\n}\r\n\r\nexport class Vec2 implements IVec2 {\r\n\r\n    [key: number]: number;\r\n    [Symbol.iterator]() {\r\n        let step = 0;\r\n        return { next: () => ({ value: this[step++], done: step > 2 }) }\r\n    }\r\n\r\n    static readonly ZERO: Vec2 = new Vec2(0, 0);\r\n\r\n    get x() { return this[0]; }\r\n    get y() { return this[1]; }\r\n    get xy() { return [this.x, this.y]; }\r\n\r\n    set x(value: number) { this[0] = value; }\r\n    set y(value: number) { this[1] = value; }\r\n    set xy(value: [number, number]) { \r\n        this.x = value[0]; \r\n        this.y = value[1];\r\n    }\r\n\r\n    constructor(x: number = 0, y: number = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n     }\r\n\r\n    static add(lhs: IVec2, rhs: IVec2): Vec2 {\r\n        return new Vec2(lhs.x + rhs.x, lhs.y + rhs.y);\r\n    }\r\n    static sub(lhs: IVec2, rhs: IVec2): Vec2 {\r\n        return new Vec2(lhs.x - rhs.x, lhs.y - rhs.y);\r\n    }\r\n    static mul(lhs: IVec2, rhs: IVec2): Vec2 {\r\n        return new Vec2(lhs.x * rhs.x, lhs.y * rhs.y);\r\n    }\r\n    static scale(lhs: IVec2, rhs: number) {\r\n        return new Vec2(lhs.x * rhs, lhs.y * rhs);\r\n    }\r\n    static div(lhs: IVec2, rhs: IVec2): Vec2 {\r\n        return new Vec2(lhs.x / rhs.x, lhs.y / rhs.y);\r\n    }\r\n    static negate(vec: IVec2) {\r\n        return new Vec2(-vec.x, -vec.y);\r\n    }\r\n    static normalise(vec: IVec2): Vec2 {\r\n        const len = Vec2.len(vec);\r\n        return new Vec2(vec.x / len, vec.y / len );\r\n    }\r\n    static len(vec: IVec2): number {\r\n        return Math.sqrt(vec.x * vec.x + vec.y * vec.y);\r\n    }\r\n\r\n    static distance(vec1: IVec2, vec2: IVec2): number {\r\n        return Vec2.sub(vec2, vec1).length();\r\n    }\r\n    static dot(lhs: IVec2, rhs: IVec2): number {\r\n        return lhs.x * rhs.x + lhs.y * rhs.y;\r\n    }\r\n    static pivot(vec: IVec2, rot: number, point: IVec2 = {x: 0, y: 0}): Vec2 {\r\n        const x = vec.x - point.x;\r\n        const y = vec.y - point.y;\r\n\r\n        return new Vec2(\r\n            (x * Math.cos(rot)) - (y * Math.sin(rot)) + point.x, \r\n            (y * Math.cos(rot)) + (x * Math.sin(rot)) + point.y\r\n        );\r\n    }\r\n    static reflect(vec: IVec2, normal: IVec2) {\r\n        const d = Vec2.dot(vec, normal);\r\n        return new Vec2(\r\n            vec.x - 2 * d * normal.x,\r\n            vec.y - 2 * d * normal.y\r\n        )\r\n    }\r\n\r\n    add(rhs: IVec2): Vec2 {\r\n        this.x += rhs.x;\r\n        this.y += rhs.y;\r\n        return this;\r\n    }\r\n\r\n    sub(rhs: IVec2): Vec2 {\r\n        this.x -= rhs.x;\r\n        this.y -= rhs.y;\r\n        return this;\r\n    }\r\n\r\n    mul(rhs: IVec2) : Vec2 {\r\n        this.x *= rhs.x;\r\n        this.y *= rhs.y;\r\n        return this;\r\n    }\r\n\r\n    div(rhs: IVec2) : Vec2 {\r\n        this.x /= rhs.x;\r\n        this.y /= rhs.y;\r\n        return this;\r\n    }\r\n\r\n    scale(rhs: number) {\r\n        this.x *= rhs;\r\n        this.y *= rhs;\r\n        return this;\r\n    }\r\n\r\n    negate() {\r\n        this.x = -this.x;\r\n        this.y = -this.y;\r\n        return this;\r\n    }\r\n\r\n    normalise() : Vec2 {\r\n        const len = this.length();\r\n        if(len === 0)\r\n            return this;\r\n            \r\n        this.x /= len;\r\n        this.y /= len;\r\n        return this;\r\n    }\r\n\r\n    length(): number {\r\n        return Vec2.len(this);\r\n    }\r\n\r\n    dot(rhs: IVec2): number{\r\n        return Vec2.dot(this, rhs);\r\n    }\r\n\r\n    pivot(rot: number, point: IVec2 = {x: 0, y: 0}): Vec2 {\r\n        let x = this.x - point.x;\r\n        let y = this.y - point.y;\r\n        \r\n        this.x = (x * Math.cos(rot)) - (y * Math.sin(rot)) + point.x;\r\n        this.y = (y * Math.cos(rot)) + (x * Math.sin(rot)) + point.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    // 90 degree rotation cw\r\n    static perpendicular(vec: IVec2): Vec2 {\r\n        return new Vec2(vec.y, -vec.x);\r\n    }\r\n}\r\n","import { Vec2 } from \"./vec2\";\r\n\r\nexport interface IVec3 {\r\n    x: number;\r\n    y: number;\r\n    z: number;\r\n}\r\n\r\nexport class Vec3 implements IVec3 {\r\n\r\n    [key: number]: number;\r\n    [Symbol.iterator]() {\r\n        let step = 0;\r\n        return { next: () => ({ value: this[step++], done: step > 3 }) }\r\n    }\r\n\r\n    get x() { return this[0]; }\r\n    get y() { return this[1]; }\r\n    get z() { return this[2]; }\r\n    get xy() { return new Vec2(this[0], this[1]); }\r\n    \r\n\r\n    set x(value: number) { this[0] = value; }\r\n    set y(value: number) { this[1] = value; }\r\n    set z(value: number) { this[2] = value; }\r\n    set xyz(value: [number, number, number]) { \r\n        this.x = value[0]; \r\n        this.y = value[1];\r\n        this.z = value[2];\r\n    }\r\n\r\n    constructor(x: number = 0, y: number = 0, z: number = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n     }\r\n\r\n    static add(lhs: IVec3, rhs: IVec3): Vec3 {\r\n        return new Vec3(lhs.x + rhs.x, lhs.y + rhs.y, lhs.z + rhs.z);\r\n    }\r\n    static sub(lhs: IVec3, rhs: IVec3): Vec3 {\r\n        return new Vec3(lhs.x - rhs.x, lhs.y - rhs.y, lhs.z - rhs.z);\r\n    }\r\n    static mul(lhs: IVec3, rhs: IVec3): Vec3 {\r\n        return new Vec3(lhs.x * rhs.x, lhs.y * rhs.y, lhs.z * rhs.z);\r\n    }\r\n    static div(lhs: IVec3, rhs: IVec3): Vec3 {\r\n        return new Vec3(lhs.x / rhs.x, lhs.y / rhs.y, lhs.z / rhs.z);\r\n    }\r\n    static normalise(vec: IVec3): Vec3 {\r\n        const len = Vec3.len(vec);\r\n        return new Vec3(vec.x / len, vec.y / len, vec.z / len );\r\n    }\r\n    static len(vec: IVec3): number {\r\n        return Math.sqrt(vec.x * vec.x + vec.y * vec.y + vec.z * vec.z);\r\n    }\r\n    static dot(lhs: IVec3, rhs: IVec3): number {\r\n        return lhs.x * rhs.x + lhs.y * rhs.y + lhs.z * rhs.z;\r\n    }\r\n\r\n\r\n    add(rhs: IVec3): Vec3 {\r\n        this.x += rhs.x;\r\n        this.y += rhs.y;\r\n        this.z += rhs.z;\r\n        return this;\r\n    }\r\n\r\n    sub(rhs: IVec3): Vec3 {\r\n        this.x -= rhs.x;\r\n        this.y -= rhs.y;\r\n        this.z -= rhs.z;\r\n        return this;\r\n    }\r\n\r\n    mul(rhs: IVec3) : Vec3 {\r\n        this.x *= rhs.x;\r\n        this.y *= rhs.y;\r\n        this.z *= rhs.z;\r\n        return this;\r\n    }\r\n\r\n    div(rhs: IVec3) : Vec3 {\r\n        this.x /= rhs.x;\r\n        this.y /= rhs.y;\r\n        this.z /= rhs.z;\r\n        return this;\r\n    }\r\n\r\n    normalise() : Vec3 {\r\n        const len = this.length();\r\n        this.x /= len;\r\n        this.y /= len;\r\n        this.z /= len;\r\n        return this;\r\n    }\r\n\r\n    length(): number {\r\n        return Vec3.len(this);\r\n    }\r\n\r\n    dot(rhs: IVec3): number{\r\n        return Vec3.dot(this, rhs);\r\n    }\r\n}","\r\nexport interface IVec4 {\r\n    x: number;\r\n    y: number;\r\n    z: number;\r\n    w: number;\r\n}\r\n\r\nexport class Vec4 implements IVec4 {\r\n\r\n    static readonly ONE = new Vec4(1,1,1,1);\r\n\r\n    [key: number]: number;\r\n    [Symbol.iterator]() {\r\n        let step = 0;\r\n        return { next: () => ({ value: this[step++], done: step > 4 }) }\r\n    }\r\n\r\n    get x() { return this[0]; }\r\n    get y() { return this[1]; }\r\n    get z() { return this[2]; }\r\n    get w() { return this[3]; }\r\n    get xyzw() { return [this.x, this.y, this.z, this.w]; }\r\n\r\n    set x(value: number) { this[0] = value; }\r\n    set y(value: number) { this[1] = value; }\r\n    set z(value: number) { this[2] = value; }\r\n    set w(value: number) { this[3] = value; }\r\n    set xyzw(value: [number, number, number, number]) { \r\n        this.x = value[0]; \r\n        this.y = value[1];\r\n        this.z = value[2];\r\n        this.w = value[3];\r\n    }\r\n\r\n    constructor(x: number = 0, y: number = 0, z: number = 0, w: number = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n        this.w = w;\r\n     }\r\n\r\n    static add(lhs: IVec4, rhs: IVec4): Vec4 {\r\n        return new Vec4(lhs.x + rhs.x, lhs.y + rhs.y, lhs.z + rhs.z, lhs.w + rhs.w);\r\n    }\r\n    static sub(lhs: IVec4, rhs: IVec4): Vec4 {\r\n        return new Vec4(lhs.x - rhs.x, lhs.y - rhs.y, lhs.z - rhs.z, lhs.w - rhs.w);\r\n    }\r\n    static mul(lhs: IVec4, rhs: IVec4): Vec4 {\r\n        return new Vec4(lhs.x * rhs.x, lhs.y * rhs.y, lhs.z * rhs.z, lhs.w * rhs.w);\r\n    }\r\n    static div(lhs: IVec4, rhs: IVec4): Vec4 {\r\n        return new Vec4(lhs.x / rhs.x, lhs.y / rhs.y, lhs.z / rhs.z, lhs.w / rhs.w);\r\n    }\r\n    static normalise(vec: IVec4): Vec4 {\r\n        const len = Vec4.len(vec);\r\n        return new Vec4(vec.x / len, vec.y / len, vec.z / len, vec.w / len );\r\n    }\r\n    static len(vec: IVec4): number {\r\n        return Math.sqrt(vec.x * vec.x + vec.y * vec.y + vec.z * vec.z + vec.w * vec.w);\r\n    }\r\n    static dot(lhs: IVec4, rhs: IVec4): number {\r\n        return lhs.x * rhs.x + lhs.y * rhs.y + lhs.z * rhs.z + lhs.w * rhs.w;\r\n    }\r\n\r\n    add(rhs: IVec4): Vec4 {\r\n        this.x += rhs.x;\r\n        this.y += rhs.y;\r\n        this.z += rhs.z;\r\n        this.w += rhs.w;\r\n        return this;\r\n    }\r\n\r\n    sub(rhs: IVec4): Vec4 {\r\n        this.x -= rhs.x;\r\n        this.y -= rhs.y;\r\n        this.z -= rhs.z;\r\n        this.w -= rhs.w;\r\n        return this;\r\n    }\r\n\r\n    mul(rhs: IVec4) : Vec4 {\r\n        this.x *= rhs.x;\r\n        this.y *= rhs.y;\r\n        this.z *= rhs.z;\r\n        this.w *= rhs.w;\r\n        return this;\r\n    }\r\n\r\n    div(rhs: IVec4) : Vec4 {\r\n        this.x /= rhs.x;\r\n        this.y /= rhs.y;\r\n        this.z /= rhs.z;\r\n        this.w /= rhs.w;\r\n        return this;\r\n    }\r\n\r\n    normalise() : Vec4 {\r\n        const len = this.length();\r\n        this.x /= len;\r\n        this.y /= len;\r\n        this.z /= len;\r\n        this.w /= len;\r\n        return this;\r\n    }\r\n\r\n    length(): number {\r\n        return Vec4.len(this);\r\n    }\r\n\r\n    dot(rhs: IVec4): number{\r\n        return Vec4.dot(this, rhs);\r\n    }\r\n\r\n}\r\n","\r\nimport { Vec2 } from './vec2';\r\nimport { Vec3, IVec3 } from './vec3';\r\n\r\n\r\nexport interface IMat3 {\r\n    [key: number]: number;\r\n}\r\n\r\nexport class Mat3 implements IMat3 {\r\n\r\n    [key: number]: number;\r\n    [Symbol.iterator]() {\r\n        let step = 0;\r\n        return { next: () => ({ value: this[step++], done: step > 9 }) }\r\n    }\r\n\r\n    get right(): Vec2 { return new Vec2(this[0], this[1]); }\r\n    get up(): Vec2 { return new Vec2(this[4], this[5]); }\r\n    get pos(): Vec2 { return new Vec2(this[6], this[7]); }\r\n    get scale(): Vec2 { return new Vec2( this.right.length(), this.up.length() )}\r\n\r\n    static row(mat: IMat3, i: number): Vec3 {\r\n        const ri = (i * 3);\r\n        return new Vec3( mat[ri+0], mat[ri+1], mat[ri+2] );\r\n    }\r\n\r\n    static col(mat: IMat3, i: number): Vec3 {\r\n        return new Vec3(mat[i+0], mat[i+3], mat[i+6]);\r\n    }\r\n\r\n    constructor(mat3: IMat3) {\r\n        for(let i=0; i<9; i++)\r\n            this[i] = mat3[i];\r\n    }\r\n\r\n    static identity() {\r\n        return new Mat3([\r\n            1, 0, 0,\r\n            0, 1, 0,\r\n            0, 0, 1\r\n        ]);\r\n    }\r\n\r\n    static translation(x: number, y: number): Mat3 {\r\n        return new Mat3([\r\n            1, 0, 0,\r\n            0, 1, 0,\r\n            x, y, 1\r\n        ]);\r\n    }\r\n\r\n    static rotation(rot: number): Mat3 {\r\n        const s = Math.sin(rot);\r\n        const c = Math.cos(rot);\r\n        return new Mat3([\r\n            c, s, 0,\r\n           -s, c, 0,\r\n            0, 0, 1\r\n        ]);\r\n    }\r\n\r\n    static scale(xs: number, ys: number): Mat3 {\r\n        const result = new Mat3([\r\n            xs, 0,  0,\r\n            0,  ys, 0,\r\n            0,  0,  1\r\n        ]);\r\n        return result;\r\n    }\r\n\r\n    static mul(lhs: IMat3, rhs: IMat3) {\r\n\r\n        return new Mat3([\r\n            lhs[0]*rhs[0] + lhs[1]*rhs[3] + lhs[2]*rhs[6], // Vec3.dot(r1, c1),\r\n            lhs[0]*rhs[1] + lhs[1]*rhs[4] + lhs[2]*rhs[7], // Vec3.dot(r1, c2), \r\n            lhs[0]*rhs[2] + lhs[1]*rhs[5] + lhs[2]*rhs[8], // Vec3.dot(r1, c3),\r\n            lhs[3]*rhs[0] + lhs[4]*rhs[3] + lhs[5]*rhs[6], // Vec3.dot(r2, c1),\r\n            lhs[3]*rhs[1] + lhs[4]*rhs[4] + lhs[5]*rhs[7], // Vec3.dot(r2, c2), \r\n            lhs[3]*rhs[2] + lhs[4]*rhs[5] + lhs[5]*rhs[8], // Vec3.dot(r2, c3),\r\n            lhs[6]*rhs[0] + lhs[7]*rhs[3] + lhs[8]*rhs[6], // Vec3.dot(r3, c1),\r\n            lhs[6]*rhs[1] + lhs[7]*rhs[4] + lhs[8]*rhs[7], // Vec3.dot(r3, c2),\r\n            lhs[6]*rhs[2] + lhs[7]*rhs[5] + lhs[8]*rhs[8]  // Vec3.dot(r3, c3)\r\n        ]);\r\n\r\n        // const r1 = Mat3.row(lhs, 0);\r\n        // const r2 = Mat3.row(lhs, 1);\r\n        // const r3 = Mat3.row(lhs, 2);\r\n\r\n        // const c1 = Mat3.col(rhs, 0);\r\n        // const c2 = Mat3.col(rhs, 1);\r\n        // const c3 = Mat3.col(rhs, 2);\r\n\r\n        // return new Mat3([\r\n        //     Vec3.dot(r1, c1), Vec3.dot(r1,c2),  Vec3.dot(r1, c3),\r\n        //     Vec3.dot(r2, c1), Vec3.dot(r2,c2),  Vec3.dot(r2, c3),\r\n        //     Vec3.dot(r3, c1), Vec3.dot(r3,c2),  Vec3.dot(r3, c3)\r\n        // ]);\r\n    }\r\n\r\n    static transformPoint(mat: Mat3, point: IVec3): IVec3 {\r\n\r\n        return {\r\n            x: point.x*mat[0] + point.y*mat[3] + point.z*mat[6],\r\n            y: point.x*mat[1] + point.y*mat[4] + point.z*mat[7],\r\n            z: point.x*mat[2] + point.y*mat[5] + point.z*mat[8]\r\n        };\r\n\r\n        // const c1 = Mat3.col(mat, 0);\r\n        // const c2 = Mat3.col(mat, 1);\r\n        // const c3 = Mat3.col(mat, 2);\r\n        // return {\r\n        //     x: Vec3.dot(point, c1 ),\r\n        //     y: Vec3.dot(point, c2 ),\r\n        //     z: Vec3.dot(point, c3 )\r\n        // }\r\n    }\r\n\r\n    // mul(rhs: Mat3): Mat3 {\r\n    //     const result = Mat3.mul(this, rhs);\r\n    //     return result;\r\n    // }\r\n\r\n    copy(): Mat3 {\r\n        return new Mat3([\r\n            this[0], this[1], this[2],\r\n            this[3], this[4], this[5],\r\n            this[6], this[7], this[8]\r\n        ]);\r\n    }\r\n\r\n    equal(rhs: Mat3): boolean {\r\n        const e = Number.EPSILON;\r\n        for (let i = 0; i < 9; i++) {\r\n            if (Math.abs(this[i] - rhs[i]) > e) {\r\n                return false\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    move(tx: number, ty: number) {\r\n        this[6] += tx;\r\n        this[7] += ty;\r\n    }\r\n\r\n    setPos(tx: number, ty: number) {\r\n        this[6] = tx;\r\n        this[7] = ty;\r\n    }\r\n\r\n    setPosX(tx: number) {\r\n        this[6] = tx;\r\n    }\r\n\r\n    setPosY(ty: number) {\r\n        this[7] = ty;\r\n    }\r\n}\r\n","\r\nimport { Vec3 } from './vec3';\r\nimport { Vec4 } from './vec4';\r\n\r\n\r\nexport interface IMat4 {\r\n    [key: number]: number;\r\n}\r\n\r\nexport class Mat4 implements IMat4 {\r\n\r\n    /*\r\n        0,  1,  2,  3,\r\n        4,  5,  6,  7,\r\n        8,  9,  10, 11\r\n        12, 13, 14, 15\r\n    */\r\n\r\n    [key: number]: number;\r\n\r\n    [Symbol.iterator]() {\r\n        let step = 0;\r\n        return { next: () => ({ value: this[step++], done: step > 16 }) }\r\n    }\r\n\r\n    static Identity: Mat4 = new Mat4([\r\n        1, 0, 0, 0,\r\n        0, 1, 0, 0,\r\n        0, 0, 1, 0,\r\n        0, 0, 0, 1\r\n    ]);\r\n\r\n    get right(): Vec3 { return new Vec3(this[0], this[1], this[2]); }\r\n    get up(): Vec3 { return new Vec3(this[4], this[5], this[6]); }\r\n    get forward(): Vec3 { return new Vec3(this[8], this[9], this[10]); }\r\n    get pos(): Vec3 { return new Vec3(this[12], this[13], this[14]); }\r\n    toArray() { return [...this] }\r\n\r\n    static row(mat: IMat4, i: number): Vec4 {\r\n        const ri = (i * 4);\r\n        return new Vec4( mat[ri+0], mat[ri+1], mat[ri+2], mat[ri+3] );\r\n    }\r\n\r\n    static col(mat: IMat4, i: number): Vec4 {\r\n        return new Vec4(mat[i+0], mat[i+4], mat[i+8], mat[i+12]);\r\n    }\r\n\r\n    constructor(mat: IMat4 = Mat4.Identity) {\r\n        for(let i=0; i<16; i++)\r\n            this[i] = mat[i];\r\n    }\r\n\r\n    static translation(x: number, y: number, z: number) {\r\n        return new Mat4([\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            x, y, z, 1\r\n        ]);\r\n    }\r\n\r\n    static scale(xs: number, ys: number, zs: number) {\r\n        return new Mat4([\r\n            xs, 0,  0, 0,\r\n            0,  ys, 0, 0,\r\n            0,  0,  zs, 0,\r\n            0, 0, 0, 1\r\n        ]);\r\n    }\r\n\r\n    static orthographicProjection(left: number, right: number, bottom: number, top: number, near: number, far: number) {\r\n\r\n        return new Mat4([\r\n            2.0 / (right - left), 0.0, 0.0, 0.0,\r\n            0.0, 2.0 / (top - bottom), 0.0, 0.0,\r\n            0.0, 0.0,-2.0 / (far - near), 0.0,\r\n\r\n            -( (right + left) / (right - left)), \r\n            -( (top + bottom) / (top - bottom)), \r\n            -( (far + near) / (far - near)), \r\n            1.0\r\n        ]);\r\n    }\r\n\r\n    static mul(lhs: IMat4, rhs: IMat4) {\r\n        const r1 = Mat4.row(lhs, 0);\r\n        const r2 = Mat4.row(lhs, 1);\r\n        const r3 = Mat4.row(lhs, 2);\r\n        const r4 = Mat4.row(lhs, 3);\r\n\r\n        const c1 = Mat4.col(rhs, 0);\r\n        const c2 = Mat4.col(rhs, 1);\r\n        const c3 = Mat4.col(rhs, 2);\r\n        const c4 = Mat4.col(rhs, 3);\r\n\r\n        return new Mat4([\r\n            Vec4.dot(r1, c1), Vec4.dot(r1,c2),  Vec4.dot(r1, c3), Vec4.dot(r1, c4),\r\n            Vec4.dot(r2, c1), Vec4.dot(r2,c2),  Vec4.dot(r2, c3), Vec4.dot(r2, c4),\r\n            Vec4.dot(r3, c1), Vec4.dot(r3,c2),  Vec4.dot(r3, c3), Vec4.dot(r3, c4),\r\n            Vec4.dot(r4, c1), Vec4.dot(r4,c2),  Vec4.dot(r4, c3), Vec4.dot(r4, c4)\r\n        ]);\r\n    }\r\n\r\n}","import { Vec2, IVec2 } from \"./vec2\";\r\n\r\nexport class Rect {\r\n    pos: Vec2;\r\n    size: Vec2;\r\n\r\n    get left() { return this.pos.x; }\r\n    get right() { return this.pos.x + this.size.x; }\r\n    get top() { return this.pos.y; }\r\n    get bottom() { return this.pos.y + this.size.y; }\r\n\r\n    get min() { return new Vec2(this.pos.x, this.pos.y); }\r\n    get max() { return Vec2.add(this.pos, this.size); }\r\n\r\n    get topLeft(): IVec2       { return {x: this.pos.x, y: this.pos.y } }\r\n    get topRight(): IVec2      { return {x: this.pos.x + this.size.x, y: this.pos.y} }\r\n    get bottomRight(): IVec2   { return {x: this.pos.x + this.size.x, y: this.pos.y + this.size.y} }\r\n    get bottomLeft(): IVec2    { return {x: this.pos.x, y: this.pos.y + this.size.y} }\r\n\r\n    constructor(x: number, y: number, w: number, h: number) {\r\n        this.pos = new Vec2(x, y);\r\n        this.size = new Vec2(w, h);\r\n    }\r\n\r\n    contains(point: IVec2): boolean {\r\n        return point.x >= this.left && point.x < this.right &&\r\n            point.y >= this.top && point.y < this.bottom;\r\n    }\r\n}","import { Vec2, IVec2, Shape } from \".\";\r\n\r\n\r\nexport interface RayHit {\r\n    incomingRay: Ray;\r\n    reflectedRay: Ray;\r\n    point: IVec2;\r\n    normal: IVec2;\r\n    distance: number;\r\n    target: Shape;\r\n}\r\n\r\nexport class Ray {\r\n    pos: Vec2 = new Vec2();\r\n    dir: Vec2 = new Vec2();\r\n    hit: RayHit = null;\r\n\r\n    constructor(pos: IVec2, dir: IVec2) {\r\n        this.pos.x = pos.x;\r\n        this.pos.y = pos.y;\r\n        this.dir.x = dir.x;\r\n        this.dir.y = dir.y;\r\n    }\r\n\r\n    castToLine(x1: number, y1: number, x2: number, y2: number, createReflected: boolean = false): boolean {\r\n\r\n        // Line Intersection formula\r\n        // https://en.wikipedia.org/wiki/Line-line_intersection\r\n\r\n        this.hit = null;\r\n\r\n        const x3 = this.pos.x;\r\n        const y3 = this.pos.y;\r\n        const x4 = this.pos.x + this.dir.x;\r\n        const y4 = this.pos.y + this.dir.y;\r\n\r\n        const den = (x1-x2) * (y3-y4) - (y1 - y2) * (x3 - x4);\r\n        if(den === 0)\r\n            return false;\r\n\r\n        const t = ((x1-x3) * (y3-y4) - (y1 - y3) * (x3-x4)) / den;\r\n        const u = -((x1-x2) * (y1-y3) - (y1 - y2) * (x1-x3)) / den\r\n\r\n        // this means the lines are not intersecting, so return\r\n        if(!(t >= 0 && t <= 1 && u >= 0)) {\r\n            return false;\r\n        }\r\n\r\n        const point = new Vec2( x1 + t * (x2 - x1), y1 + t * (y2 - y1));\r\n        const normal = Vec2.perpendicular( Vec2.normalise(Vec2.sub(new Vec2(x1, y1), new Vec2(x2, y2))) );\r\n        if( normal.dot(this.dir) < 0 ) {\r\n            normal.x = -normal.x;\r\n            normal.y = -normal.y;\r\n        }\r\n            \r\n        // calculate a new ray, that contains the point of intersection\r\n        // and a reflected direction\r\n\r\n        let reflectRay = null; \r\n        if(createReflected) {\r\n            reflectRay = new Ray(Vec2.sub(point, this.dir), Vec2.reflect(this.dir, normal));\r\n        }\r\n\r\n        const hit: RayHit = {\r\n            point: point,\r\n            normal: normal,\r\n            distance: Vec2.distance(this.pos, point),\r\n            incomingRay: this,\r\n            reflectedRay: reflectRay,\r\n            target: null\r\n        };\r\n        \r\n        this.hit = hit;\r\n        return true;\r\n    }\r\n\r\n    castToShapes(shapes: Shape[], numReflections: number = 0, shouldRefletCallback: (hit: RayHit) => boolean = null): boolean {\r\n        let bestHit: RayHit = null;\r\n        this.hit = null;\r\n\r\n        for(const shape of shapes) {\r\n            for(let i=0; i<shape.points.length-1; i++) {\r\n                const p1 = shape.points[i];\r\n                const p2 = shape.points[i+1];\r\n    \r\n                if( this.castToLine(p1.x, p1.y, p2.x, p2.y,  numReflections >= 1) ) {\r\n                    if((this.hit.distance < bestHit?.distance) || bestHit == null) {\r\n                        bestHit = this.hit;\r\n                        bestHit.target = shape;\r\n                    }\r\n                        \r\n                }\r\n            }\r\n        }\r\n\r\n        this.hit = bestHit;\r\n        \r\n        if(numReflections > 0 && this.hit) {\r\n            const shouldReflect = bestHit == null || shouldRefletCallback === null || shouldRefletCallback(bestHit);\r\n            if(shouldReflect)\r\n                this.hit.reflectedRay.castToShapes(shapes, numReflections -1);\r\n            // else\r\n            //     this.hit.reflectedRay = null;\r\n\r\n        }\r\n            \r\n        \r\n        return this.hit !== null;\r\n    }\r\n\r\n    rays(): Ray[] {\r\n        const rays: Ray[] = [];\r\n        this.recursiveGetRays(rays);\r\n        return rays;\r\n    }\r\n\r\n    hits(): RayHit[] {\r\n        const hits: RayHit[] = [];\r\n        this.recursiveGetHits(hits);\r\n        return hits;\r\n    }\r\n\r\n    private recursiveGetHits(outHits: RayHit[]) {        \r\n        if(this.hit == null)\r\n            return;\r\n\r\n        outHits.push(this.hit);\r\n        this.hit.reflectedRay?.recursiveGetHits(outHits);\r\n    }\r\n\r\n    private recursiveGetRays(outRays: Ray[]) {\r\n        outRays.push(this);\r\n        this.hit?.reflectedRay?.recursiveGetRays(outRays);\r\n    }\r\n}","import { IVec2, IVec3 } from \".\";\r\nimport { Mat3 } from \"./mat3\";\r\n\r\n\r\nexport class Shape {\r\n\r\n    constructor(public points: IVec2[] = []) {\r\n    }\r\n\r\n    static makeCircle(xPos: number, yPos: number, radius: number, segments: number) {\r\n        const points: IVec2[] = [];\r\n        for(let i=0; i<=segments;  i++) {\r\n\r\n            const r = ((2.0 * Math.PI) / segments) * i;\r\n            const x =  Math.sin(r) * radius;\r\n            const y = -Math.cos(r) * radius;\r\n\r\n            points.push({x: xPos + x, y: yPos + y});\r\n        }\r\n\r\n        return new Shape(points);\r\n    }\r\n\r\n    static makeLine(x1: number, y1: number, x2: number, y2: number) {\r\n        const points: IVec2[] = [\r\n            {x: x1, y: y1}, {x: x2, y: y2}\r\n        ];\r\n\r\n        return new Shape(points);\r\n    }\r\n\r\n    static makeBox(x: number, y: number, width: number, height: number, rot: number, open: boolean = false) {\r\n        let points: IVec3[] = [\r\n            {x:  width/2,   y:  height/2, z: 1}, // br\r\n            {x: -width/2,   y:  height/2, z: 1}, // bl\r\n            {x: -width/2,   y: -height/2, z: 1}, // tl\r\n            {x:  width/2,   y: -height/2, z: 1}, // tr\r\n        ];\r\n\r\n        if(!open) {\r\n            points.push( {x:  width/2,   y:  height/2, z: 1});\r\n        }\r\n\r\n        points = points.map(p => Mat3.transformPoint( Mat3.mul(Mat3.rotation(rot), Mat3.translation(x, y)), p )  );\r\n\r\n        return new Shape(points);\r\n    }\r\n\r\n    static makeAngleTriangle(x: number, y: number, width: number, height: number, rot: number) {\r\n        const hw = Math.ceil(width * 0.5);\r\n        const hh = Math.ceil(height * 0.5);\r\n        let points: IVec3[] = [\r\n            {x: 0 - hw,     y: 0 - hh, z: 1}, \r\n            {x: 0 + hw,     y: 0 - hh, z: 1},\r\n            {x: 0 - hw,     y: 0 + hh, z: 1},\r\n            {x: 0 - hw,     y: 0 - hh, z: 1}\r\n        ];\r\n        points = points.map(p => Mat3.transformPoint( Mat3.mul(Mat3.rotation(rot), Mat3.translation(x, y)), p )  );\r\n        return new Shape(points);\r\n    }\r\n}","\r\nexport * from './vec2';\r\nexport * from './vec3';\r\nexport * from './vec4';\r\nexport * from './mat3';\r\nexport * from './mat4';\r\nexport * from './rect';\r\nexport * from './ray';\r\nexport * from './shape';","\r\nimport { Vec2 } from '../math';\r\n\r\n\r\nexport class MouseInput {\r\n    \r\n    pos: Vec2 = new Vec2();\r\n    dt: Vec2 = new Vec2();\r\n    leftButtonDown: boolean = false;\r\n\r\n    constructor(private canvas: HTMLCanvasElement) {\r\n        document.addEventListener(\"mousedown\", this.mouseDownEventHandler);\r\n        document.addEventListener(\"mousemove\", this.mouseMoveEventHandler);\r\n        document.addEventListener(\"mouseup\", this.mouseUpEventHandler);\r\n    }\r\n\r\n    destroy() {\r\n        document.removeEventListener(\"mousedown\", this.mouseDownEventHandler);\r\n        document.removeEventListener(\"mousemove\", this.mouseMoveEventHandler);\r\n        document.removeEventListener(\"mouseup\", this.mouseUpEventHandler);\r\n    }\r\n\r\n    update() {\r\n        this.dt = new Vec2();\r\n    }\r\n\r\n    private mouseDownEventHandler = (e: MouseEvent) => {\r\n        this.leftButtonDown = true;\r\n    }\r\n\r\n    private mouseMoveEventHandler = (e: MouseEvent) => {\r\n\r\n        const area = this.canvas.getBoundingClientRect();\r\n\r\n        const lastPos = this.pos;\r\n        this.pos = new Vec2(e.pageX - area.x, e.pageY - area.y);\r\n        this.dt = Vec2.sub(this.pos, lastPos);\r\n    }\r\n    private mouseUpEventHandler = () => {\r\n        this.leftButtonDown = false;\r\n    }\r\n}","\r\n\r\nexport class KeyboardInput {\r\n    \r\n    lastKeyState: {[key: number]: boolean} = {};\r\n    keyState: {[key: number]: boolean} = {};\r\n\r\n    constructor(private canvas: HTMLCanvasElement) {\r\n        console.log('creating keyboard input');\r\n        document.addEventListener(\"keydown\", this.keyDownEventHandler);\r\n        document.addEventListener(\"keyup\", this.keyUpEventHandler);\r\n        \r\n    }\r\n\r\n    destroy() {\r\n        document.removeEventListener(\"keydown\", this.keyDownEventHandler);\r\n        document.removeEventListener(\"keyup\", this.keyUpEventHandler);\r\n    }\r\n\r\n    isKeyDown(key: number): boolean {\r\n        return this.keyState[key] || false;\r\n    }\r\n\r\n    wasKeyPressed(key: number): boolean {\r\n        return (this.keyState[key] && !this.lastKeyState[key]) || false;\r\n    }\r\n\r\n    wasKeyReleased(key: number): boolean {\r\n        return (this.keyState[key] && !this.lastKeyState[key]) || false;\r\n    }\r\n\r\n    update() {\r\n        this.lastKeyState = {...this.keyState};\r\n    }\r\n\r\n    private keyDownEventHandler = (e: KeyboardEvent) => {\r\n        this.keyState[e.keyCode] = true;\r\n    }\r\n\r\n    private keyUpEventHandler = (e: KeyboardEvent) => {\r\n        this.keyState[e.keyCode] = false;\r\n    }\r\n\r\n}","import { MouseInput } from './mouseInput';\r\nimport { KeyboardInput } from './keyboardInput';\r\n\r\nexport class InputManager {\r\n\r\n    mouse: MouseInput;\r\n    keyboard: KeyboardInput;\r\n\r\n\r\n    constructor(canvas: HTMLCanvasElement) {\r\n        this.mouse = new MouseInput(canvas);\r\n        this.keyboard = new KeyboardInput(canvas);\r\n    }\r\n\r\n    destroy() {\r\n        this.mouse.destroy();\r\n        this.keyboard.destroy();\r\n        \r\n        this.keyboard = null;\r\n        this.mouse = null;\r\n    }\r\n}","\r\nexport interface ITexture2d {\r\n    \r\n    handle: WebGLTexture;\r\n    width: number;\r\n    height: number;\r\n\r\n}\r\n\r\nexport class Texture2D implements ITexture2d {\r\n\r\n    image: HTMLImageElement;\r\n    handle: WebGLTexture;\r\n\r\n    get width() {\r\n        return this.image.width;\r\n    }\r\n\r\n    get height() {\r\n        return this.image.height;\r\n    }\r\n\r\n    constructor(protected gl: WebGL2RenderingContext) {\r\n        this.image = new Image();\r\n    }\r\n\r\n    destroy() {\r\n        this.gl.deleteTexture(this.handle);\r\n        this.handle = null;\r\n    }\r\n\r\n    load(location: string): Promise<Texture2D> {\r\n        return new Promise<Texture2D>((resolve, reject) => {\r\n            this.image.crossOrigin = 'anonymous';\r\n            this.image.src = location;\r\n            this.image.addEventListener('load', () => {\r\n\r\n                this.handle = this.gl.createTexture();\r\n                this.gl.bindTexture(this.gl.TEXTURE_2D, this.handle);\r\n\r\n                this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\r\n                this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\r\n                this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.REPEAT);\r\n                this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.REPEAT);\r\n\r\n                this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.width, this.height, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, this.image);\r\n\r\n                this.gl.bindTexture(this.gl.TEXTURE_2D, this.handle);\r\n\r\n                resolve(this);\r\n            });\r\n        });\r\n    }\r\n\r\n}","\r\n\r\nexport abstract class Shader \r\n{\r\n    infoLog: string[] = [];\r\n    program: WebGLProgram = null;\r\n    attributes: {[key: string]: number} = {};\r\n\r\n    constructor(protected gl: WebGL2RenderingContext) {\r\n    }\r\n\r\n    destroy() {\r\n        this.gl.deleteProgram(this.program);\r\n    }\r\n\r\n    enable() {\r\n        this.gl.useProgram(this.program);\r\n    }\r\n\r\n    disable() {\r\n        this.gl.useProgram(this.program);\r\n    }\r\n\r\n    bindTexture2d(textureHandle: WebGLTexture, uniformLoc: WebGLUniformLocation, textureChanelIndex: number) {\r\n        this.gl.uniform1i(uniformLoc, textureChanelIndex);\r\n        this.gl.activeTexture( this.gl.TEXTURE0 + textureChanelIndex);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, textureHandle);\r\n        this.gl.activeTexture( this.gl.TEXTURE0 );\r\n    }\r\n\r\n    protected createShader(source: string, type: number): WebGLShader {\r\n        const shader = this.gl.createShader(type);\r\n        this.gl.shaderSource(shader, source);\r\n        this.gl.compileShader(shader);\r\n\r\n        const log = this.gl.getShaderInfoLog(shader);\r\n        this.infoLog.push('[ VERT ] ' + log);\r\n\r\n        return shader;\r\n    }\r\n\r\n    protected createProgram(vertexShader: WebGLShader, fragmentShader: WebGLShader, inputs: string[], deleteShaders: boolean = true): WebGLProgram {\r\n        const program = this.gl.createProgram();\r\n        this.gl.attachShader(program, vertexShader);\r\n        this.gl.attachShader(program, fragmentShader);\r\n        \r\n        for(let i = 0; i < inputs.length; i++) {\r\n            this.attributes[inputs[i]] = i;\r\n            this.gl.bindAttribLocation(program, i, inputs[i]);\r\n        }\r\n\r\n        this.gl.linkProgram(program);\r\n        this.gl.validateProgram(program);\r\n        \r\n        const log = this.gl.getProgramInfoLog(program);\r\n        this.infoLog.push('[ FRAG ] ' + log);        \r\n        \r\n        if(deleteShaders) {\r\n            this.gl.deleteShader(vertexShader);\r\n            this.gl.deleteShader(fragmentShader);\r\n        }\r\n\r\n        return program;\r\n    }\r\n\r\n}","\r\nimport { ITexture2d } from './texture';\r\n\r\nexport class RenderTexture implements ITexture2d {\r\n\r\n    width: number = 0;\r\n    height: number = 0;\r\n    handle: WebGLTexture = null;\r\n\r\n    glFrameBuffer: WebGLFramebuffer = null;\r\n    glDepthBuffer: WebGLRenderbuffer = null;\r\n\r\n    static rendetTargetStack: RenderTexture[] = [];\r\n    \r\n    constructor(protected gl: WebGL2RenderingContext) {\r\n        \r\n    }\r\n\r\n    load(width: number, height: number) {\r\n        this.width = width;\r\n        this.height = height;\r\n\r\n\r\n        // Create an opengl texture\r\n        this.handle = this.gl.createTexture();\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.handle);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.REPEAT);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.REPEAT);\r\n        this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.width, this.height, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, null);\r\n\r\n        // create the framebuffer\r\n        this.glFrameBuffer = this.gl.createFramebuffer();\r\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, this.glFrameBuffer);\r\n        this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER, this.gl.COLOR_ATTACHMENT0, this.gl.TEXTURE_2D, this.handle, 0);\r\n        this.gl.drawBuffers([this.gl.COLOR_ATTACHMENT0]);\r\n\r\n        // checck if everything was successfull\r\n        const frameBufferStatus = this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER);\r\n        if( frameBufferStatus != this.gl.FRAMEBUFFER_COMPLETE )\r\n            return false;\r\n\r\n        // restore things back to normal\r\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, null);\r\n\r\n        return true;\r\n\r\n    }\r\n\r\n    destroy() {\r\n        this.gl.deleteFramebuffer(this.glFrameBuffer);\r\n        this.gl.deleteTexture(this.handle);\r\n    }\r\n\r\n    enable() {\r\n        RenderTexture.enableRenderTarget(this.gl, this);\r\n    }\r\n\r\n    disable() {\r\n        RenderTexture.disableRenderTarget(this.gl);\r\n    }\r\n\r\n    static enableRenderTarget(gl: WebGL2RenderingContext, target: RenderTexture) {\r\n\r\n        RenderTexture.rendetTargetStack.push(target);\r\n\r\n        const currentRenderTarget = RenderTexture.currentRenderTarget();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, currentRenderTarget.glFrameBuffer);\r\n        gl.viewport(0, 0, currentRenderTarget.width, currentRenderTarget.height);\r\n        \r\n    }\r\n\r\n    static disableRenderTarget(gl: WebGL2RenderingContext) {\r\n        if(RenderTexture.rendetTargetStack.length > 1)\r\n            RenderTexture.rendetTargetStack.pop();\r\n\r\n        const currentRenderTarget = RenderTexture.currentRenderTarget();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, currentRenderTarget.glFrameBuffer);\r\n        gl.viewport(0, 0, currentRenderTarget.width, currentRenderTarget.height);\r\n\r\n    }\r\n\r\n    static currentRenderTarget() {\r\n        return RenderTexture.rendetTargetStack[RenderTexture.rendetTargetStack.length-1] ?? null\r\n    }\r\n}","\r\nimport { Vec2, IVec2, IVec3, Vec4, IVec4, Mat4, Rect } from '../math';\r\nimport { ITexture2d, Texture2D } from './texture';\r\nimport { Shader } from './shader';\r\nimport { Mat3 } from '../math/mat3';\r\nimport { RenderTexture } from './renderTexture';\r\n\r\nexport enum RenderMode {\r\n    FILL,\r\n    WIREFRAME,\r\n}\r\n\r\nconst vertex_shader = `\r\n    precision mediump float;\r\n\r\n    attribute vec3 a_position;\r\n    attribute vec4 a_color;\r\n    attribute vec2 a_uv;\r\n\r\n    uniform mat4 u_projection;\r\n\r\n    varying vec2 v_uv;\r\n    varying vec4 v_color;\r\n    varying float v_uvId;\r\n\r\n    void main() \r\n    {\r\n        v_uvId = a_position.z;\r\n        v_color = a_color;\r\n        v_uv = a_uv;\r\n        gl_Position = vec4(a_position.x, a_position.y, 0.0, 1.0) * u_projection;\r\n    }\r\n`;\r\n\r\nconst fragment_shader = `\r\n    precision mediump float;\r\n\r\n    varying vec2 v_uv;\r\n    varying vec4 v_color;\r\n    varying float v_uvId;\r\n\r\n    uniform sampler2D u_texture0;\r\n    uniform sampler2D u_texture1;\r\n    uniform sampler2D u_texture2;\r\n    uniform sampler2D u_texture3;\r\n    uniform sampler2D u_texture4;\r\n\r\n    void main() \r\n    {\r\n        if      ( v_uvId == 0.0 ) gl_FragColor = texture2D(u_texture0, v_uv.st) * v_color;\r\n        else if ( v_uvId == 1.0 ) gl_FragColor = texture2D(u_texture1, v_uv.st) * v_color;\r\n        else if ( v_uvId == 2.0 ) gl_FragColor = texture2D(u_texture2, v_uv.st) * v_color;\r\n        else if ( v_uvId == 3.0 ) gl_FragColor = texture2D(u_texture3, v_uv.st) * v_color;\r\n        else if ( v_uvId == 4.0 ) gl_FragColor = texture2D(u_texture4, v_uv.st) * v_color;\r\n        else gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\r\n    }\r\n`;\r\n\r\nclass Renderer2DSpriteShader extends Shader {\r\n    constructor(gl: WebGL2RenderingContext) {\r\n        super(gl);\r\n\r\n        this.program = this.createProgram(\r\n            this.createShader(vertex_shader, this.gl.VERTEX_SHADER),\r\n            this.createShader(fragment_shader, this.gl.FRAGMENT_SHADER),\r\n            ['a_position', 'a_color', 'a_uv'], true\r\n        );\r\n    }\r\n\r\n    setTexture(textureHandle: WebGLTexture, index: number) {\r\n        const textureLoc = this.gl.getUniformLocation(this.program, `u_texture${index}`);\r\n        this.bindTexture2d(textureHandle, textureLoc, index);\r\n    }\r\n\r\n    setProjection(projection: Mat4) {\r\n        const uniformProjectionLoc = this.gl.getUniformLocation(this.program, \"u_projection\");\r\n        const arr = projection.toArray();\r\n\r\n        this.gl.uniformMatrix4fv(uniformProjectionLoc, true, arr );\r\n    }\r\n}\r\n\r\nclass GlMeshBuffer {\r\n\r\n    vao: WebGLVertexArrayObject;\r\n    vbo: WebGLBuffer;\r\n    ibo: WebGLBuffer;\r\n\r\n    vSizeBytes: number;\r\n    iSizeBytes: number;\r\n\r\n    constructor(protected gl: WebGL2RenderingContext, vSizeBytes: number, iSizeBytes: number) {\r\n        this.vSizeBytes = vSizeBytes;\r\n        this.iSizeBytes = iSizeBytes;\r\n\r\n        this.vao = this.gl.createVertexArray();\r\n        this.vbo = this.gl.createBuffer();\r\n        this.ibo = this.gl.createBuffer();\r\n    }\r\n\r\n    destroy() {\r\n        this.gl.deleteBuffer(this.ibo);\r\n        this.gl.deleteBuffer(this.vbo);\r\n        this.gl.deleteVertexArray(this.vao);\r\n    }\r\n\r\n    bind() {\r\n        this.gl.bindVertexArray(this.vao);\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vbo);\r\n        this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.ibo);\r\n    }\r\n\r\n    unbind() {\r\n        this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, null);\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, null);\r\n        this.gl.bindVertexArray(null);        \r\n    }\r\n\r\n    setVertexBufferSize(vertexBufferLength: number) {\r\n        const vertexBufferSize = vertexBufferLength * this.vSizeBytes;\r\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, vertexBufferSize, this.gl.DYNAMIC_DRAW);\r\n    }\r\n\r\n    setIndexBufferSize(indexBufferLength: number) {\r\n        const indexBufferSize = indexBufferLength * this.iSizeBytes;\r\n        this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER, indexBufferSize, this.gl.DYNAMIC_DRAW);\r\n    }\r\n\r\n    setVertexBufferData(verts: ArrayBufferView, numVerts: number, floatsPerVert: number) {\r\n        //this.gl.bufferSubData(this.gl.ARRAY_BUFFER, 0, verts, 0, numVerts * floatsPerVert);\r\n        this.gl.bufferSubData(this.gl.ARRAY_BUFFER, 0, verts, 0);       \r\n    }\r\n\r\n    setIndexBufferData(indices: ArrayBufferView, num: number) {\r\n        // this.gl.bufferSubData(this.gl.ELEMENT_ARRAY_BUFFER, 0, indices, 0, num); //,  num * this.iSizeBytes);\r\n        this.gl.bufferSubData(this.gl.ELEMENT_ARRAY_BUFFER, 0, indices, 0); \r\n    }\r\n\r\n    draw(numIndices: number, renderMode: number = this.gl.TRIANGLES) {\r\n        this.gl.drawElements(renderMode, numIndices, this.gl.UNSIGNED_SHORT, 0);\r\n    }\r\n}\r\n\r\nclass SpriteBuffer\r\n{\r\n    // 512 sprites, 4 verts per quad, 9 floats per vert\r\n    verts: Float32Array = new Float32Array(128 * 4 * 9);\r\n\r\n    // 512 sprites, 6 indices per quad (3 per triangle)\r\n    indices: Uint16Array = new Uint16Array(128 * 6);\r\n\r\n    buffer: GlMeshBuffer;\r\n\r\n    size = Float32Array.BYTES_PER_ELEMENT * 9;\r\n\r\n    private currentVert: number = 0;\r\n    private currentFace: number = 0;\r\n\r\n    get currentVertIndex(): number { return this.currentVert * 9; }\r\n    get currentIndicyIndex(): number { return this.currentFace * 3; }\r\n\r\n    constructor(protected gl: WebGL2RenderingContext) {\r\n        this.buffer = new GlMeshBuffer(this.gl, Float32Array.BYTES_PER_ELEMENT * 9, Uint16Array.BYTES_PER_ELEMENT);\r\n\r\n        this.buffer.bind();\r\n        this.buffer.setIndexBufferSize(this.indices.length);\r\n        this.buffer.setVertexBufferSize(this.verts.length);\r\n\r\n        // tell opengl the structure of our vertex\r\n        this.gl.enableVertexAttribArray(0);\r\n        this.gl.enableVertexAttribArray(1);\r\n        this.gl.enableVertexAttribArray(2);\r\n        \r\n        const vSize = this.size;\r\n        const fSize = Float32Array.BYTES_PER_ELEMENT;\r\n        \r\n        this.gl.vertexAttribPointer(0, 3, this.gl.FLOAT, false, vSize, fSize * 0); // position\r\n        this.gl.vertexAttribPointer(1, 4, this.gl.FLOAT, false, vSize, fSize * 3); // color\r\n        this.gl.vertexAttribPointer(2, 2, this.gl.FLOAT, false, vSize, fSize * 7); // uv\r\n\r\n        this.buffer.unbind();\r\n    }\r\n\r\n    destroy() {\r\n        this.buffer.destroy();\r\n        this.buffer = null;\r\n    }\r\n\r\n    draw(renderMode: number = this.gl.TRIANGLES) {\r\n        this.buffer.bind();\r\n        this.buffer.setVertexBufferData(this.verts, this.currentVert, 9);\r\n        this.buffer.setIndexBufferData(this.indices, this.currentIndicyIndex);\r\n        this.buffer.draw(this.currentIndicyIndex, renderMode);\r\n        this.buffer.unbind();\r\n    }\r\n\r\n    getPos(index: number): IVec3 {\r\n        const i = index * this.size;\r\n        const data = this.verts;\r\n        return {x: data[i+0], y: data[i+1], z: data[i+2] };\r\n    }\r\n\r\n    getColor(index: number): IVec4 {\r\n        const i = index * this.size;\r\n        const data = this.verts;\r\n        return {x: data[i+3], y: data[i+4], z: data[i+5], w: data[i+6] };\r\n    }\r\n\r\n    getUV(index: number): IVec2 {\r\n        const i = index * this.size;\r\n        const data = this.verts;\r\n        return {x: data[i+7], y: data[i+8] };\r\n    }\r\n\r\n    setPos(value: IVec3) {\r\n        const i = this.currentVertIndex;\r\n        const data = this.verts;\r\n        data[i+0] = value.x;\r\n        data[i+1] = value.y;\r\n        data[i+2] = value.z;\r\n        return this;\r\n    }\r\n\r\n    setColor(value: IVec4) {\r\n        const i = this.currentVertIndex;\r\n        const data = this.verts;\r\n        data[i+3] = value.x;\r\n        data[i+4] = value.y;\r\n        data[i+5] = value.z;\r\n        data[i+6] = value.w;\r\n        return this;\r\n    }\r\n\r\n    setUV(value: IVec2) {\r\n        const i = this.currentVertIndex;\r\n        const data = this.verts;\r\n        data[i+7] = value.x;\r\n        data[i+8] = value.y;\r\n        return this;\r\n    }\r\n\r\n    clear() {\r\n        this.currentVert = 0;\r\n        this.currentFace = 0;\r\n    }\r\n\r\n    saveVert() {\r\n        return this.currentVert++;\r\n    }\r\n\r\n    saveFace(i0: number, i1: number, i2: number) {\r\n        this.indices[this.currentIndicyIndex+0] = i0;\r\n        this.indices[this.currentIndicyIndex+1] = i1;\r\n        this.indices[this.currentIndicyIndex+2] = i2;\r\n        this.currentFace += 1;\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\ninterface IRenderState2D {\r\n    color: IVec4[];\r\n    uvRect?: Rect;\r\n    texture?: ITexture2d,\r\n    lineThickness?: number,\r\n    renderMode?: RenderMode,\r\n}\r\n\r\nexport class Renderer2d {\r\n\r\n    private projection: Mat4 = new Mat4();\r\n\r\n    private spriteBuffer: SpriteBuffer;\r\n    private shader: Renderer2DSpriteShader;\r\n\r\n    private maxTextures: number = 5;\r\n    private activeTextures: ITexture2d[] = [null, null, null, null, null];\r\n    private currentTextureId: number = 0;\r\n\r\n    private processingRender: boolean = false;\r\n\r\n    private blankTexture: Texture2D;\r\n\r\n    private renderState: IRenderState2D[] = [];\r\n    private numFlushes: number = 0;\r\n    \r\n    constructor(private canvas: HTMLCanvasElement, private gl: WebGL2RenderingContext) {\r\n\r\n        // so that we can use a single shader for our 2d rendering\r\n        // things that do not have a texture, will be textured with this blank\r\n        // 1x1 white pixel image\r\n        this.blankTexture = new Texture2D(this.gl);\r\n        this.blankTexture.load(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=\");\r\n\r\n        this.saveState(true);\r\n\r\n        // load shader\r\n        this.shader = new Renderer2DSpriteShader(this.gl);\r\n\r\n        // setup sprite graphics buffers\r\n        this.spriteBuffer = new SpriteBuffer(this.gl);\r\n    }\r\n\r\n    destroy() {\r\n        this.spriteBuffer.destroy();\r\n        this.shader.destroy();\r\n    }\r\n\r\n    begin() {\r\n        this.processingRender = true;\r\n        this.spriteBuffer.clear();\r\n        this.currentTextureId = 0;\r\n\r\n        const renderTarget = RenderTexture.currentRenderTarget();\r\n\r\n        // setup 2d projection matrix\r\n        if(renderTarget == null) this.projection = Mat4.orthographicProjection(0, this.canvas.width, this.canvas.height, 0, 0, 100);\r\n        else this.projection = Mat4.orthographicProjection(0, renderTarget.width, renderTarget.height, 0, 0, 100);\r\n\r\n        this.gl.enable(this.gl.BLEND);\r\n        this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n        this.gl.blendFuncSeparate(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA, this.gl.ONE, this.gl.ONE);\r\n        \r\n        this.shader.enable();\r\n        this.shader.setProjection(this.projection);\r\n    }\r\n\r\n    end() {\r\n        this.flushBatch();\r\n        this.processingRender = false;\r\n\r\n        // reset the renderstate so its fresh\r\n        this.renderState = [];\r\n        this.saveState(true);\r\n\r\n        //console.log(`Flushes: ${this.numFlushes}`);\r\n        this.numFlushes = 0;\r\n    }\r\n\r\n    darwRect(xPos: number, yPos: number, width: number, height: number, rot: number, xOrigin: number, yOrigin: number) {\r\n        \r\n        if(this.shouldFlush())\r\n            this.flushBatch();\r\n\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        const textureId = this.useTexture(state.texture ?? this.blankTexture);\r\n        const color = state.color ?? [Vec4.ONE, Vec4.ONE, Vec4.ONE, Vec4.ONE];\r\n        const uvRect = state.uvRect ?? new Rect(0, 0, 1, 1);\r\n\r\n        const transform = \r\n        Mat3.mul(Mat3.mul( Mat3.scale(width, height), \r\n                          Mat3.rotation(rot) ), \r\n                 Mat3.translation(xPos, yPos) );\r\n\r\n        // calculate the position for each of the quads\r\n        const tl: IVec3 = Mat3.transformPoint(transform, { x: (0 - xOrigin), y: (0 - yOrigin), z: 1 } );\r\n        const tr: IVec3 = Mat3.transformPoint(transform, { x: (1 - xOrigin), y: (0 - yOrigin), z: 1 } );\r\n        const br: IVec3 = Mat3.transformPoint(transform, { x: (1 - xOrigin), y: (1 - yOrigin), z: 1 } );\r\n        const bl: IVec3 = Mat3.transformPoint(transform, { x: (0 - xOrigin), y: (1 - yOrigin), z: 1 } );\r\n\r\n        // kinda hacky, for our shader, we are storing which texture we should use in the 'z' coordinate\r\n        // as 'z' is not used for 2d rendering\r\n        tl.z = textureId; tr.z = textureId; br.z = textureId; bl.z = textureId;\r\n\r\n        // build our verts\r\n        const i0 = this.spriteBuffer.setPos(tl).setColor(color[0]).setUV(uvRect.topLeft).saveVert();\r\n        const i1 = this.spriteBuffer.setPos(tr).setColor(color[1]).setUV(uvRect.topRight).saveVert();\r\n        const i2 = this.spriteBuffer.setPos(br).setColor(color[2]).setUV(uvRect.bottomRight).saveVert();\r\n        const i3 = this.spriteBuffer.setPos(bl).setColor(color[3]).setUV(uvRect.bottomLeft).saveVert();\r\n\r\n        // save the face\r\n        this.spriteBuffer.saveFace(i0, i1, i2).saveFace(i0, i2, i3);\r\n    }\r\n\r\n    drawLine(x1: number, y1: number, x2: number, y2: number, thickness: number, vertColors?: IVec4[]) {\r\n        this.drawLines([new Vec2(x1, y1), new Vec2(x2, y2)], thickness, vertColors);\r\n    }\r\n\r\n    drawLines(points: IVec2[], width: number, vertColors?: IVec4[]) {\r\n\r\n        if(this.shouldFlush())\r\n            this.flushBatch();\r\n\r\n        vertColors = vertColors ?? [];\r\n\r\n        this.saveState();\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        const textureId = this.useTexture(this.blankTexture);\r\n        const color = state.color[0] ?? Vec4.ONE;\r\n\r\n        const indices = [];\r\n\r\n        let iDir = Vec2.ZERO; \r\n        for(let i=0; i<points.length; i++) {\r\n\r\n            const p0 = points[i];\r\n            const p1 = points[i+1] ?? Vec2.add(p0, iDir);\r\n\r\n            const oDir = Vec2.sub(p1 ?? p0, p0).normalise();\r\n\r\n            const tangent = Vec2.add(iDir, oDir).normalise();\r\n            const mighter = Vec2.perpendicular(tangent);\r\n            const distance = width / mighter.dot(Vec2.perpendicular(oDir)) * 0.5;\r\n            const p = Vec2.mul(mighter, {x: distance, y: distance});\r\n\r\n            const col = vertColors[i] ?? color;\r\n\r\n            const i0 = this.spriteBuffer.setPos({x: p0.x + p.x, y: p0.y + p.y, z: textureId}).setColor(col).setUV({x: 0, y: 0}).saveVert();\r\n            const i1 = this.spriteBuffer.setPos({x: p0.x - p.x, y: p0.y - p.y, z: textureId}).setColor(col).setUV({x: 0, y: 0}).saveVert();\r\n            indices.push(i0);\r\n            indices.push(i1);\r\n\r\n            iDir = oDir;\r\n        }\r\n\r\n        for(let i=0; i<indices.length-2; i += 2) {\r\n            const index = indices[i];\r\n            this.spriteBuffer.saveFace(index, index+1, index+2);\r\n            this.spriteBuffer.saveFace(index+1, index+2, index+3);\r\n        }\r\n\r\n        this.popState();\r\n\r\n    }\r\n\r\n    drawCircle(xPos: number, yPos: number, radius: number, segments: number) {\r\n        if(this.shouldFlush())\r\n            this.flushBatch();\r\n\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        const textureId = this.useTexture(state.texture ?? this.blankTexture);\r\n        const color = state.color[0] ?? Vec4.ONE;\r\n        const uvRect = state.uvRect ?? new Rect(0, 0, 1, 1);\r\n\r\n        const i0 = this.spriteBuffer\r\n            .setPos({x: xPos, y: yPos, z: textureId})\r\n            .setColor(color)\r\n            .setUV({x: (uvRect.right - uvRect.left) * 0.5, y: (uvRect.bottom - uvRect.top) * 0.5})\r\n            .saveVert();\r\n            \r\n        for(let i=0; i<=segments;  i++) {\r\n            const r = ((2.0 * Math.PI) / segments) * i;\r\n            const x =  Math.sin(r);\r\n            const y = -Math.cos(r);\r\n            //this.darwRect(x, y, 5, 5, r, 0.5, 0.5);\r\n            this.spriteBuffer\r\n                .setPos({x: x * radius + xPos, y: y * radius + yPos, z: textureId})\r\n                .setColor(color)\r\n                .setUV({x: x * 0.5 + 0.5, y: y * 0.5 + 0.5})\r\n                .saveVert();\r\n        }\r\n\r\n        for(let i=0; i<=segments; i++) {\r\n           this.spriteBuffer.saveFace(i0, i0+i, i0+i+1);\r\n        }\r\n    }\r\n    \r\n    clear(r: number = 1, b: number = 1, g: number = 1, a: number = 1 ) {\r\n        this.gl.clearColor(r, g, b, a);\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n    }\r\n    setTexture(texture: ITexture2d) {\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        state.texture = texture;\r\n    }\r\n\r\n    setColor(color: IVec4) {\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        state.color[0] = color;\r\n        state.color[1] = color;\r\n        state.color[2] = color;\r\n        state.color[3] = color;\r\n    }\r\n\r\n    setColorPoints(tlc: IVec4, trc: IVec4, brc: IVec4, blc: IVec4) {\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        state.color[0] = tlc;\r\n        state.color[1] = trc;\r\n        state.color[2] = brc;\r\n        state.color[3] = blc;\r\n    }\r\n\r\n    setUvRect(uvRect: Rect) {\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        state.uvRect = uvRect;\r\n    }\r\n\r\n    setRenderMode(renderMode: RenderMode) {\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        if(state.renderMode != renderMode) {\r\n            this.flushBatch();\r\n            state.renderMode = renderMode;\r\n        }\r\n    }\r\n\r\n    saveState(setDefaults: boolean = false) {\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        const defaults = !setDefaults ? state : {\r\n            color: [Vec4.ONE, Vec4.ONE, Vec4.ONE, Vec4.ONE],\r\n            uvRect: new Rect(0, 0, 1, 1),\r\n            texture: this.blankTexture,\r\n            renderMode: RenderMode.FILL\r\n        };\r\n\r\n        this.renderState.push({...this.renderState[this.renderState.length-1], \r\n            ...defaults\r\n        });\r\n    }\r\n\r\n    popState() {\r\n        if(this.renderState.length <= 1 )\r\n            return;\r\n\r\n        // do we need to re-render based on state change?\r\n        const state = this.renderState[this.renderState.length - 1];\r\n        const newState = this.renderState[this.renderState.length - 2];\r\n\r\n        let flush = false;\r\n        flush = flush || state.renderMode != newState.renderMode;\r\n\r\n        if(flush)\r\n            this.flushBatch();\r\n\r\n        this.renderState.pop();\r\n    }\r\n\r\n    private useTexture(texture: ITexture2d) {\r\n        // check if the texture is already in use\r\n        // if so, return... we dont need to add it to our list of textures again.\r\n        for(let i=0; i<=this.currentTextureId; i++){\r\n            if(this.activeTextures[i] == texture)\r\n                return i;\r\n        }\r\n\r\n        // if we've used all the textures we can, then we need to flush to make room for another texture change\r\n        if( this.currentTextureId >= this.maxTextures )\r\n            this.flushBatch();\r\n\r\n        // store the texture in our active textuers array\r\n        this.activeTextures[this.currentTextureId] = texture;\r\n        \r\n        // send the texture to opengl\r\n        this.shader.setTexture(texture.handle, this.currentTextureId);\r\n\r\n        // increment our currentTextureId for next use.\r\n        this.currentTextureId += 1;\r\n\r\n        // return what the current texture was.\r\n        return this.currentTextureId - 1;\r\n    }\r\n\r\n    private flushBatch() {\r\n        if(this.spriteBuffer.currentIndicyIndex === 0 || this.spriteBuffer.currentVertIndex === 0 || this.processingRender === false)\r\n            return;\r\n\r\n        let renderMode = this.gl.TRIANGLES;\r\n        switch( this.renderState[this.renderState.length-1].renderMode ){\r\n            case RenderMode.FILL: renderMode = this.gl.TRIANGLES; break;\r\n            case RenderMode.WIREFRAME: renderMode = this.gl.LINE_STRIP; break;\r\n        }\r\n\r\n        // render the sprite buffer and reset for next flush\r\n        this.spriteBuffer.draw(renderMode);\r\n        this.spriteBuffer.clear();\r\n\r\n        // clear our active textures as well\r\n        for(let i=0; i<this.maxTextures; i++)\r\n            this.activeTextures[i] = null;\r\n\r\n        this.currentTextureId = 0;\r\n        this.numFlushes += 1;\r\n    }\r\n\r\n    private shouldFlush(): boolean {\r\n        const result =  this.spriteBuffer.currentVertIndex >= this.spriteBuffer.verts.length-1 || \r\n                        this.spriteBuffer.currentVertIndex >= this.spriteBuffer.indices.length-1;\r\n        return result;\r\n    }\r\n}","\r\nexport class Timer {\r\n    deltaTime: number = 0;\r\n    startTime: number = 0;\r\n    stopTime: number = 0;\r\n\r\n    start() {\r\n        this.stopTime = 0;\r\n        this.startTime = performance.now() / 1000;\r\n    }\r\n    stop() {\r\n        this.stopTime = performance.now() / 1000;\r\n        this.deltaTime = this.stopTime - this.startTime;\r\n    }\r\n}","\r\nimport { Timer } from './timer';\r\n\r\nexport class FrameTimer extends Timer\r\n{\r\n    framesPerSecond: number = 0;\r\n    \r\n    private frameCounter: number = 0;\r\n    private runningTime: number = 0;\r\n\r\n    constructor() {\r\n        super();\r\n     }\r\n\r\n    update() {\r\n        this.stop();\r\n        this.runningTime += this.deltaTime;\r\n        this.frameCounter += 1;\r\n\r\n        if(this.runningTime >= 1) {\r\n            this.framesPerSecond = this.frameCounter;\r\n            this.runningTime = 0;\r\n            this.frameCounter = 0;\r\n        }\r\n\r\n        this.start();\r\n    }\r\n}\r\n","\r\nimport { InputManager } from './input/inputManager';\r\nimport { Renderer2d } from './graphics/renderer2d';\r\nimport { FrameTimer } from './utils/frameTimer';\r\nimport { RenderTexture } from './graphics/renderTexture';\r\n\r\nexport class App\r\n{\r\n    canvas: HTMLCanvasElement;\r\n    input: InputManager;\r\n    time: FrameTimer;\r\n    renderer2d: Renderer2d;\r\n\r\n    gl: WebGL2RenderingContext;\r\n\r\n    constructor(htmlCanvasId: string) {\r\n        this.canvas = document.getElementById(htmlCanvasId) as HTMLCanvasElement;\r\n        this.resize();\r\n        this.input = new InputManager(this.canvas);\r\n        this.time = new FrameTimer();\r\n\r\n        this.gl = this.canvas.getContext(\"webgl2\", {\r\n            antialias: true\r\n        });\r\n\r\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\r\n\r\n        // create a fake render target reresenting the canvas\r\n        const canvasRenderTarget = new RenderTexture(this.gl);\r\n        canvasRenderTarget.width = this.canvas.width;\r\n        canvasRenderTarget.height = this.canvas.height;\r\n        canvasRenderTarget.enable();\r\n\r\n        this.renderer2d = new Renderer2d(this.canvas, this.gl);\r\n    }\r\n\r\n    destroy() {\r\n        this.input.destroy();\r\n        this.input = null;\r\n    }\r\n\r\n    async loadAssets() {\r\n        // derrived classes will implement load asset logic.\r\n    }\r\n\r\n    async launch() {\r\n        await this.loadAssets();\r\n        this.run();\r\n    }\r\n\r\n    update() {\r\n    }\r\n\r\n    draw() {\r\n        this.gl.clearColor(0.0, 0.0, 0.0, 0.0); // black\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT)\r\n    }\r\n\r\n    run() {\r\n        this.time.update();\r\n        this.update();\r\n        this.draw();\r\n\r\n        this.input.keyboard.update();\r\n        this.input.mouse.update();\r\n        \r\n        requestAnimationFrame(() => {\r\n             this.run();\r\n        });\r\n    }\r\n\r\n    private resize() {\r\n        // Lookup the size the browser is displaying the canvas.\r\n        var displayWidth  = this.canvas.clientWidth;\r\n        var displayHeight = this.canvas.clientHeight;\r\n    \r\n        // Check if the canvas is not the same size.\r\n        if (this.canvas.width  !== displayWidth ||\r\n            this.canvas.height !== displayHeight) {\r\n    \r\n          // Make the canvas the same size\r\n          this.canvas.width  = displayWidth;\r\n          this.canvas.height = displayHeight;\r\n        }\r\n      }\r\n}","import { Rect } from \"../../engine/math\";\r\n\r\nexport interface ILevelData {\r\n    tileSize: number;\r\n    rows: number;\r\n    cols: number;\r\n    map: Array<Array<string>>;\r\n    startTile: [number, number];\r\n    zones: Rect[];\r\n}\r\n\r\nexport const levels: ILevelData[] = [\r\n    {\r\n        tileSize: 55,\r\n        rows: 8,\r\n        cols: 8,\r\n        startTile: [6, 4],\r\n        map:  [\r\n            [`0000`, `0000`, `0000`, `1424`, `0000`, `0000`, `0000`, `0000`],\r\n            [`0000`, `0000`, `0000`, `0000`, `0000`, `0000`, `0000`, `0000`],\r\n            [`0000`, `0000`, `0001`, `0001`, `0001`, `0001`, `0000`, `0000`],\r\n            [`1325`, `0000`, `0001`, `0001`, `0001`, `0001`, `0000`, `0000`],\r\n            [`0000`, `0000`, `0001`, `0001`, `0001`, `0001`, `0001`, `0000`],\r\n            [`0000`, `0000`, `0001`, `0001`, `0001`, `0103`, `0000`, `0000`],\r\n            [`0000`, `0000`, `0000`, `0000`, `0000`, `0000`, `0000`, `0000`],\r\n            [`0000`, `0000`, `0000`, `0000`, `0000`, `0000`, `0000`, `0000`]\r\n        ],\r\n        zones: [\r\n            new Rect(2, 2, 4, 4)\r\n        ]\r\n    }\r\n]","import { App } from \"../../engine/app\";\r\nimport { Vec4, Vec2, Rect, Mat3, Shape, Vec3, Ray, IVec2, RayHit } from \"../../engine/math\";\r\nimport { levels, ILevelData } from './levels';\r\n\r\n// import assets\r\nimport tileBasePng from './assets/tile-base.png';\r\n\r\nimport { Texture2D } from \"../../engine/graphics/texture\";\r\nimport { Renderer2d } from \"../../engine/graphics/renderer2d\";\r\n\r\nconst lightColors: {[key: number]: Vec4} = {\r\n    1: new Vec4(255/255, 255/255, 255/255, 1),  // white ff8a80\r\n    2: new Vec4(255/255, 138/255, 128/255, 1),  // red ff8a80\r\n    3: new Vec4(43/255, 187/255, 173/255, 1),   // green 2bbbad\r\n    4: new Vec4(179/255, 136/255, 255/255, 1),  // purple b388ff\r\n    5: new Vec4(149/255, 158/255, 255/255, 1),  // light blue 8c9eff\r\n    6: new Vec4(63/255, 114/255, 155/255, 1),   // dark blue 3f729b\r\n}\r\n\r\nenum TILE_DIR {\r\n    NONE = 0,\r\n    LEFT = 1,\r\n    UP = 2,\r\n    RIGHT = 3,\r\n    DOWN = 4\r\n}\r\n\r\nenum TILE_SHAPE {\r\n    NONE = 0, \r\n    EMPTY,\r\n    SOLID,\r\n    CORNER,\r\n    EMITTER,\r\n    RECEIVER,\r\n}\r\n\r\n\r\nclass GameObject\r\n{\r\n    parent: GameObject = null\r\n    children: GameObject[] = [];\r\n\r\n    transform: Mat3 = Mat3.identity();\r\n\r\n    get globalTransform(): Mat3 {\r\n        const transform = this.parent ? \r\n            Mat3.mul(this.transform, this.parent.globalTransform) :    \r\n            this.transform;\r\n        return transform;\r\n    }\r\n\r\n    private lastTrasform: Mat3 = null;\r\n    private _isDirty: boolean = false;\r\n    private _dirtyCheck: boolean = false;\r\n    get isDirty() { return this._isDirty; }\r\n\r\n    constructor(parent: GameObject = null) {\r\n        this.setParent(parent);\r\n    }\r\n\r\n    update(dt: number) {\r\n        if(this._dirtyCheck) {\r\n            this._isDirty = this.lastTrasform?.equal(this.transform) == false;\r\n            this.lastTrasform = this.transform.copy();\r\n        }\r\n     }\r\n    draw(renderer2d: Renderer2d) { }\r\n\r\n    setParent(newParent: GameObject) {\r\n        this.parent?.removeChild(this);\r\n        this.parent = newParent;\r\n        this.parent?.addChild(this);\r\n    }\r\n\r\n    checkForChangesPerFrame(doCheck: boolean) {\r\n        this._dirtyCheck = doCheck;\r\n        this._isDirty = true;\r\n    }\r\n\r\n    private removeChild(child: GameObject) {\r\n        const index = this.children.indexOf(child);\r\n        if (index >= 0 ) this.children.splice(index, 1);\r\n    }\r\n\r\n    private addChild(child: GameObject) {\r\n        const index = this.children.indexOf(child);\r\n        if (index < 0) this.children.push(child);\r\n    }\r\n}\r\n\r\nclass Level extends GameObject {\r\n    \r\n    data: ILevelData;\r\n    tileTextures: {[key: number]: Texture2D} = {};\r\n    tiles: Tile[] = [];\r\n\r\n    activeTile: Tile;\r\n    movingTiles: Set<Tile> = new Set();\r\n\r\n    constructor(data: ILevelData) {\r\n        super();\r\n        this.data = data;\r\n    }\r\n\r\n    posToIndex(pos: Vec2): Vec2 {\r\n        const x = Math.floor(pos.x / this.data.tileSize);\r\n        const y = Math.floor(pos.y / this.data.tileSize);\r\n        return new Vec2(x, y);\r\n    }\r\n\r\n    indexToPos(index: Vec2): Vec2 {\r\n        const hs = this.data.tileSize * 0.5;\r\n        const x = Math.floor(index.x * this.data.tileSize + hs);\r\n        const y = Math.floor(index.y * this.data.tileSize + hs);\r\n        return new Vec2(x, y);\r\n    }\r\n\r\n    inZone(index: Vec2): Rect {\r\n        for(const zone of this.data.zones) {\r\n            if(zone.contains(index))\r\n                return zone;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    findTileAtIndex(index: Vec2): Tile {\r\n        for(const t of this.tiles) {\r\n            const ti = this.posToIndex(t.transform.pos);\r\n            if(ti.x === index.x && ti.y==index.y)\r\n                return t;\r\n        }\r\n    }\r\n\r\n    update(dt: number) {\r\n        super.update(dt);\r\n    }\r\n\r\n    draw() {\r\n\r\n    }\r\n\r\n}\r\n\r\nclass Tile extends GameObject {\r\n\r\n    level: Level;\r\n    lightId: TILE_SHAPE;\r\n    shapeId: number;\r\n    dirId: number;\r\n    colorId: number;\r\n\r\n    size: Vec2;\r\n    shapeGeometry: Shape = null;\r\n\r\n    onMoveFinished: (tile: Tile) => void;\r\n    isMovingToTarget: boolean = false;\r\n    targetPos: Vec2;\r\n\r\n    static tileGeometries: Shape[] = [];\r\n\r\n    constructor(level: Level, lightId: number, shapeId: TILE_SHAPE, dirId: TILE_DIR, colorId: number) {\r\n        super(level);\r\n        this.level = level;\r\n        this.lightId = lightId;\r\n        this.shapeId = shapeId;\r\n        this.dirId = dirId;\r\n        this.colorId = colorId;\r\n    }\r\n\r\n    update(dt: number) {\r\n        super.update(dt);\r\n        this.moveToTargetPos(dt);\r\n\r\n        this.updateShapeGeometry();\r\n    }\r\n\r\n    draw(renderer: Renderer2d) {}\r\n\r\n    drawShapeGeometry(renderer: Renderer2d) {\r\n        if(this.shapeGeometry) {\r\n            renderer.setColor(new Vec4(1, 1, 1, 1));\r\n            renderer.drawLines(this.shapeGeometry.points, 2);\r\n        }\r\n    }\r\n\r\n    updateShapeGeometry() {\r\n        if(this.shapeGeometry) {\r\n            const gt = this.globalTransform;\r\n            const updatedShape = Tile.createTileShape(this.shapeId, gt.pos.x, gt.pos.y, \r\n                this.level.data.tileSize * 0.6, \r\n                this.level.data.tileSize * 0.6, Tile.tileRotation(this.dirId));\r\n\r\n            this.shapeGeometry.points = updatedShape.points;\r\n        }\r\n    }\r\n\r\n    private moveToTargetPos(dt: number) {\r\n        if(this.isMovingToTarget === false)\r\n            return;\r\n\r\n        const size = this.level.data.tileSize;\r\n            \r\n        const speed = 6;\r\n        const moveDir = Vec2.sub(this.targetPos, this.transform.pos).normalise();\r\n        this.transform.move(moveDir.x * dt * size * speed, moveDir.y * dt * size * speed);\r\n\r\n        // snap the position to target when its close enough.\r\n        if(Math.abs(this.transform.pos.x - this.targetPos.x) < 4 )\r\n            this.transform.setPosX(this.targetPos.x);\r\n\r\n        if(Math.abs(this.transform.pos.y - this.targetPos.y) < 4 )\r\n            this.transform.setPosY(this.targetPos.y);\r\n\r\n        // check if we are at the target position\r\n        if(this.transform.pos.x == this.targetPos.x && this.transform.pos.y == this.targetPos.y){\r\n            this.isMovingToTarget = false;\r\n            if(this.onMoveFinished)\r\n                this.onMoveFinished(this);\r\n        }\r\n    }\r\n\r\n    move(dir: Vec2) {\r\n        const index = this.level.posToIndex(this.transform.pos).add(dir);\r\n        this.targetPos = this.level.indexToPos(index);\r\n        this,this.isMovingToTarget = true;\r\n    }\r\n\r\n    moveWith(dir: Vec2, withIndex: Vec2): boolean {\r\n        const index = this.level.posToIndex(this.transform.pos);\r\n\r\n        if((index.y == withIndex.y && dir.x !== 0) || (index.x == withIndex.x && dir.y !== 0)) {\r\n            this.move(dir);\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    static tileRotation(shape: TILE_DIR): number {\r\n        switch(shape) {\r\n            case TILE_DIR.RIGHT: return 0;\r\n            case TILE_DIR.DOWN: return Math.PI / 2; // 90 deg cw\r\n            case TILE_DIR.LEFT: return Math.PI; // 180 deg cw\r\n            case TILE_DIR.UP: return Math.PI + Math.PI / 2; // 270 deg cw\r\n            default: return 0;\r\n        }\r\n    }\r\n\r\n    static createTileShape(shape: TILE_SHAPE, xPos: number, yPos: number, width: number, height: number, rot: number): Shape {\r\n        switch(shape) {\r\n            case TILE_SHAPE.SOLID:\r\n                return Shape.makeBox(xPos, yPos, width, height, rot, false);\r\n            case TILE_SHAPE.EMITTER: \r\n            case TILE_SHAPE.RECEIVER:\r\n                return Shape.makeBox(xPos, yPos, width, height, rot, true)\r\n            case TILE_SHAPE.CORNER: \r\n                return Shape.makeAngleTriangle(xPos, yPos, width, height, rot);\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n}\r\n\r\nclass BlockTile extends Tile {\r\n    constructor(level: Level, lightId: number, shapeId: TILE_SHAPE, dirId: TILE_DIR, colorId: number) {\r\n        super(level, lightId, shapeId, dirId, colorId);\r\n\r\n        const rot = Tile.tileRotation(dirId);\r\n        this.shapeGeometry = Tile.createTileShape(this.shapeId, this.transform.pos.x, this.transform.pos.y, this.level.data.tileSize, this.level.data.tileSize, rot );\r\n\r\n        if(this.shapeGeometry?.points.length > 0) {\r\n            this.checkForChangesPerFrame(true);\r\n            Tile.tileGeometries.push(this.shapeGeometry);\r\n        }\r\n    }\r\n\r\n    draw(renderer: Renderer2d) {\r\n        const gt = this.globalTransform;\r\n        const pos = gt.pos;\r\n        const scale = gt.scale;\r\n\r\n        const tsx = this.level.data.tileSize * scale.x;\r\n        const tsy = this.level.data.tileSize * scale.y;\r\n\r\n        // what about if the global transform has rotated... add rotation?\r\n        const rot = Tile.tileRotation(this.dirId); \r\n\r\n        renderer.setColor(new Vec4(1,1,1,0.5));\r\n        renderer.setTexture(this.level.tileTextures[1]);\r\n        renderer.darwRect(pos.x, pos.y, tsx, tsy, rot, 0.5, 0.5 );\r\n\r\n        this.drawShapeGeometry(renderer);\r\n    }\r\n}\r\n\r\nclass EmitterTile extends Tile {\r\n\r\n    lightRays: Ray[] = [];\r\n    allLightRays: Ray[] = [];\r\n\r\n    get color() { return lightColors[this.colorId] ?? new Vec4(1,1,1,1); }\r\n\r\n    constructor(level: Level, lightId: number, shapeId: TILE_SHAPE, dirId: TILE_DIR, colorId: number) {\r\n        super(level,lightId, shapeId, dirId, colorId);\r\n\r\n        const rot = Tile.tileRotation(this.dirId);\r\n        this.shapeGeometry = Tile.createTileShape(this.shapeId, this.transform.pos.x, this.transform.pos.y, this.level.data.tileSize, this.level.data.tileSize, rot);\r\n\r\n        if(this.shapeGeometry?.points.length > 0) {\r\n            this.checkForChangesPerFrame(true);\r\n            Tile.tileGeometries.push(this.shapeGeometry);\r\n        }\r\n    }\r\n\r\n    update(dt: number) {\r\n        super.update(dt);\r\n    }\r\n\r\n    updateLights(dt: number) {\r\n        const gt = this.globalTransform;\r\n        const rayDir = this.dirToVec(this.dirId);\r\n        const rayOffset = Vec2.negate(rayDir).scale(6);\r\n        gt.move(rayOffset.x, rayOffset.y)\r\n        \r\n        if(this.shapeId == TILE_SHAPE.EMITTER) {\r\n            this.lightRays = this.makeRayLine(gt.pos, rayDir, 4, 3);\r\n            this.allLightRays = [];\r\n    \r\n            for(let i=0; i<this.lightRays.length; i++) {\r\n                const r = this.lightRays[i];\r\n                r.castToShapes(Tile.tileGeometries, 10);\r\n                this.allLightRays.push(...r.rays());\r\n            }\r\n        }\r\n    }\r\n\r\n    draw(renderer: Renderer2d) {\r\n        super.draw(renderer);\r\n\r\n        const gt = this.globalTransform;\r\n        const pos = gt.pos;\r\n        const scale = gt.scale;\r\n        const tsx = this.level.data.tileSize * scale.x;\r\n        const tsy = this.level.data.tileSize * scale.y;\r\n\r\n        renderer.saveState(true);\r\n\r\n        const color = new Vec4(this.color.x, this.color.y, this.color.z, 1);\r\n\r\n        renderer.setColor(color);\r\n        renderer.darwRect(pos.x, pos.y, tsx/2, tsy/2, 0, 0.5, 0.5);\r\n\r\n        this.drawLight(renderer);\r\n\r\n        renderer.setColor(new Vec4(0,0,0,1));\r\n        this.drawShapeGeometry(renderer);\r\n\r\n        renderer.popState();\r\n    }\r\n\r\n    drawLight(renderer: Renderer2d) {\r\n\r\n        const color = new Vec4(this.color.x, this.color.y, this.color.z, 0.5);\r\n        renderer.saveState();\r\n        renderer.setColor(color);\r\n        \r\n        for(const r of this.allLightRays) {\r\n            const d = Math.min(r.hit?.distance ?? 2000);\r\n            const p0 = r.pos;\r\n            const p1 = Vec2.mul(r.dir, {x: d, y:d}).add(r.pos);\r\n            \r\n            renderer.drawLine(p0.x, p0.y, p1.x, p1.y, 3);\r\n\r\n            // renderer.darwRect(tp0.x, tp0.y, 10, 10, 0, 0.5, 0.5);\r\n        }\r\n\r\n        renderer.popState();\r\n    }\r\n    \r\n    dirToVec(dir: TILE_DIR) {\r\n        switch(dir) {\r\n            case TILE_DIR.LEFT: return new Vec2(-1, 0);\r\n            case TILE_DIR.UP: return new Vec2(0, -1);\r\n            case TILE_DIR.RIGHT: return new Vec2(1, 0);\r\n            case TILE_DIR.DOWN: return new Vec2(0, 1);\r\n            default: return new Vec2(0, 0);\r\n        }\r\n    }\r\n\r\n    makeRayLine(pos: IVec2, dir: IVec2, count: number, spacing: number): Ray[] {\r\n        const rays: Ray[] = [];\r\n        const pDir = Vec2.perpendicular(dir);\r\n\r\n        const min = Math.ceil(count/2);\r\n        const max = Math.ceil(count/2);\r\n        for(let i=-min; i<=max; i++) {\r\n            rays.push( new Ray(Vec2.add(pos, Vec2.scale(pDir, i*spacing)), dir) )\r\n        }\r\n        return rays;\r\n    }\r\n}\r\n\r\nexport class LightBender extends App {\r\n\r\n    currentLevelIndex: number = 0;\r\n    currentLevel: Level;\r\n\r\n    tileTextures: {[key: number]: Texture2D} = {};\r\n\r\n    world: GameObject;\r\n\r\n    elapsedTime: number = 0;\r\n    \r\n    constructor(htmlCanvasId: string) {\r\n        super(htmlCanvasId);\r\n\r\n        this.world = new GameObject(null);\r\n        this.world.transform.setPos(this.canvas.width / 2, this.canvas.height / 2);\r\n\r\n        this.currentLevel = new Level(levels[this.currentLevelIndex]);\r\n        this.currentLevel.tileTextures = this.tileTextures;\r\n        this.currentLevel.setParent(this.world);\r\n\r\n        this.loadLevel();\r\n\r\n        console.log(`hw: ${this.canvas.width / 2}`);\r\n        console.log(`hh: ${this.canvas.height / 2}`);\r\n        console.log(this.world.globalTransform.pos);\r\n        console.log(this.currentLevel.globalTransform.pos);\r\n    }\r\n\r\n    async loadAssets(): Promise<void> {\r\n        await super.loadAssets();\r\n\r\n        this.tileTextures[0] = null;\r\n        \r\n        this.tileTextures[TILE_SHAPE.EMPTY] = new Texture2D(this.gl);\r\n        this.tileTextures[TILE_SHAPE.EMPTY].load(tileBasePng);\r\n    }\r\n    \r\n    update() {\r\n        super.update();\r\n        const kb = this.input.keyboard;\r\n        const inputDir = new Vec2(0, 0);\r\n\r\n        this.elapsedTime += this.time.deltaTime;\r\n\r\n        if(kb.wasKeyPressed(38)) inputDir.y = -1;       // up arrow\r\n        else if(kb.wasKeyPressed(40)) inputDir.y =  1;  // down arrow\r\n        else if(kb.wasKeyPressed(37)) inputDir.x = -1;  // left arrow\r\n        else if(kb.wasKeyPressed(39)) inputDir.x =  1;  // right arrow\r\n            \r\n        if( inputDir.x !== 0 || inputDir.y !== 0) {\r\n            this.moveActiveTile(inputDir);\r\n        }\r\n\r\n        // update movement of all tiles\r\n        for(const t of this.currentLevel.tiles) {\r\n            t.update(this.time.deltaTime);\r\n        }\r\n\r\n        // update the lights\r\n        for(const t of this.currentLevel.tiles) {\r\n            if(t instanceof EmitterTile)\r\n                t.updateLights(this.time.deltaTime);\r\n        }\r\n    }\r\n\r\n    draw() {\r\n        super.draw();\r\n        this.gl.clearColor(0, 0, 0, 0);\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n\r\n        this.renderer2d.begin();\r\n        this.drawBackgroundGrid();\r\n        this.drawTiles();\r\n        this.renderer2d.end();\r\n    }\r\n\r\n    drawBackgroundGrid() {\r\n\r\n        const gt = this.currentLevel.globalTransform;\r\n        const pos = gt.pos;\r\n        const scale = gt.scale;\r\n\r\n        const tsx = this.currentLevel.data.tileSize * scale.x;\r\n        const tsy = this.currentLevel.data.tileSize * scale.y;\r\n\r\n        const minX = 0;\r\n        const minY = 0;\r\n        const maxX = this.currentLevel.data.cols;\r\n        const maxY = this.currentLevel.data.rows;\r\n\r\n        this.renderer2d.saveState(true);\r\n\r\n        // draw background:\r\n        const oc = new Vec4(255/255, 255/255, 255/255, 0.2);\r\n        const colors = [new Vec4(oc.x, oc.y, oc.z, 0), new Vec4(oc.x, oc.y, oc.z, oc.w), new Vec4(oc.x, oc.y, oc.z, oc.w), new Vec4(oc.x, oc.y, oc.z, 0)];\r\n\r\n        // vertical lines\r\n        for(let i=minX+2; i<=maxX-2; i++) {\r\n            const points = [\r\n                new Vec2(pos.x + (i*tsx), pos.y + ((minY + 0) * tsy)),\r\n                new Vec2(pos.x + (i*tsx), pos.y + ((minY + 2) * tsy)), \r\n                new Vec2(pos.x + (i*tsx), pos.y + ((maxY - 2) * tsy)),\r\n                new Vec2(pos.x + (i*tsx), pos.y + ((maxY - 0) * tsy))\r\n            ];\r\n            this.renderer2d.drawLines(points, 1, colors);\r\n        }\r\n\r\n        // horizontal\r\n        for(let i=minY+2; i<=maxY-2; i++) {\r\n            const points = [\r\n                new Vec2(pos.x + ((minX + 0) * tsx),  pos.y + (i*tsy)),\r\n                new Vec2(pos.x + ((minX + 2) * tsx),  pos.y + (i*tsy)),\r\n                new Vec2(pos.x + ((maxX - 2) * tsx),  pos.y + (i*tsy)),\r\n                new Vec2(pos.x + ((maxX - 0) * tsx),  pos.y + (i*tsy))\r\n            ];\r\n            this.renderer2d.drawLines(points, 1, colors);\r\n        }\r\n\r\n        this.renderer2d.popState();\r\n    }\r\n\r\n\r\n    drawTiles() {\r\n\r\n        this.renderer2d.saveState(true);\r\n\r\n        for(let i=0; i<this.currentLevel.tiles.length; i++) {\r\n            const tile = this.currentLevel.tiles[i];\r\n            tile.draw(this.renderer2d);\r\n        }\r\n\r\n        this.renderer2d.popState();\r\n    }\r\n\r\n\r\n    moveActiveTile(dir: Vec2) {\r\n\r\n        if( this.currentLevel.movingTiles.size > 0 || this.currentLevel.activeTile === null )\r\n            return;\r\n\r\n        \r\n        const activeTileIndex = this.currentLevel.posToIndex(this.currentLevel.activeTile.transform.pos);\r\n        const targetTileIndex = Vec2.add(activeTileIndex, dir);\r\n        const zone = this.currentLevel.inZone(targetTileIndex);\r\n\r\n        const moveTileFinishedFunc = (tile: Tile) => {\r\n            this.currentLevel.movingTiles.delete(tile);\r\n            tile.onMoveFinished = null;\r\n            const index = this.currentLevel.posToIndex(tile.transform.pos);\r\n            if(!zone?.contains(index)) {\r\n                this.currentLevel.activeTile = tile;\r\n            }\r\n        }\r\n\r\n        this.currentLevel.activeTile.move(dir);\r\n        this.currentLevel.activeTile.onMoveFinished = moveTileFinishedFunc;\r\n\r\n        this.currentLevel.activeTile = null;\r\n\r\n        if(zone === null)\r\n            return;\r\n\r\n        for(const t of this.currentLevel.tiles) {\r\n            const ti = this.currentLevel.posToIndex(t.transform.pos);\r\n            if(zone.contains(ti) && t.moveWith(dir, activeTileIndex) ) {\r\n                this.currentLevel.movingTiles.add(t);\r\n                t.onMoveFinished = moveTileFinishedFunc;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    loadLevel() {\r\n\r\n        \r\n        const level = this.currentLevel;\r\n        // const layout = level.data.layout;\r\n        // const lights = level.data.lights;\r\n        const map = level.data.map;\r\n\r\n        const shapeIndex = 3;\r\n        const colorIndex = 2;\r\n        const dirIndex = 1;\r\n        const lightIndex = 0;\r\n\r\n\r\n        const tileSize = level.data.tileSize;\r\n        const levelWidth = tileSize * level.data.rows;\r\n        const levelHeight = tileSize * level.data.cols;\r\n\r\n        // move the level position back\r\n        // so that it is positioned in the scenter of the..\r\n        // might need need to adjust this if we plan on preforming level rotations.\r\n        level.transform.move(-levelWidth/2, -levelHeight/2);\r\n\r\n        const cols = level.data.cols; \r\n        const rows = level.data.rows;\r\n\r\n        for(let yi = 0; yi<rows; yi++) {\r\n            for(let xi = 0; xi<cols; xi++) {\r\n\r\n\r\n                \r\n                let lightId = parseInt(map[yi][xi][lightIndex]);\r\n                let dirId = parseInt(map[yi][xi][dirIndex]);\r\n                let colorId = parseInt(map[yi][xi][colorIndex]);\r\n                const shapeId = parseInt(map[yi][xi][shapeIndex]);\r\n\r\n                console.log(lightId, dirId, colorId, shapeId);\r\n\r\n                const tile = this.createTile(level, xi, yi, lightId, shapeId, dirId, colorId);\r\n                if(tile) {\r\n                    level.tiles.push(tile);\r\n                }\r\n                \r\n                if( level.data.startTile[0] == xi && level.data.startTile[1] == yi)\r\n                    level.activeTile = tile;\r\n\r\n            }\r\n\r\n        }\r\n        \r\n    }\r\n\r\n    private createTile(level: Level, xIndex: number, yIndex: number, lightId: number, shapeId: TILE_SHAPE, dirId: TILE_DIR, colorId: number) {\r\n        \r\n\r\n        const tileSize = level.data.tileSize;\r\n        const hTileSize = tileSize / 2;\r\n\r\n        let tile = null;\r\n\r\n        switch(shapeId) {\r\n            case TILE_SHAPE.NONE:\r\n                return;\r\n            case TILE_SHAPE.EMPTY: \r\n            case TILE_SHAPE.CORNER:\r\n            case TILE_SHAPE.SOLID:\r\n                tile = new BlockTile(level, lightId, shapeId, dirId, colorId); break;\r\n            case TILE_SHAPE.RECEIVER:\r\n            case TILE_SHAPE.EMITTER:\r\n                tile = new EmitterTile(level, lightId, shapeId, dirId, colorId); break;\r\n            default:\r\n                    return;\r\n        }\r\n\r\n        const tilePos = new Vec2(xIndex * tileSize + hTileSize, yIndex * tileSize + hTileSize);\r\n        tile.transform.setPos(tilePos.x, tilePos.y);     \r\n\r\n        return tile;\r\n    }\r\n\r\n}\r\n","\r\n\r\nimport { App } from \"../../engine/app\";\r\nimport { Vec2, IVec2, Shape, Ray, RayHit } from \"../../engine/math\";\r\n\r\n\r\n\r\nexport class RayCastingDemo extends App {\r\n\r\n    polygons: Shape[] = [];\r\n    \r\n    rays: Ray[] = [];\r\n    rayHits: RayHit[] = [];\r\n\r\n    allRays: Array<Ray> = [];\r\n\r\n    elapsedTime: number = 0;\r\n\r\n    constructor(htmlCanvasId: string) {\r\n        super(htmlCanvasId);\r\n    }\r\n\r\n    async loadAssets(): Promise<void> {\r\n        await super.loadAssets();\r\n\r\n        const ww = this.canvas.width;\r\n        const wh = this.canvas.height;\r\n        const aw = ww/1.5;\r\n        const ah = wh/1.5;\r\n        const as = Math.min(aw, ah);\r\n        const left = ww/2 - as/2;\r\n        const right = ww/2 + as/2;\r\n        const top =  wh/2 - as/2;\r\n        const bottom = wh/2 + as/2;\r\n\r\n        this.polygons.push( Shape.makeCircle(ww/2 - as/4, wh/2, as/10,4));\r\n        this.polygons.push( Shape.makeCircle(ww/2 + as/4, wh/2, as/10,4));\r\n        this.polygons.push( Shape.makeCircle(ww/2, wh/2 - as/4, as/10,4));\r\n        this.polygons.push( Shape.makeCircle(ww/2, wh/2 + as/4, as/10,4));\r\n        // this.polygons.push( Shape.makeCircle(right, 300, 50,4));\r\n        // this.polygons.push( Shape.makeCircle(300, 500, 50,4));\r\n        // this.polygons.push( Shape.makeCircle(400, 400, 50,4));\r\n\r\n        this.polygons.push( Shape.makeBox(this.canvas.width/2, this.canvas.height/2, right-left, bottom-top, 0));\r\n        this.polygons.push( Shape.makeBox(this.canvas.width/2, this.canvas.height/2,ww, wh, 0));\r\n\r\n        // this.polygons.push( Shape.makeLine(200, 100, 200, 400));\r\n        // this.polygons.push( Shape.makeLine(500, 400, 500, 100));\r\n        //this.polygons.push( Shape.makeLine(100, 300, 400, 300));\r\n        //this.polygons.push( Shape.makeLine(400, 300, 100, 300));\r\n\r\n        this.rays = [] // this.makeRayFan(100, 100, 64);\r\n\r\n\r\n        // this.rays.push(new Ray(new Vec2(0, 0), new Vec2(0.707,-0.707)  ));\r\n        // this.rays.push(new Ray(new Vec2(0, 0), new Vec2(0, 1)  ));\r\n        // this.rays.push(new Ray(new Vec2(0, 0), new Vec2(0, 1)  ));\r\n        // this.rays.push(new Ray(new Vec2(0, 0), new Vec2(0, 1)  ));\r\n        // this.rays.push(new Ray(new Vec2(0, 0), new Vec2(0, 1)  ));\r\n        // this.rays.push(new Ray(new Vec2(0, 0), new Vec2(0, 1)  ));\r\n        // this.rays.push(new Ray(new Vec2(0, 0), new Vec2(0, 1)  ));\r\n\r\n    }\r\n    \r\n    update() {\r\n        super.update();\r\n        this.elapsedTime += this.time.deltaTime;\r\n\r\n        // this.updateRayPositions(this.input.mouse.pos.x, this.input.mouse.pos.y);\r\n        // this.rays = this.makeRayFan(this.input.mouse.pos.x, this.input.mouse.pos.y, 64);\r\n        // this.rays = this.makeRaysToShapes(this.input.mouse.pos.x, this.input.mouse.pos.y, this.polygons);\r\n\r\n        const s = this.elapsedTime * 0.25;\r\n        this.rays = this.makeRayLine(this.input.mouse.pos, new Vec2(Math.cos(s), Math.sin(s)), 10, 3);\r\n        // this.rays = this.makeRaysToShapes(this.input.mouse.pos.x, this.input.mouse.pos.y, this.polygons);\r\n        // this.rays = this.makeRayFan(this.input.mouse.pos.x, this.input.mouse.pos.y, 64);\r\n\r\n        this.rayHits = [];\r\n        this.allRays = [];\r\n\r\n        for(let i=0; i<this.rays.length; i++) {\r\n            const r = this.rays[i];\r\n            r.castToShapes(this.polygons, 5);\r\n            this.rayHits.push(...r.hits());\r\n            this.allRays.push(...r.rays());\r\n        }\r\n    }\r\n\r\n    draw() {\r\n        super.draw();\r\n        this.renderer2d.begin();\r\n       \r\n        for(const p of this.polygons)\r\n            this.drawShape(p);\r\n\r\n        this.drawRays(this.allRays);\r\n\r\n        this.renderer2d.end();\r\n    }\r\n\r\n    drawShape(polygon: Shape) {\r\n        this.renderer2d.saveState();\r\n        this.renderer2d.drawLines(polygon.points, 1);\r\n        this.renderer2d.popState();\r\n    }\r\n\r\n\r\n\r\n    updateRayPositions(xPos: number, yPos: number) {\r\n        for(let i=0; i<this.rays.length; i++) {\r\n            const r = this.rays[i];\r\n\r\n            r.pos.x = xPos;\r\n            r.pos.y = yPos;\r\n        }\r\n    }\r\n\r\n    drawRays(rays: Ray[]) {\r\n        for(const r of rays) {\r\n            const p0 = r.pos;\r\n            \r\n            //this.renderer2d.drawCircle(p0.x, p0.y, 3, 4);\r\n\r\n            const d = Math.min(r.hit?.distance ?? 2000);\r\n            \r\n            const p1 = Vec2.mul(r.dir, {x: d, y:d}).add(r.pos);\r\n            this.renderer2d.drawLine(p0.x, p0.y, p1.x, p1.y, 1);\r\n        }\r\n    }\r\n\r\n    drawRayHits(rayHits: RayHit[]) {\r\n        for(const h of rayHits) {\r\n            this.renderer2d.drawLine(h.incomingRay.pos.x, h.incomingRay.pos.y, h.point.x, h.point.y, 1);\r\n        }\r\n    }\r\n\r\n\r\n    makeRayFan(xPos: number, yPos: number, numRays: number): Ray[] {\r\n        const rays: Ray[] = [];\r\n        for(let i=0; i<numRays;  i++) {\r\n            const r = ((2.0 * Math.PI) / numRays) * i;\r\n            rays.push(new Ray(\r\n                new Vec2(xPos, yPos), \r\n                new Vec2(Math.sin(r), -Math.cos(r))\r\n            ));\r\n        }\r\n\r\n        return rays;\r\n    }\r\n\r\n    makeRaysToShapes(xPos: number, yPos: number, shapes: Shape[]) {\r\n        const pos = new Vec2(xPos, yPos);\r\n        const rays: Ray[] = [];\r\n        for(const shape of shapes) {\r\n            for(const p of shape.points) {\r\n                rays.push(new Ray(pos, Vec2.sub(p, pos).normalise()) );\r\n            }\r\n        }\r\n\r\n        return rays;\r\n    }\r\n\r\n    makeRayLine(pos: IVec2, dir: IVec2, count: number, spacing: number) {\r\n        const rays: Ray[] = [];\r\n        const pDir = Vec2.perpendicular(dir);\r\n\r\n        const min = -Math.floor(count / 2);\r\n        const max = Math.ceil(count / 2);\r\n        for(let i=min; i<max; i++) {\r\n            rays.push(\r\n                new Ray(Vec2.add(pos, Vec2.scale(pDir, i*spacing)), dir)\r\n            )\r\n        }\r\n        return rays;\r\n    }\r\n}","\r\n\r\nimport { App } from \"../../engine/app\";\r\nimport { Vec2 } from \"../../engine/math\";\r\n\r\nexport class LineRenderingDemo extends App {\r\n\r\n    constructor(htmlCanvasId: string) {\r\n        super(htmlCanvasId);\r\n    }\r\n\r\n    async loadAssets(): Promise<void> {\r\n        await super.loadAssets();\r\n    }\r\n    \r\n    update() {\r\n        super.update();\r\n    }\r\n\r\n    draw() {\r\n        super.draw();\r\n\r\n        this.renderer2d.begin();\r\n\r\n        const points = [\r\n            new Vec2(100, 100),\r\n            new Vec2(200, 100),\r\n            this.input.mouse.pos\r\n        ];\r\n\r\n        this.renderer2d.drawLines(points, 20);\r\n\r\n        this.renderer2d.drawLine(300, 300, 400, 400, 6);\r\n\r\n        this.renderer2d.end();\r\n    }\r\n\r\n}","import img from '../../assets/prop-crate-plain.png';\r\nimport { Texture2D } from \"../../engine/graphics/texture\";\r\nimport { App } from \"../../engine/app\";\r\nimport { Vec4, Shape } from '../../engine/math';\r\nimport { RenderTexture } from '../../engine/graphics/renderTexture';\r\n\r\nexport class RenderTextureDemo extends App {\r\n\r\n    image: Texture2D;\r\n    rot: number  = 0;\r\n\r\n    renderTexture: RenderTexture;\r\n\r\n    constructor(htmlCanvasId: string) {\r\n        super(htmlCanvasId);\r\n    }\r\n\r\n    async loadAssets(): Promise<void> {\r\n        await super.loadAssets();\r\n\r\n        this.image = new Texture2D(this.gl);\r\n        this.image.load(img);\r\n\r\n        this.renderTexture = new RenderTexture(this.gl);\r\n        \r\n        const renderTextureSize = Math.min(this.canvas.width / 4, 256);\r\n        this.renderTexture.load(renderTextureSize, renderTextureSize);\r\n    }\r\n    \r\n    update() {\r\n        super.update();\r\n        this.rot += this.time.deltaTime;\r\n    }\r\n\r\n    draw() {\r\n        super.draw();\r\n\r\n        const size = this.renderTexture.width;\r\n\r\n        // Draw an image onto the render target\r\n        // ================================================\r\n        this.renderTexture.enable();\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n\r\n        this.renderer2d.begin();\r\n\r\n        this.renderer2d.saveState(true);\r\n        this.renderer2d.setTexture(this.image);\r\n        this.renderer2d.setColor(new Vec4(1,1,1,1));\r\n\r\n        this.renderer2d.darwRect(size/2, size/2, size*0.75, size*0.75, this.rot, 0.5, 0.5);\r\n        this.renderer2d.drawLines( Shape.makeBox(size/2, size/2, size-2, size-2, 0).points, 2);\r\n\r\n        this.renderer2d.popState();\r\n        this.renderer2d.end();\r\n\r\n        this.renderTexture.disable();\r\n        // ================================================\r\n\r\n        // draw the render target image back to the canvas\r\n        //================================================\r\n        \r\n        this.renderer2d.begin();\r\n\r\n        this.renderer2d.saveState(true);\r\n        this.renderer2d.setTexture(this.renderTexture);\r\n        this.renderer2d.setColor(new Vec4(1,1,1,1));\r\n\r\n        this.renderer2d.darwRect(this.canvas.width / 2 - size - 10, this.canvas.height / 2, size, size, 0, 0.5, 0.5);\r\n        this.renderer2d.setColor(new Vec4(0, 0, 0, 1));\r\n        this.renderer2d.darwRect(this.canvas.width / 2, this.canvas.height / 2, size, size, 0, 0.5, 0.5);\r\n        this.renderer2d.setColor(new Vec4(1, 0, 0, 1));\r\n        this.renderer2d.darwRect(this.canvas.width / 2 + size + 10, this.canvas.height / 2, size, size, 0, 0.5, 0.5);\r\n\r\n        this.renderer2d.popState();\r\n        this.renderer2d.end();\r\n\r\n    }\r\n\r\n}\r\n","import { LightBender } from './lightBender';\r\nimport { RayCastingDemo } from './rayCasting';\r\nimport { LineRenderingDemo } from './lineRendering';\r\nimport { RenderTextureDemo } from './renderTextureDemo';\r\nimport { App } from '../engine/app';\r\n\r\n\r\nfunction RunDemo(canvasId: string, name: string) {\r\n    switch(name) {\r\n        case 'LightBender': return new LightBender(canvasId);\r\n        case 'RayCastingDemo': return new RayCastingDemo(canvasId);\r\n        case 'LineRenderingDemo': return new LineRenderingDemo(canvasId);\r\n        case 'RenderTextureDemo': return new RenderTextureDemo(canvasId);\r\n        default: return new App(canvasId);\r\n    }\r\n}\r\n\r\nexport default RunDemo;","\r\nimport RunDemo from './demos';\r\n\r\n// ============================================================================\r\n// Launch the canvas demo\r\n// ============================================================================\r\n\r\nfunction getDemoNameFromHash() {\r\n    const pathnames: string[] = window.location.hash.substr(1).split('/').filter(z => z !== \"\");\r\n    const demoName = pathnames[0] ?? 'LightBender';\r\n    return demoName;\r\n}\r\n\r\nfunction runApp() {\r\n    const app = RunDemo(\"canvas\", getDemoNameFromHash());\r\n    app.launch();\r\n}\r\n\r\n// listen for hach value change events\r\nwindow.addEventListener('hashchange', () => {\r\n    runApp();\r\n});\r\n\r\nwindow.onload = (() => {\r\n    runApp();\r\n});\r\n\r\n\r\n\r\n\r\n// ============================================================================\r\n// APP MENU\r\n// ============================================================================\r\n{\r\n    const menuBtn = document.querySelector('.menu-btn');\r\n    const menuList = document.querySelector('.page-nav ul');\r\n    let menuOpen = false;\r\n    menuBtn.addEventListener('click', () => {\r\n        menuOpen = !menuOpen;\r\n        if(menuOpen){ \r\n            menuBtn.classList.add('open')\r\n            menuList.classList.add('open');\r\n        }\r\n        else {\r\n            menuBtn.classList.remove('open');\r\n            menuList.classList.remove('open');\r\n        }\r\n        console.log('clicky');\r\n    })\r\n\r\n}"]}